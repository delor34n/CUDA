<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>ETRAD: Referencia de la Clase Sistema_Lineal</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css">
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generado por Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../main.html"><span>Página&nbsp;principal</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Clases</span></a></li>
      <li><a href="../../files.html"><span>Archivos</span></a></li>
    <li>
      <form action="../../search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;Buscar&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../annotated.html"><span>Lista&nbsp;de&nbsp;clases</span></a></li>
      <li><a href="../../classes.html"><span>Índice&nbsp;de&nbsp;clases</span></a></li>
      <li><a href="../../hierarchy.html"><span>Jerarquía&nbsp;de&nbsp;la&nbsp;clase</span></a></li>
      <li><a href="../../functions.html"><span>Miembros&nbsp;de&nbsp;las&nbsp;clases</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Referencia de la Clase Sistema_Lineal</h1><!-- doxytag: class="Sistema_Lineal" -->Clase para trabajar con sistema lineales.  
<a href="#_details">Más...</a>
<p>
<code>#include &lt;<a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>&gt;</code>
<p>
<div class="dynheader">
Diagrama de colaboración para Sistema_Lineal:</div>
<div class="dynsection">
<p><center><img src="../../d2/d05/class_sistema___lineal__coll__graph.png" border="0" usemap="#d6/d8a/_sistema___lineal__coll__map" alt="Collaboration graph"></center>
<map name="d6/d8a/_sistema___lineal__coll__map">
<area shape="rect" id="node2" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo." alt="" coords="8,6,112,34"></map>
<center><font size="2">[<a target="top" href="../../graph_legend.html">leyenda</a>]</font></center></div>

<p>
<a href="../../d0/d76/class_sistema___lineal-members.html">Lista de todos los miembros.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Métodos públicos</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#9c298bc6abef46148078ad6708d4fcf3">Sistema_Lineal</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Costructor de la clase.  <a href="#9c298bc6abef46148078ad6708d4fcf3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#c43de583ededffb845de8a75011d3e69">Sistema_Lineal</a> (int traza)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#84685e89f81a69379689d889e6a5e44a">~Sistema_Lineal</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor de la clase.  <a href="#84685e89f81a69379689d889e6a5e44a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#ac8deab6e27e5277162801d72e3d7812">Set_Traza</a> (int traza)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Asigna numero de iteraciones.  <a href="#ac8deab6e27e5277162801d72e3d7812"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#7e2686b397eef1be4a918ac8c23d24ad">Get_Traza</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Asigna numero de iteraciones.  <a href="#7e2686b397eef1be4a918ac8c23d24ad"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4">Get_Iteraciones</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Asigna numero de iteraciones.  <a href="#23388dc06545a801456333c486e94af4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#4e568aca0fcd8fa87af7b5099005ce5b">Set_Iteraciones</a> (int Iter)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Asigna numero de procesos - procesadores.  <a href="#4e568aca0fcd8fa87af7b5099005ce5b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#a699432204b6cd794d28e150c2ac6e3f">SetNP</a> (int procesos)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Asigna numero de procesos - procesadores.  <a href="#a699432204b6cd794d28e150c2ac6e3f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#5a74ea97fda1d3aedd52a52a5efe28ec">GetNP</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retorna numero de procesos - procesadores.  <a href="#5a74ea97fda1d3aedd52a52a5efe28ec"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#b5e2f6fd151ec8f14255f2b96aa739f3">Asigna_Indice_FIla</a> (<a class="el" href="../../dd/d59/class_vector___entero.html">Vector_Entero</a> *ENTRADA)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#f53f35c21a9f23b8c5318b49cfda1c2b">Get_nDesconocido</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retorna el numero de incognitas desconocidas.  <a href="#f53f35c21a9f23b8c5318b49cfda1c2b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#b5ce5f903912eeecc39af1328b7bef9c">Set_nDesconocido</a> (unsigned long long variables_X)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Asigna el numeros de incognitas del sistema.  <a href="#b5ce5f903912eeecc39af1328b7bef9c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#6b271c2d8e63404fcc68af22c05d6725">LSRQ_Matriz_Dispersa</a> (<a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *A, <a class="el" href="../../dd/d6d/class_matriz___dispersa.html">Matriz_Dispersa</a> *MDA)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#2b9e62158dcb700a20e8f429c8c50454">LSQR_Resolver_Paralelo</a> (<a class="el" href="../../d5/db2/class_vector.html">Vector</a> *x, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *b, unsigned long long *iParticion, <a class="el" href="../../dd/d59/class_vector___entero.html">Vector_Entero</a> *COLUMNAS, <a class="el" href="../../dd/d59/class_vector___entero.html">Vector_Entero</a> *INDICES, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *DATOS, int Tipo_Parada, int traza)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Algoritmo LSQR paralelo para matrices dispersas.  <a href="#2b9e62158dcb700a20e8f429c8c50454"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#f2efe219c73509e50385d87a326a7c0e">LSQR_Resolver</a> (<a class="el" href="../../dd/d6d/class_matriz___dispersa.html">Matriz_Dispersa</a> *MDA, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *x, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *b, int Tipo_Parada, int traza)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Algoritmo LSQR para matrices dispersas.  <a href="#f2efe219c73509e50385d87a326a7c0e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#6e7fa4c926d3ccf67a5ea93831b13b7f">LSQR_Resolver_Normal</a> (<a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *A, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *x, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *b, int Tipo_Parada, int traza)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Algoritmo LSQR.  <a href="#6e7fa4c926d3ccf67a5ea93831b13b7f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#f87671a678c8abf8ce4c22fe7f5c0ae4">Redimensionar_Sistema</a> (<a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *a, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *b, <a class="el" href="../../dd/d59/class_vector___entero.html">Vector_Entero</a> *frontera, unsigned long long DimFrontera)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Redimensiona un sistema de ecuaciones representados matricialmente, indicando que filas-columnas se desean eliminar.  <a href="#f87671a678c8abf8ce4c22fe7f5c0ae4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#58e4ff1cef59effef111da197b1caf0a">Redimensionar_Sistema_Hashing</a> (map&lt; unsigned long long, double &gt; A_FEM, map&lt; unsigned long long, unsigned long long &gt; mFila, map&lt; unsigned long long, unsigned long long &gt; mColumna, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *b, <a class="el" href="../../dd/d59/class_vector___entero.html">Vector_Entero</a> *frontera, unsigned long DimActual)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Redimensiona un sistema de ecuaciones representados matricialmente con Hashing , indicando que filas-columnas se desean eliminar.  <a href="#58e4ff1cef59effef111da197b1caf0a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#f9c6e4765b533131244361805898a91a">Resuelve_Jacobi</a> (<a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *A, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *x, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *b, double ep, int Tipo_Parada, int traza)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resuelve Ax=b usando el metodo Jacobi.  <a href="#f9c6e4765b533131244361805898a91a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#62051f00d59e3aa833a0d5fc4d2953ab">Resuelve_Gauss_Seidel</a> (<a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *a, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *x, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *b, double ep, int Tipo_Parada, int traza)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resuelve Ax=b usando el metodo Gauss Seidel.  <a href="#62051f00d59e3aa833a0d5fc4d2953ab"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#fd67cab00f52f81023d49c8ac27a6ba7">Resuelve_Factorizacion_LU</a> (<a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *a, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *x, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *b)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resuelve el sistema Ax=b usando factorizacion LU.  <a href="#fd67cab00f52f81023d49c8ac27a6ba7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#26bfadb6eb48dad7204072cc0cb06d00">Factoriza_LU</a> (<a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *a)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Factoriza la matriz A en L y U dejandolas en la misma matriz.  <a href="#26bfadb6eb48dad7204072cc0cb06d00"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#5b4cee95d591129db28aa76341a0d646">Solve_LU</a> (<a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *a, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *x, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *b)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resuelve el sistema Ax=LUx = b.  <a href="#5b4cee95d591129db28aa76341a0d646"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#5f7919109bfc14849f6538e5aa0f9bc0">Solve_L</a> (<a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *a, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *y, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *b)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resuelve el sistema LY=B, dados L y B.  <a href="#5f7919109bfc14849f6538e5aa0f9bc0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#5b8fc00508e86a9070dac2aa213d3e51">Solve_LLT</a> (<a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *a, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *x, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *b)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resuelve un sistema factorizado utilizando Cholesky LLT.  <a href="#5b8fc00508e86a9070dac2aa213d3e51"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#a5f79942effd4bb705f09a054db19ca3">Solve_U</a> (<a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *a, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *x, <a class="el" href="../../d5/db2/class_vector.html">Vector</a> *y)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resuelve el sistema UX=Y, dados U y Y.  <a href="#a5f79942effd4bb705f09a054db19ca3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#a92429bad7eab3a7098e049bc62d29a9">Factoriza_LLT</a> (<a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *a)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Factoriza la matriz A en L y LT dejandolas en la misma matriz.  <a href="#a92429bad7eab3a7098e049bc62d29a9"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Atributos públicos</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#a0e532bf4b0effd912e3b40b64a10b6d">nDesconocido</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Numero de variables desconocidas.  <a href="#a0e532bf4b0effd912e3b40b64a10b6d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#661c39bcb3d3391b09e602d6d7aed46e">NP</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Numero de procesos.  <a href="#661c39bcb3d3391b09e602d6d7aed46e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#6499811137fbc0ee092d3266f601dc28">Iteraciones</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Numero de iteraciones para uso en metodos iterativos.  <a href="#6499811137fbc0ee092d3266f601dc28"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#61120f444e00866ec11ad5aa10e3cfdc">Traza</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Indica si se desea alamcenar en archivo la convergencia del error.  <a href="#61120f444e00866ec11ad5aa10e3cfdc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../dd/d59/class_vector___entero.html">Vector_Entero</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#22ec3a7c7156c6f16ca0ad38b6bd8aaf">INDICE_FILAS</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Usado en el calculo paralelo para indicar fila inicial global.  <a href="#22ec3a7c7156c6f16ca0ad38b6bd8aaf"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d85/class_sistema___lineal.html#b5a2b3cc2401946436d9d348afda71c9">tSistema</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tiempo utilizado en resolver sistema.  <a href="#b5a2b3cc2401946436d9d348afda71c9"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Descripción detallada</h2>
Clase para trabajar con sistema lineales. 
<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00011">11</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>
<hr><h2>Documentación del constructor y destructor</h2>
<a class="anchor" name="9c298bc6abef46148078ad6708d4fcf3"></a><!-- doxytag: member="Sistema_Lineal::Sistema_Lineal" ref="9c298bc6abef46148078ad6708d4fcf3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sistema_Lineal::Sistema_Lineal           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Costructor de la clase. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00028">28</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00029"></a>00029    {
<a name="l00030"></a>00030          <span class="comment">//  Traza=0; // Por defecto no se exporta el error</span>
<a name="l00031"></a>00031    }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c43de583ededffb845de8a75011d3e69"></a><!-- doxytag: member="Sistema_Lineal::Sistema_Lineal" ref="c43de583ededffb845de8a75011d3e69" args="(int traza)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sistema_Lineal::Sistema_Lineal           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>traza</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00033">33</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00022">Traza</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00034"></a>00034    {
<a name="l00035"></a>00035       <a class="code" href="../../d9/d85/class_sistema___lineal.html#61120f444e00866ec11ad5aa10e3cfdc" title="Indica si se desea alamcenar en archivo la convergencia del error.">Traza</a>=traza;
<a name="l00036"></a>00036    }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="84685e89f81a69379689d889e6a5e44a"></a><!-- doxytag: member="Sistema_Lineal::~Sistema_Lineal" ref="84685e89f81a69379689d889e6a5e44a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sistema_Lineal::~Sistema_Lineal           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destructor de la clase. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00039">39</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00040"></a>00040    {
<a name="l00041"></a>00041        
<a name="l00042"></a>00042    }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Documentación de las funciones miembro</h2>
<a class="anchor" name="b5e2f6fd151ec8f14255f2b96aa739f3"></a><!-- doxytag: member="Sistema_Lineal::Asigna_Indice_FIla" ref="b5e2f6fd151ec8f14255f2b96aa739f3" args="(Vector_Entero *ENTRADA)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Asigna_Indice_FIla           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d59/class_vector___entero.html">Vector_Entero</a> *&nbsp;</td>
          <td class="paramname"> <em>ENTRADA</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00079">79</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d2/dbe/_vector___entero_8hpp_source.html#l00080">Vector_Entero::Columnas()</a>, y <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00024">INDICE_FILAS</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00080"></a>00080    {
<a name="l00081"></a>00081         <a class="code" href="../../d9/d85/class_sistema___lineal.html#22ec3a7c7156c6f16ca0ad38b6bd8aaf" title="Usado en el calculo paralelo para indicar fila inicial global.">INDICE_FILAS</a> = <span class="keyword">new</span> <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a>(ENTRADA-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#d1d5779a63bf05b51bec19fa6a03cd29" title="Retorna el numero de columnas.">Columnas</a>());
<a name="l00082"></a>00082     <a class="code" href="../../d9/d85/class_sistema___lineal.html#22ec3a7c7156c6f16ca0ad38b6bd8aaf" title="Usado en el calculo paralelo para indicar fila inicial global.">INDICE_FILAS</a> = ENTRADA;        
<a name="l00083"></a>00083    }
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_b5e2f6fd151ec8f14255f2b96aa739f3_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_b5e2f6fd151ec8f14255f2b96aa739f3_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_b5e2f6fd151ec8f14255f2b96aa739f3_cgraph_map">
<area shape="rect" id="node3" href="../../dd/d59/class_vector___entero.html#d1d5779a63bf05b51bec19fa6a03cd29" title="Retorna el numero de columnas." alt="" coords="283,5,453,33"></map>
</div>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_b5e2f6fd151ec8f14255f2b96aa739f3_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_b5e2f6fd151ec8f14255f2b96aa739f3_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_b5e2f6fd151ec8f14255f2b96aa739f3_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="284,5,479,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="529,5,577,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="a92429bad7eab3a7098e049bc62d29a9"></a><!-- doxytag: member="Sistema_Lineal::Factoriza_LLT" ref="a92429bad7eab3a7098e049bc62d29a9" args="(Matriz *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Factoriza_LLT           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Factoriza la matriz A en L y LT dejandolas en la misma matriz. 
<p>
Calcula la factorizacion LLT. 
<p>Definición en la línea <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00783">783</a> del archivo <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00089">Matriz::Asigna()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00058">Matriz::Columnas()</a>, y <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00095">Matriz::Retorna()</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00784"></a>00784  {
<a name="l00785"></a>00785          <span class="keywordtype">double</span> suma;
<a name="l00786"></a>00786          <span class="keywordtype">double</span> tmp;
<a name="l00787"></a>00787         <span class="comment">// double traza;</span>
<a name="l00788"></a>00788          <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> n,i,j,k;
<a name="l00789"></a>00789          suma=0.0;
<a name="l00790"></a>00790          n= (<span class="keywordtype">long</span> <span class="keywordtype">long</span> int) a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas.">Columnas</a>();
<a name="l00791"></a>00791           printf(<span class="stringliteral">"Factorizando LLT\n"</span>);
<a name="l00792"></a>00792         
<a name="l00793"></a>00793         <span class="keywordflow">for</span> ( i = 0; i &lt;n; i++) 
<a name="l00794"></a>00794     {
<a name="l00795"></a>00795         suma=a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,i); 
<a name="l00796"></a>00796               <span class="keywordflow">for</span>(k=0; k&lt;i;k++)
<a name="l00797"></a>00797                    {
<a name="l00798"></a>00798                         suma = suma - pow( a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(k,i),2.0);
<a name="l00799"></a>00799                    }
<a name="l00800"></a>00800                    
<a name="l00801"></a>00801                    a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#ef90ff9c24c5474b0e09818be945207a" title="Asigna valor en fila, columna.">Asigna</a>(i,i,  (<span class="keywordtype">double</span>) sqrt((<span class="keywordtype">double</span>)suma));
<a name="l00802"></a>00802                           <span class="keywordflow">for</span>( j = i+1; j &lt;  n ; j++) 
<a name="l00803"></a>00803                           {                               
<a name="l00804"></a>00804                            suma=a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,j); 
<a name="l00805"></a>00805                                   <span class="keywordflow">for</span>( k=0; k&lt;i;k++)
<a name="l00806"></a>00806                                    {
<a name="l00807"></a>00807                                         suma = suma - a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(k,i)*a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(k,j);
<a name="l00808"></a>00808                                    }
<a name="l00809"></a>00809                                 tmp=suma/a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,i);
<a name="l00810"></a>00810                             a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#ef90ff9c24c5474b0e09818be945207a" title="Asigna valor en fila, columna.">Asigna</a>(i,j, tmp);
<a name="l00811"></a>00811                                 a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#ef90ff9c24c5474b0e09818be945207a" title="Asigna valor en fila, columna.">Asigna</a>(j,i,tmp);   
<a name="l00812"></a>00812                         <span class="comment">// printf("Asignando LLT[%Ld][%Ld]\n",i,j); </span>
<a name="l00813"></a>00813                            }
<a name="l00814"></a>00814           
<a name="l00815"></a>00815           }
<a name="l00816"></a>00816           
<a name="l00817"></a>00817            
<a name="l00818"></a>00818 }
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_a92429bad7eab3a7098e049bc62d29a9_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_a92429bad7eab3a7098e049bc62d29a9_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_a92429bad7eab3a7098e049bc62d29a9_cgraph_map">
<area shape="rect" id="node3" href="../../d4/d09/class_matriz.html#ef90ff9c24c5474b0e09818be945207a" title="Asigna valor en fila, columna." alt="" coords="264,5,368,33"><area shape="rect" id="node5" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas." alt="" coords="255,55,377,83"><area shape="rect" id="node7" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna." alt="" coords="261,106,371,134"></map>
</div>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_a92429bad7eab3a7098e049bc62d29a9_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_a92429bad7eab3a7098e049bc62d29a9_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_a92429bad7eab3a7098e049bc62d29a9_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="255,5,449,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="500,5,548,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="26bfadb6eb48dad7204072cc0cb06d00"></a><!-- doxytag: member="Sistema_Lineal::Factoriza_LU" ref="26bfadb6eb48dad7204072cc0cb06d00" args="(Matriz *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Factoriza_LU           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Factoriza la matriz A en L y U dejandolas en la misma matriz. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00865">865</a> del archivo <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00089">Matriz::Asigna()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00058">Matriz::Columnas()</a>, y <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00095">Matriz::Retorna()</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>, y <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00858">Resuelve_Factorizacion_LU()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00866"></a>00866 {
<a name="l00867"></a>00867 
<a name="l00868"></a>00868    
<a name="l00869"></a>00869    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i, j, k;
<a name="l00870"></a>00870    <span class="keywordtype">double</span> m, n;
<a name="l00871"></a>00871    <span class="keywordflow">for</span> (i = 0; i &lt; a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas.">Columnas</a>(); i++) 
<a name="l00872"></a>00872    {
<a name="l00873"></a>00873 
<a name="l00874"></a>00874       <span class="keywordflow">for</span> (j = i+1; j &lt; a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas.">Columnas</a>(); j++) 
<a name="l00875"></a>00875       {
<a name="l00876"></a>00876          n = a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(j,i);
<a name="l00877"></a>00877      <span class="comment">//  if (n == 0.0) continue;  // ojo si se usa, es menor el tiempo de computo que cholesky porque se salta el for, se dejo para la estimacion de tiempos</span>
<a name="l00878"></a>00878  
<a name="l00879"></a>00879          m = n / a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,i);
<a name="l00880"></a>00880          a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#ef90ff9c24c5474b0e09818be945207a" title="Asigna valor en fila, columna.">Asigna</a>(j, i, m);
<a name="l00881"></a>00881 
<a name="l00882"></a>00882          <span class="keywordflow">for</span> (k = i+1; k &lt; a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas.">Columnas</a>(); k++) 
<a name="l00883"></a>00883          {
<a name="l00884"></a>00884             a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#ef90ff9c24c5474b0e09818be945207a" title="Asigna valor en fila, columna.">Asigna</a>(j, k, a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(j,k) - m * a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,k) );
<a name="l00885"></a>00885          }
<a name="l00886"></a>00886       }
<a name="l00887"></a>00887    }
<a name="l00888"></a>00888 
<a name="l00889"></a>00889 }
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_26bfadb6eb48dad7204072cc0cb06d00_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_26bfadb6eb48dad7204072cc0cb06d00_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_26bfadb6eb48dad7204072cc0cb06d00_cgraph_map">
<area shape="rect" id="node3" href="../../d4/d09/class_matriz.html#ef90ff9c24c5474b0e09818be945207a" title="Asigna valor en fila, columna." alt="" coords="261,5,365,33"><area shape="rect" id="node5" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas." alt="" coords="252,55,375,83"><area shape="rect" id="node7" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna." alt="" coords="259,106,368,134"></map>
</div>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_26bfadb6eb48dad7204072cc0cb06d00_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_26bfadb6eb48dad7204072cc0cb06d00_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_26bfadb6eb48dad7204072cc0cb06d00_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="293,5,488,33"><area shape="rect" id="node7" href="../../d9/d85/class_sistema___lineal.html#fd67cab00f52f81023d49c8ac27a6ba7" title="Resuelve el sistema Ax=b usando factorizacion LU." alt="" coords="252,55,529,83"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="580,5,628,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="23388dc06545a801456333c486e94af4"></a><!-- doxytag: member="Sistema_Lineal::Get_Iteraciones" ref="23388dc06545a801456333c486e94af4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long long Sistema_Lineal::Get_Iteraciones           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Asigna numero de iteraciones. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00057">57</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00020">Iteraciones</a>.</p>

<p>Referenciado por <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00397">LSQR_Resolver()</a>, <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00578">LSQR_Resolver_Normal()</a>, <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00085">LSQR_Resolver_Paralelo()</a>, <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l01025">Resuelve_Gauss_Seidel()</a>, y <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00922">Resuelve_Jacobi()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00058"></a>00058    {
<a name="l00059"></a>00059         <span class="keywordflow">return</span> <a class="code" href="../../d9/d85/class_sistema___lineal.html#6499811137fbc0ee092d3266f601dc28" title="Numero de iteraciones para uso en metodos iterativos.">Iteraciones</a>;   
<a name="l00060"></a>00060    }   
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_23388dc06545a801456333c486e94af4_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_23388dc06545a801456333c486e94af4_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_23388dc06545a801456333c486e94af4_icgraph_map">
<area shape="rect" id="node3" href="../../d9/d85/class_sistema___lineal.html#f2efe219c73509e50385d87a326a7c0e" title="Algoritmo LSQR para matrices dispersas." alt="" coords="292,5,500,33"><area shape="rect" id="node9" href="../../d9/d85/class_sistema___lineal.html#6e7fa4c926d3ccf67a5ea93831b13b7f" title="Algoritmo LSQR." alt="" coords="268,55,524,83"><area shape="rect" id="node12" href="../../d9/d85/class_sistema___lineal.html#2b9e62158dcb700a20e8f429c8c50454" title="Algoritmo LSQR paralelo para matrices dispersas." alt="" coords="264,106,528,134"><area shape="rect" id="node15" href="../../d9/d85/class_sistema___lineal.html#62051f00d59e3aa833a0d5fc4d2953ab" title="Resuelve Ax=b usando el metodo Gauss Seidel." alt="" coords="267,157,525,185"><area shape="rect" id="node18" href="../../d9/d85/class_sistema___lineal.html#f9c6e4765b533131244361805898a91a" title="Resuelve Ax=b usando el metodo Jacobi." alt="" coords="289,207,503,235"><area shape="rect" id="node5" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="577,106,772,134"><area shape="rect" id="node7" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="823,106,871,134"></map>
</div>

</div>
</div><p>
<a class="anchor" name="f53f35c21a9f23b8c5318b49cfda1c2b"></a><!-- doxytag: member="Sistema_Lineal::Get_nDesconocido" ref="f53f35c21a9f23b8c5318b49cfda1c2b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long long Sistema_Lineal::Get_nDesconocido           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Retorna el numero de incognitas desconocidas. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00086">86</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00016">nDesconocido</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00087"></a>00087    {
<a name="l00088"></a>00088         <span class="keywordflow">return</span> <a class="code" href="../../d9/d85/class_sistema___lineal.html#a0e532bf4b0effd912e3b40b64a10b6d" title="Numero de variables desconocidas.">nDesconocido</a>;   
<a name="l00089"></a>00089    }
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_f53f35c21a9f23b8c5318b49cfda1c2b_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_f53f35c21a9f23b8c5318b49cfda1c2b_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_f53f35c21a9f23b8c5318b49cfda1c2b_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="284,5,479,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="529,5,577,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="7e2686b397eef1be4a918ac8c23d24ad"></a><!-- doxytag: member="Sistema_Lineal::Get_Traza" ref="7e2686b397eef1be4a918ac8c23d24ad" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Sistema_Lineal::Get_Traza           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Asigna numero de iteraciones. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00051">51</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00022">Traza</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00052"></a>00052    {
<a name="l00053"></a>00053         <span class="keywordflow">return</span> <a class="code" href="../../d9/d85/class_sistema___lineal.html#61120f444e00866ec11ad5aa10e3cfdc" title="Indica si se desea alamcenar en archivo la convergencia del error.">Traza</a>;   
<a name="l00054"></a>00054    }   
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_7e2686b397eef1be4a918ac8c23d24ad_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_7e2686b397eef1be4a918ac8c23d24ad_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_7e2686b397eef1be4a918ac8c23d24ad_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="233,5,428,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="479,5,527,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="5a74ea97fda1d3aedd52a52a5efe28ec"></a><!-- doxytag: member="Sistema_Lineal::GetNP" ref="5a74ea97fda1d3aedd52a52a5efe28ec" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Sistema_Lineal::GetNP           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Retorna numero de procesos - procesadores. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00074">74</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00018">NP</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00075"></a>00075    {
<a name="l00076"></a>00076         <span class="keywordflow">return</span> <a class="code" href="../../d9/d85/class_sistema___lineal.html#661c39bcb3d3391b09e602d6d7aed46e" title="Numero de procesos.">NP</a>;   
<a name="l00077"></a>00077    }  
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f2efe219c73509e50385d87a326a7c0e"></a><!-- doxytag: member="Sistema_Lineal::LSQR_Resolver" ref="f2efe219c73509e50385d87a326a7c0e" args="(Matriz_Dispersa *MDA, Vector *x, Vector *b, int Tipo_Parada, int traza)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::LSQR_Resolver           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d6d/class_matriz___dispersa.html">Matriz_Dispersa</a> *&nbsp;</td>
          <td class="paramname"> <em>MDA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Tipo_Parada</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>traza</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Algoritmo LSQR para matrices dispersas. 
<p>
LSQR para un procesador con matrices dispersas. 
<p>Definición en la línea <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00397">397</a> del archivo <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00021">Archivo::Abrir()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00037">Vector::Asigna()</a>, <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00012">Archivo::Cerrar()</a>, <a class="el" href="../../db/d20/_vector_8hpp_source.html#l00084">Vector::Columnas()</a>, <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00002">Condicion_Convergencia</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00236">Vector::Error_Norma2()</a>, <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00052">Archivo::Escribe_Vector()</a>, <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00057">Get_Iteraciones()</a>, <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00005">GRABA_ARCHIVO</a>, <a class="el" href="../../db/d20/_vector_8hpp_source.html#l00059">Vector::Libera_Memoria()</a>, <a class="el" href="../../da/d33/_matriz___dispersa_8cpp_source.html#l00006">Matriz_Dispersa::Producto_MA_Vector()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00051">Vector::Retorna()</a>, <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00053">Archivo::SetModo()</a>, <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00049">Archivo::SetNombre()</a>, y <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00201">Vector::Vector_Normal()</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00398"></a>00398 {
<a name="l00399"></a>00399         
<a name="l00400"></a>00400         <span class="keywordtype">double</span> tolerancia=0.00001;<span class="comment">//10e-15;</span>
<a name="l00401"></a>00401     <span class="keywordtype">double</span> theta, alpha, beta, phi, phibar, rho, rhobar;
<a name="l00402"></a>00402     <span class="keywordtype">double</span> c, s;
<a name="l00403"></a>00403     <span class="keywordtype">double</span> arnorm;
<a name="l00404"></a>00404         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> nfilas, ncols,iter;
<a name="l00405"></a>00405         nfilas=ncols=x-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>();
<a name="l00406"></a>00406         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *ERROR=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(<a class="code" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones.">Get_Iteraciones</a>());
<a name="l00407"></a>00407         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *u=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas); 
<a name="l00408"></a>00408         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *v=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(ncols);
<a name="l00409"></a>00409         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *w=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(ncols);
<a name="l00410"></a>00410         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *x_star=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas);
<a name="l00411"></a>00411         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *x_new=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(ncols);
<a name="l00412"></a>00412         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *x_aux=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas);
<a name="l00413"></a>00413         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *Norma2=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas);
<a name="l00414"></a>00414         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *AX=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas);
<a name="l00415"></a>00415         <span class="keywordtype">double</span> suma=0.0;  
<a name="l00416"></a>00416         <span class="keywordtype">double</span> suma_n1=10e9;
<a name="l00417"></a>00417         <span class="keywordtype">double</span> diferencia=10e9;
<a name="l00418"></a>00418         <span class="keywordtype">int</span> contador_verificacion=0;
<a name="l00419"></a>00419         <span class="keywordtype">double</span> inicioLSQR,finalLSQR;
<a name="l00420"></a>00420     inicioLSQR=MPI_Wtime();
<a name="l00421"></a>00421         
<a name="l00422"></a>00422         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0; j &lt; nfilas; j++)
<a name="l00423"></a>00423         u-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(j,b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j));      
<a name="l00424"></a>00424  
<a name="l00425"></a>00425         beta=b-&gt;<a class="code" href="../../d5/db2/class_vector.html#db22a12698caef87688b1577be609a93" title="Calcula el vector Normal.">Vector_Normal</a>();
<a name="l00426"></a>00426         
<a name="l00427"></a>00427         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0; j &lt; nfilas; j++) 
<a name="l00428"></a>00428         {
<a name="l00429"></a>00429          u-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(j,u-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j)/beta); <span class="comment">//Muchos ceros pero no es relevante para la complejidad del algorimto</span>
<a name="l00430"></a>00430         }
<a name="l00431"></a>00431 
<a name="l00432"></a>00432          MDA-&gt;<a class="code" href="../../dd/d6d/class_matriz___dispersa.html#ca785dc7b313b03593c78aa358f95c10" title="Producto matriz dispersa por un vector.">Producto_MA_Vector</a>(u,v); <span class="comment">// Solo multiplica muy pocos valores 3*n_fuentes como maximo - original</span>
<a name="l00433"></a>00433          alpha = v-&gt;<a class="code" href="../../d5/db2/class_vector.html#db22a12698caef87688b1577be609a93" title="Calcula el vector Normal.">Vector_Normal</a>();
<a name="l00434"></a>00434      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i=0; i &lt; ncols; i++)
<a name="l00435"></a>00435      {
<a name="l00436"></a>00436                 v-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,v-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i)/alpha);
<a name="l00437"></a>00437         w-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,v-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i));
<a name="l00438"></a>00438          }
<a name="l00439"></a>00439         
<a name="l00440"></a>00440      arnorm = alpha * beta;
<a name="l00441"></a>00441      phibar = beta;
<a name="l00442"></a>00442      rhobar = alpha;
<a name="l00443"></a>00443 
<a name="l00444"></a>00444      printf(<span class="stringliteral">"Iterando...\n"</span>);
<a name="l00445"></a>00445          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i=0;
<a name="l00446"></a>00446          <span class="keywordflow">while</span>( ( Tipo_Parada==1) ||  ( Tipo_Parada == 0 &amp;&amp; ( diferencia &gt; tolerancia || contador_verificacion != <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#af0fd8b5d5b6c134b4d5574136a09f00">Condicion_Convergencia</a>)  ) )
<a name="l00447"></a>00447     {
<a name="l00448"></a>00448         
<a name="l00449"></a>00449      MDA-&gt;<a class="code" href="../../dd/d6d/class_matriz___dispersa.html#ca785dc7b313b03593c78aa358f95c10" title="Producto matriz dispersa por un vector.">Producto_MA_Vector</a>(v,x_star); <span class="comment">// Solo multiplica pocos valores, pero es innecesaria una inversion de multiplicaion dispersa en este punto </span>
<a name="l00450"></a>00450 
<a name="l00451"></a>00451     
<a name="l00452"></a>00452      
<a name="l00453"></a>00453                    
<a name="l00454"></a>00454     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j &lt; nfilas; j++)
<a name="l00455"></a>00455     u-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(j,x_star-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j) - alpha*u-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j));
<a name="l00456"></a>00456 
<a name="l00457"></a>00457     beta=u-&gt;<a class="code" href="../../d5/db2/class_vector.html#db22a12698caef87688b1577be609a93" title="Calcula el vector Normal.">Vector_Normal</a>();
<a name="l00458"></a>00458         <span class="keywordflow">if</span> (beta == 0.0)
<a name="l00459"></a>00459         {
<a name="l00460"></a>00460             printf(<span class="stringliteral">"El vector normal no pude ser cero, el programa finalizara el proceso de resolucion LSQR \n"</span>);
<a name="l00461"></a>00461         MPI_Finalize();
<a name="l00462"></a>00462                 exit(1);
<a name="l00463"></a>00463         }
<a name="l00464"></a>00464 
<a name="l00465"></a>00465          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0; j &lt; nfilas; j++)
<a name="l00466"></a>00466      u-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(j,u-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j)/beta);
<a name="l00467"></a>00467         
<a name="l00468"></a>00468          
<a name="l00469"></a>00469      MDA-&gt;<a class="code" href="../../dd/d6d/class_matriz___dispersa.html#ca785dc7b313b03593c78aa358f95c10" title="Producto matriz dispersa por un vector.">Producto_MA_Vector</a>(u,x_new);
<a name="l00470"></a>00470 
<a name="l00471"></a>00471 
<a name="l00472"></a>00472      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> k=0; k &lt; ncols; k++)
<a name="l00473"></a>00473          v-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(k, x_new-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k) - beta*v-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k) );  
<a name="l00474"></a>00474          alpha=v-&gt;<a class="code" href="../../d5/db2/class_vector.html#db22a12698caef87688b1577be609a93" title="Calcula el vector Normal.">Vector_Normal</a>();
<a name="l00475"></a>00475 
<a name="l00476"></a>00476          <span class="keywordflow">if</span> (alpha == 0.0)
<a name="l00477"></a>00477     {
<a name="l00478"></a>00478             printf(<span class="stringliteral">"El vector normal no pude ser cero, el programa finalizara el proceso de resolucion LSQR \n"</span>);
<a name="l00479"></a>00479         MPI_Finalize();
<a name="l00480"></a>00480                 exit(1);
<a name="l00481"></a>00481     }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> k=0; k &lt; ncols; k++)
<a name="l00484"></a>00484      v-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(k, v-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k)/alpha);         
<a name="l00485"></a>00485 
<a name="l00486"></a>00486          <span class="comment">// Construccion y aplicacion de la siguiente transformacion ortogonal</span>
<a name="l00487"></a>00487          
<a name="l00488"></a>00488          rho    =  sqrt( rhobar*rhobar + beta*beta );
<a name="l00489"></a>00489          c      =  rhobar / rho;
<a name="l00490"></a>00490          s      =  beta   / rho;
<a name="l00491"></a>00491          theta  =  s * alpha;
<a name="l00492"></a>00492          rhobar = -c * alpha;
<a name="l00493"></a>00493          phi    =  c * phibar;
<a name="l00494"></a>00494          phibar =  s * phibar;
<a name="l00495"></a>00495 
<a name="l00496"></a>00496 
<a name="l00497"></a>00497          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> k=0; k &lt; ncols; k++)
<a name="l00498"></a>00498     {
<a name="l00499"></a>00499            x-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(k,x-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k) +   (phi/rho) * w-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k)   );
<a name="l00500"></a>00500        w-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(k,v-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k) - (theta/rho) * w-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k));           
<a name="l00501"></a>00501     }
<a name="l00502"></a>00502             <span class="comment">// Solo para uso de estudio de convergencia o detencion de iteracion en base a una tolerancia de error dada</span>
<a name="l00503"></a>00503                         <span class="keywordflow">if</span>(Tipo_Parada==0 || ( Tipo_Parada ==1 &amp;&amp; traza == 1 ))
<a name="l00504"></a>00504                         {       
<a name="l00505"></a>00505                          MDA-&gt;<a class="code" href="../../dd/d6d/class_matriz___dispersa.html#ca785dc7b313b03593c78aa358f95c10" title="Producto matriz dispersa por un vector.">Producto_MA_Vector</a>(x,AX); 
<a name="l00506"></a>00506                            
<a name="l00507"></a>00507                          <span class="keywordflow">if</span>(i!=0)
<a name="l00508"></a>00508                          suma_n1=suma;  
<a name="l00509"></a>00509                          
<a name="l00510"></a>00510                          suma=Norma2-&gt;<a class="code" href="../../d5/db2/class_vector.html#e192f9cd81d8348bbbe6e2ece818609c" title="Obtiene el error norma 2 entre dos vectores.">Error_Norma2</a>(AX,b);
<a name="l00511"></a>00511                          diferencia=suma_n1-suma;
<a name="l00512"></a>00512                          }
<a name="l00513"></a>00513              
<a name="l00514"></a>00514             <span class="comment">// Solo para uso de estudio de convergencia y traza del metodo</span>
<a name="l00515"></a>00515                         <span class="keywordflow">if</span>((i%1==0.0 &amp;&amp;  traza==1 )|| ( i%100==0.0 &amp;&amp;traza==2 )) <span class="comment">// muestra los datos cada 100 iteraciones</span>
<a name="l00516"></a>00516                          {
<a name="l00517"></a>00517                                  <span class="keywordflow">if</span>(Tipo_Parada==0)
<a name="l00518"></a>00518                                  printf(<span class="stringliteral">"La convergencia en  %Ld es: (t = %f, t-1 = %f)  DIf = (%f) \n"</span>, i,suma,suma_n1,diferencia);
<a name="l00519"></a>00519                                  <span class="keywordflow">else</span>
<a name="l00520"></a>00520                                  printf(<span class="stringliteral">"Iteracion  %Ld \n"</span>, i);
<a name="l00521"></a>00521                                          
<a name="l00522"></a>00522                          }
<a name="l00523"></a>00523                         
<a name="l00524"></a>00524              <span class="comment">// Solo en caso de querer utilizar el metodo basado en la detencion del algortimmo en base a una tolenacia de error dada                    </span>
<a name="l00525"></a>00525                          <span class="keywordflow">if</span>(Tipo_Parada==0)
<a name="l00526"></a>00526                          {       
<a name="l00527"></a>00527                          <span class="keywordflow">if</span>(diferencia&lt;=tolerancia)
<a name="l00528"></a>00528                          contador_verificacion++;
<a name="l00529"></a>00529                          <span class="keywordflow">else</span>
<a name="l00530"></a>00530                          contador_verificacion=0;        
<a name="l00531"></a>00531                         }
<a name="l00532"></a>00532                            
<a name="l00533"></a>00533         
<a name="l00534"></a>00534      <span class="keywordflow">if</span>(Tipo_Parada==0 || ( Tipo_Parada ==1 &amp;&amp; traza == 1 ) ) <span class="comment">// solo si se desea el funcioanmiento en base a una tolerancia o solo si se quiere estudiar la convergencia del metodo</span>
<a name="l00535"></a>00535          ERROR-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,suma);
<a name="l00536"></a>00536         
<a name="l00537"></a>00537          i++;
<a name="l00538"></a>00538      iter=i;
<a name="l00539"></a>00539          
<a name="l00540"></a>00540      <span class="keywordflow">if</span>(i == <a class="code" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones.">Get_Iteraciones</a>()) <span class="comment">// se finaliza el proceso iterativo cuando se alacanza el numero de iteraciones indicado en el inicio del programa</span>
<a name="l00541"></a>00541          <span class="keywordflow">break</span>;  
<a name="l00542"></a>00542  }
<a name="l00543"></a>00543   finalLSQR=MPI_Wtime();        
<a name="l00544"></a>00544  
<a name="l00545"></a>00545      <span class="keywordflow">if</span>(traza==1)
<a name="l00546"></a>00546         {
<a name="l00547"></a>00547                 <span class="keywordtype">char</span> *NombreSolucion=<span class="stringliteral">"ERROR_LSQR_Dispersa.dat"</span>;
<a name="l00548"></a>00548                 <a class="code" href="../../d2/dee/class_archivo.html" title="Clase para manipular archivos.">Archivo</a> *ERROR_ARCHIVO=<span class="keyword">new</span> <a class="code" href="../../d2/dee/class_archivo.html" title="Clase para manipular archivos.">Archivo</a>();
<a name="l00549"></a>00549                 ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#3960a9c7863da75e6e704a668c488293" title="Asigna un nombre al archivo.">SetNombre</a>(NombreSolucion);
<a name="l00550"></a>00550                 ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#4c756c8da75fab13f1c0b5cc636b2724" title="Define el tipo de acceso al archivo.">SetModo</a>(<a class="code" href="../../de/dc7/_archivo_8hpp.html#406416501f9b8dd55765eb0686ced406">GRABA_ARCHIVO</a>);  
<a name="l00551"></a>00551                 ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#812b1ef63ac695139f6b4bfb3aa7ff81" title="Abre el archivo.">Abrir</a>();
<a name="l00552"></a>00552                 ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#d1120aa3740cdc037ce2a3fb49351133" title="Escribe un Vector a un archivo (Recordar cambiar a Escribe_Vector).">Escribe_Vector</a>(ERROR,ERROR-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>());   
<a name="l00553"></a>00553                 ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#9dd5f77b08f09bfef21f03e5a0080bcb" title="Cierra el archivo.">Cerrar</a>();
<a name="l00554"></a>00554     }
<a name="l00555"></a>00555         
<a name="l00556"></a>00556         <span class="comment">// si no se produce convergencia es posible que exista un error en la geometria definida en el proceso de la FEM</span>
<a name="l00557"></a>00557     <span class="keywordflow">if</span>(suma &gt; 1000)
<a name="l00558"></a>00558         {
<a name="l00559"></a>00559         printf(<span class="stringliteral">"\n\n  ************ ATENCION ES MUY PROBABLE QUE LA APROXIMACION SEA INCORRECTA POR UNA MALA TRIANGULACION DE MALLA FEM UTILIZADA  *****************     \n\n"</span>); 
<a name="l00560"></a>00560         }       
<a name="l00561"></a>00561  
<a name="l00562"></a>00562         <span class="keywordflow">if</span>(Tipo_Parada==0 || ( Tipo_Parada ==1 &amp;&amp; traza == 1 ))
<a name="l00563"></a>00563     printf(<span class="stringliteral">"Iteraciones: %Ld  en   %f segundos con norma 2=%f y diferencia = %f\n"</span>,iter,finalLSQR-inicioLSQR,suma,diferencia);
<a name="l00564"></a>00564         <span class="keywordflow">else</span>
<a name="l00565"></a>00565         printf(<span class="stringliteral">"Iteraciones: %Ld  en   %f segundos \n"</span>,iter,finalLSQR-inicioLSQR);
<a name="l00566"></a>00566                 
<a name="l00567"></a>00567         u-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00568"></a>00568         v-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00569"></a>00569         w-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00570"></a>00570         x_star-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00571"></a>00571         x_new-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00572"></a>00572         x_aux-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00573"></a>00573         
<a name="l00574"></a>00574            
<a name="l00575"></a>00575 }    
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_f2efe219c73509e50385d87a326a7c0e_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_f2efe219c73509e50385d87a326a7c0e_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_f2efe219c73509e50385d87a326a7c0e_cgraph_map">
<area shape="rect" id="node3" href="../../d2/dee/class_archivo.html#812b1ef63ac695139f6b4bfb3aa7ff81" title="Abre el archivo." alt="" coords="339,5,437,33"><area shape="rect" id="node5" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col." alt="" coords="592,258,699,286"><area shape="rect" id="node9" href="../../d2/dee/class_archivo.html#9dd5f77b08f09bfef21f03e5a0080bcb" title="Cierra el archivo." alt="" coords="335,106,441,134"><area shape="rect" id="node11" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas." alt="" coords="583,435,708,463"><area shape="rect" id="node13" href="../../d5/db2/class_vector.html#e192f9cd81d8348bbbe6e2ece818609c" title="Obtiene el error norma 2 entre dos vectores." alt="" coords="315,207,461,235"><area shape="rect" id="node15" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector." alt="" coords="589,207,701,235"><area shape="rect" id="node18" href="../../d2/dee/class_archivo.html#d1120aa3740cdc037ce2a3fb49351133" title="Escribe un Vector a un archivo (Recordar cambiar a Escribe_Vector)." alt="" coords="308,157,468,185"><area shape="rect" id="node21" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones." alt="" coords="284,359,492,387"><area shape="rect" id="node23" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria." alt="" coords="308,410,468,438"><area shape="rect" id="node25" href="../../dd/d6d/class_matriz___dispersa.html#ca785dc7b313b03593c78aa358f95c10" title="Producto matriz dispersa por un vector." alt="" coords="264,309,512,337"><area shape="rect" id="node37" href="../../d2/dee/class_archivo.html#4c756c8da75fab13f1c0b5cc636b2724" title="Define el tipo de acceso al archivo." alt="" coords="327,511,449,539"><area shape="rect" id="node39" href="../../d2/dee/class_archivo.html#3960a9c7863da75e6e704a668c488293" title="Asigna un nombre al archivo." alt="" coords="320,562,456,590"><area shape="rect" id="node41" href="../../d5/db2/class_vector.html#db22a12698caef87688b1577be609a93" title="Calcula el vector Normal." alt="" coords="312,613,464,641"><area shape="rect" id="node7" href="../../d5/db2/class_vector.html#1e61a24886a05a02609e75c3d2a53e16" title="Visualiza información general de la matriz." alt="" coords="801,233,961,261"><area shape="rect" id="node29" href="../../dd/d59/class_vector___entero.html#d1d5779a63bf05b51bec19fa6a03cd29" title="Retorna el numero de columnas." alt="" coords="560,359,731,387"><area shape="rect" id="node32" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col." alt="" coords="567,309,724,337"><area shape="rect" id="node34" href="../../dd/d59/class_vector___entero.html#f598217377e836e5c86f5c15ae8c6502" title="Visualiza información general de la matriz." alt="" coords="779,309,984,337"></map>
</div>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_f2efe219c73509e50385d87a326a7c0e_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_f2efe219c73509e50385d87a326a7c0e_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_f2efe219c73509e50385d87a326a7c0e_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="265,5,460,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="511,5,559,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="6e7fa4c926d3ccf67a5ea93831b13b7f"></a><!-- doxytag: member="Sistema_Lineal::LSQR_Resolver_Normal" ref="6e7fa4c926d3ccf67a5ea93831b13b7f" args="(Matriz *A, Vector *x, Vector *b, int Tipo_Parada, int traza)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::LSQR_Resolver_Normal           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Tipo_Parada</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>traza</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Algoritmo LSQR. 
<p>
LSQR con matriz tradicional. 
<p>Definición en la línea <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00578">578</a> del archivo <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00021">Archivo::Abrir()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00037">Vector::Asigna()</a>, <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00012">Archivo::Cerrar()</a>, <a class="el" href="../../db/d20/_vector_8hpp_source.html#l00084">Vector::Columnas()</a>, <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00002">Condicion_Convergencia</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00236">Vector::Error_Norma2()</a>, <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00052">Archivo::Escribe_Vector()</a>, <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00057">Get_Iteraciones()</a>, <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00005">GRABA_ARCHIVO</a>, <a class="el" href="../../db/d20/_vector_8hpp_source.html#l00059">Vector::Libera_Memoria()</a>, <a class="el" href="../../d1/d8b/_matriz_8cpp_source.html#l00218">Matriz::Multiplica()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00051">Vector::Retorna()</a>, <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00053">Archivo::SetModo()</a>, <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00049">Archivo::SetNombre()</a>, y <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00201">Vector::Vector_Normal()</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00579"></a>00579 {
<a name="l00580"></a>00580          <span class="keywordtype">double</span> tolerancia=0.00000001;
<a name="l00581"></a>00581      <span class="keywordtype">double</span> theta, alpha, beta, phi, phibar, rho, rhobar;
<a name="l00582"></a>00582      <span class="keywordtype">double</span> c, s;
<a name="l00583"></a>00583      <span class="keywordtype">double</span> arnorm;
<a name="l00584"></a>00584          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> nfilas, ncols,iter;
<a name="l00585"></a>00585      nfilas=ncols=x-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>();
<a name="l00586"></a>00586          <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *ERROR=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(<a class="code" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones.">Get_Iteraciones</a>());
<a name="l00587"></a>00587          <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *u=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas);
<a name="l00588"></a>00588         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *v=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(ncols);
<a name="l00589"></a>00589         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *w=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(ncols);
<a name="l00590"></a>00590         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *x_star=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas);
<a name="l00591"></a>00591         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *x_new=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(ncols);
<a name="l00592"></a>00592         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *x_aux=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas);
<a name="l00593"></a>00593         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *Norma2=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas);
<a name="l00594"></a>00594         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *AX=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas);
<a name="l00595"></a>00595          <span class="keywordtype">double</span> suma=0.0;  
<a name="l00596"></a>00596          <span class="keywordtype">double</span> suma_n1=10e9;
<a name="l00597"></a>00597          <span class="keywordtype">double</span> diferencia=10e9;
<a name="l00598"></a>00598          <span class="keywordtype">int</span> contador_verificacion=0;
<a name="l00599"></a>00599          <span class="keywordtype">double</span> inicioLSQR,finalLSQR;
<a name="l00600"></a>00600      inicioLSQR=MPI_Wtime();
<a name="l00601"></a>00601          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0; j &lt; nfilas; j++)
<a name="l00602"></a>00602          u-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(j,b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j));     
<a name="l00603"></a>00603   
<a name="l00604"></a>00604          beta=b-&gt;<a class="code" href="../../d5/db2/class_vector.html#db22a12698caef87688b1577be609a93" title="Calcula el vector Normal.">Vector_Normal</a>();
<a name="l00605"></a>00605         
<a name="l00606"></a>00606          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0; j &lt; nfilas; j++) 
<a name="l00607"></a>00607          {
<a name="l00608"></a>00608       u-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(j,u-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j)/beta); <span class="comment">//Muchos ceros pero no es relevante para la complejidad del algorimto</span>
<a name="l00609"></a>00609          }
<a name="l00610"></a>00610          
<a name="l00611"></a>00611          A-&gt;<a class="code" href="../../d4/d09/class_matriz.html#f508444c1182581eebcca988cdc28e26" title="Multiplica la matriz por el escalar ESC.">Multiplica</a>(u,v); <span class="comment">// Solo multiplica muy pocos valores 3*n_fuentes como maximo </span>
<a name="l00612"></a>00612 
<a name="l00613"></a>00613          alpha = v-&gt;<a class="code" href="../../d5/db2/class_vector.html#db22a12698caef87688b1577be609a93" title="Calcula el vector Normal.">Vector_Normal</a>();
<a name="l00614"></a>00614      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i=0; i &lt; ncols; i++)
<a name="l00615"></a>00615      {
<a name="l00616"></a>00616                 v-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,v-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i)/alpha);
<a name="l00617"></a>00617         w-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,v-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i));
<a name="l00618"></a>00618          }
<a name="l00619"></a>00619         
<a name="l00620"></a>00620      arnorm = alpha * beta;
<a name="l00621"></a>00621      phibar = beta;
<a name="l00622"></a>00622      rhobar = alpha;
<a name="l00623"></a>00623 
<a name="l00624"></a>00624      printf(<span class="stringliteral">"Iterando...\n"</span>);
<a name="l00625"></a>00625          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i=0;
<a name="l00626"></a>00626          <span class="keywordflow">while</span>( ( Tipo_Parada==1  ) ||  ( Tipo_Parada == 0 &amp;&amp; ( diferencia &gt; tolerancia || contador_verificacion != <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#af0fd8b5d5b6c134b4d5574136a09f00">Condicion_Convergencia</a>) ) )
<a name="l00627"></a>00627     {
<a name="l00628"></a>00628   
<a name="l00629"></a>00629 
<a name="l00630"></a>00630      A-&gt;<a class="code" href="../../d4/d09/class_matriz.html#f508444c1182581eebcca988cdc28e26" title="Multiplica la matriz por el escalar ESC.">Multiplica</a>(v,x_star);
<a name="l00631"></a>00631 
<a name="l00632"></a>00632                    
<a name="l00633"></a>00633    finalLSQR=MPI_Wtime();       
<a name="l00634"></a>00634      
<a name="l00635"></a>00635                    
<a name="l00636"></a>00636    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0; j &lt; nfilas; j++)
<a name="l00637"></a>00637     u-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(j,x_star-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j) - alpha*u-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j));
<a name="l00638"></a>00638 
<a name="l00639"></a>00639     beta=u-&gt;<a class="code" href="../../d5/db2/class_vector.html#db22a12698caef87688b1577be609a93" title="Calcula el vector Normal.">Vector_Normal</a>();
<a name="l00640"></a>00640          <span class="keywordflow">if</span> (beta == 0.0)
<a name="l00641"></a>00641            {
<a name="l00642"></a>00642             printf(<span class="stringliteral">"El vector normal no pude ser cero, el programa finalizara el proceso de resolucion LSQR \n"</span>);
<a name="l00643"></a>00643         MPI_Finalize();
<a name="l00644"></a>00644                 exit(1);
<a name="l00645"></a>00645            }
<a name="l00646"></a>00646 
<a name="l00647"></a>00647          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0; j &lt; nfilas; j++)
<a name="l00648"></a>00648       u-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(j,u-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j)/beta);
<a name="l00649"></a>00649         
<a name="l00650"></a>00650          
<a name="l00651"></a>00651 
<a name="l00652"></a>00652                 <span class="comment">//MDA-&gt;Producto_MA_Vector(u,x_new);</span>
<a name="l00653"></a>00653         A-&gt;<a class="code" href="../../d4/d09/class_matriz.html#f508444c1182581eebcca988cdc28e26" title="Multiplica la matriz por el escalar ESC.">Multiplica</a>(u,x_new);
<a name="l00654"></a>00654 
<a name="l00655"></a>00655 
<a name="l00656"></a>00656 
<a name="l00657"></a>00657      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> k=0; k &lt; ncols; k++)
<a name="l00658"></a>00658          v-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(k, x_new-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k) - beta*v-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k) );  
<a name="l00659"></a>00659          alpha=v-&gt;<a class="code" href="../../d5/db2/class_vector.html#db22a12698caef87688b1577be609a93" title="Calcula el vector Normal.">Vector_Normal</a>();
<a name="l00660"></a>00660          <span class="keywordflow">if</span> (alpha == 0.0)
<a name="l00661"></a>00661          {
<a name="l00662"></a>00662         printf(<span class="stringliteral">"El vector normal no pude ser cero, el programa finalizara el proceso de resolucion LSQR \n"</span>);
<a name="l00663"></a>00663         MPI_Finalize();
<a name="l00664"></a>00664                 exit(1);
<a name="l00665"></a>00665          }
<a name="l00666"></a>00666 
<a name="l00667"></a>00667          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> k=0; k &lt; ncols; k++)
<a name="l00668"></a>00668      v-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(k, v-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k)/alpha);         
<a name="l00669"></a>00669 
<a name="l00670"></a>00670          <span class="comment">// Construccion y aplicacion de la siguiente transformacion ortogonal</span>
<a name="l00671"></a>00671          
<a name="l00672"></a>00672          rho    =  sqrt( rhobar*rhobar + beta*beta );
<a name="l00673"></a>00673          c      =  rhobar / rho;
<a name="l00674"></a>00674          s      =  beta   / rho;
<a name="l00675"></a>00675          theta  =  s * alpha;
<a name="l00676"></a>00676          rhobar = -c * alpha;
<a name="l00677"></a>00677          phi    =  c * phibar;
<a name="l00678"></a>00678          phibar =  s * phibar;
<a name="l00679"></a>00679 
<a name="l00680"></a>00680 
<a name="l00681"></a>00681          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> k=0; k &lt; ncols; k++)
<a name="l00682"></a>00682            {
<a name="l00683"></a>00683            x-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(k,x-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k) +   (phi/rho) * w-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k)   );
<a name="l00684"></a>00684        w-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(k,v-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k) - (theta/rho) * w-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k));           
<a name="l00685"></a>00685            }
<a name="l00686"></a>00686 
<a name="l00687"></a>00687      <span class="comment">//MDA-&gt;Producto_MA_Vector(x,AX); </span>
<a name="l00688"></a>00688          <span class="keywordflow">if</span>(Tipo_Parada==0 || ( Tipo_Parada ==1 &amp;&amp; traza == 1 ))
<a name="l00689"></a>00689      {  
<a name="l00690"></a>00690          A-&gt;<a class="code" href="../../d4/d09/class_matriz.html#f508444c1182581eebcca988cdc28e26" title="Multiplica la matriz por el escalar ESC.">Multiplica</a>(x,AX);
<a name="l00691"></a>00691            
<a name="l00692"></a>00692      <span class="keywordflow">if</span>(i!=0)
<a name="l00693"></a>00693          suma_n1=suma;  
<a name="l00694"></a>00694      
<a name="l00695"></a>00695          suma=Norma2-&gt;<a class="code" href="../../d5/db2/class_vector.html#e192f9cd81d8348bbbe6e2ece818609c" title="Obtiene el error norma 2 entre dos vectores.">Error_Norma2</a>(AX,b);
<a name="l00696"></a>00696          diferencia=suma_n1-suma;
<a name="l00697"></a>00697      }
<a name="l00698"></a>00698          
<a name="l00699"></a>00699          <span class="keywordflow">if</span>(i%1==0.0 &amp;&amp;  traza==1 || ( i%100==0.0 &amp;&amp;traza==2 ))
<a name="l00700"></a>00700          {
<a name="l00701"></a>00701      printf(<span class="stringliteral">"La suma en [ %Ld] es: (t = %f, t-1 = %f)  DIf = (%f) \n"</span>, i,suma,suma_n1,diferencia);
<a name="l00702"></a>00702          }
<a name="l00703"></a>00703          
<a name="l00704"></a>00704          <span class="keywordflow">if</span>(Tipo_Parada==0)
<a name="l00705"></a>00705          {       
<a name="l00706"></a>00706      <span class="keywordflow">if</span>(diferencia&lt;=tolerancia)
<a name="l00707"></a>00707      contador_verificacion++;
<a name="l00708"></a>00708          <span class="keywordflow">else</span>
<a name="l00709"></a>00709          contador_verificacion=0;        
<a name="l00710"></a>00710     }
<a name="l00711"></a>00711         
<a name="l00712"></a>00712          <span class="keywordflow">if</span>(Tipo_Parada==0 || ( Tipo_Parada ==1 &amp;&amp; traza == 1 ) )
<a name="l00713"></a>00713          ERROR-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,suma);
<a name="l00714"></a>00714          i++;
<a name="l00715"></a>00715      <span class="keywordflow">if</span>(i == <a class="code" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones.">Get_Iteraciones</a>())
<a name="l00716"></a>00716          <span class="keywordflow">break</span>; 
<a name="l00717"></a>00717          iter=i;
<a name="l00718"></a>00718 
<a name="l00719"></a>00719  }
<a name="l00720"></a>00720  
<a name="l00721"></a>00721     <span class="keywordflow">if</span>(traza==1)
<a name="l00722"></a>00722         {
<a name="l00723"></a>00723         <span class="keywordtype">char</span> *NombreSolucion=<span class="stringliteral">"ERROR_LSQR.dat"</span>;
<a name="l00724"></a>00724         <a class="code" href="../../d2/dee/class_archivo.html" title="Clase para manipular archivos.">Archivo</a> *ERROR_ARCHIVO=<span class="keyword">new</span> <a class="code" href="../../d2/dee/class_archivo.html" title="Clase para manipular archivos.">Archivo</a>();
<a name="l00725"></a>00725         ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#3960a9c7863da75e6e704a668c488293" title="Asigna un nombre al archivo.">SetNombre</a>(NombreSolucion);
<a name="l00726"></a>00726         ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#4c756c8da75fab13f1c0b5cc636b2724" title="Define el tipo de acceso al archivo.">SetModo</a>(<a class="code" href="../../de/dc7/_archivo_8hpp.html#406416501f9b8dd55765eb0686ced406">GRABA_ARCHIVO</a>);  
<a name="l00727"></a>00727         ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#812b1ef63ac695139f6b4bfb3aa7ff81" title="Abre el archivo.">Abrir</a>();
<a name="l00728"></a>00728     ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#d1120aa3740cdc037ce2a3fb49351133" title="Escribe un Vector a un archivo (Recordar cambiar a Escribe_Vector).">Escribe_Vector</a>(ERROR,ERROR-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>());   
<a name="l00729"></a>00729     ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#9dd5f77b08f09bfef21f03e5a0080bcb" title="Cierra el archivo.">Cerrar</a>();
<a name="l00730"></a>00730     }
<a name="l00731"></a>00731     <span class="keywordflow">if</span>(suma &gt; 1000)
<a name="l00732"></a>00732         {
<a name="l00733"></a>00733         printf(<span class="stringliteral">"\n\n  ************ ATENCION ES MUY PROBABLE QUE LA APROXIMACION SEA INCORRECTA POR UNA MALA TRIANGULACION DE MALLA FEM UTILIZADA  *****************     \n\n"</span>); 
<a name="l00734"></a>00734         }       
<a name="l00735"></a>00735  
<a name="l00736"></a>00736     printf(<span class="stringliteral">"Iteraciones: %Ld  en   %f segundos con norma 2=%f y diferencia = %f\n"</span>,iter,finalLSQR-inicioLSQR,suma,diferencia);
<a name="l00737"></a>00737         
<a name="l00738"></a>00738         u-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00739"></a>00739         v-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00740"></a>00740         w-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00741"></a>00741         x_star-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00742"></a>00742         x_new-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00743"></a>00743         x_aux-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00744"></a>00744   
<a name="l00745"></a>00745 }    
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_6e7fa4c926d3ccf67a5ea93831b13b7f_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_6e7fa4c926d3ccf67a5ea93831b13b7f_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_6e7fa4c926d3ccf67a5ea93831b13b7f_cgraph_map">
<area shape="rect" id="node3" href="../../d2/dee/class_archivo.html#812b1ef63ac695139f6b4bfb3aa7ff81" title="Abre el archivo." alt="" coords="368,5,467,33"><area shape="rect" id="node5" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col." alt="" coords="573,106,680,134"><area shape="rect" id="node9" href="../../d2/dee/class_archivo.html#9dd5f77b08f09bfef21f03e5a0080bcb" title="Cierra el archivo." alt="" coords="364,106,471,134"><area shape="rect" id="node11" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas." alt="" coords="355,157,480,185"><area shape="rect" id="node13" href="../../d5/db2/class_vector.html#e192f9cd81d8348bbbe6e2ece818609c" title="Obtiene el error norma 2 entre dos vectores." alt="" coords="344,207,491,235"><area shape="rect" id="node15" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector." alt="" coords="571,233,683,261"><area shape="rect" id="node18" href="../../d2/dee/class_archivo.html#d1120aa3740cdc037ce2a3fb49351133" title="Escribe un Vector a un archivo (Recordar cambiar a Escribe_Vector)." alt="" coords="337,309,497,337"><area shape="rect" id="node21" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones." alt="" coords="313,359,521,387"><area shape="rect" id="node23" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria." alt="" coords="337,410,497,438"><area shape="rect" id="node25" href="../../d4/d09/class_matriz.html#f508444c1182581eebcca988cdc28e26" title="Multiplica la matriz por el escalar ESC." alt="" coords="357,461,477,489"><area shape="rect" id="node32" href="../../d2/dee/class_archivo.html#4c756c8da75fab13f1c0b5cc636b2724" title="Define el tipo de acceso al archivo." alt="" coords="356,511,479,539"><area shape="rect" id="node34" href="../../d2/dee/class_archivo.html#3960a9c7863da75e6e704a668c488293" title="Asigna un nombre al archivo." alt="" coords="349,562,485,590"><area shape="rect" id="node36" href="../../d5/db2/class_vector.html#db22a12698caef87688b1577be609a93" title="Calcula el vector Normal." alt="" coords="341,613,493,641"><area shape="rect" id="node7" href="../../d5/db2/class_vector.html#1e61a24886a05a02609e75c3d2a53e16" title="Visualiza información general de la matriz." alt="" coords="731,170,891,198"><area shape="rect" id="node27" href="../../d4/d09/class_matriz.html#ef90ff9c24c5474b0e09818be945207a" title="Asigna valor en fila, columna." alt="" coords="575,435,679,463"><area shape="rect" id="node29" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna." alt="" coords="572,486,681,514"></map>
</div>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_6e7fa4c926d3ccf67a5ea93831b13b7f_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_6e7fa4c926d3ccf67a5ea93831b13b7f_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_6e7fa4c926d3ccf67a5ea93831b13b7f_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="313,5,508,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="559,5,607,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="2b9e62158dcb700a20e8f429c8c50454"></a><!-- doxytag: member="Sistema_Lineal::LSQR_Resolver_Paralelo" ref="2b9e62158dcb700a20e8f429c8c50454" args="(Vector *x, Vector *b, unsigned long long *iParticion, Vector_Entero *COLUMNAS, Vector_Entero *INDICES, Vector *DATOS, int Tipo_Parada, int traza)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::LSQR_Resolver_Paralelo           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long long *&nbsp;</td>
          <td class="paramname"> <em>iParticion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d59/class_vector___entero.html">Vector_Entero</a> *&nbsp;</td>
          <td class="paramname"> <em>COLUMNAS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d59/class_vector___entero.html">Vector_Entero</a> *&nbsp;</td>
          <td class="paramname"> <em>INDICES</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>DATOS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Tipo_Parada</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>traza</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Algoritmo LSQR paralelo para matrices dispersas. 
<p>

<p>
Muestra cada 100 iteraciones un contador en pantalla... 
<p>Definición en la línea <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00085">85</a> del archivo <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00021">Archivo::Abrir()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00037">Vector::Asigna()</a>, <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00012">Archivo::Cerrar()</a>, <a class="el" href="../../d2/dbe/_vector___entero_8hpp_source.html#l00080">Vector_Entero::Columnas()</a>, <a class="el" href="../../db/d20/_vector_8hpp_source.html#l00084">Vector::Columnas()</a>, <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00002">Condicion_Convergencia</a>, <a class="el" href="../../d8/d7f/_rutinas___paralelas_8cpp_source.html#l00280">Rutinas_Paralelas::Envio_Dato_Entero()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00236">Vector::Error_Norma2()</a>, <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00052">Archivo::Escribe_Vector()</a>, <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00057">Get_Iteraciones()</a>, <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00005">GRABA_ARCHIVO</a>, <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00024">INDICE_FILAS</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00030">Vector::Inicializa()</a>, <a class="el" href="../../db/d20/_vector_8hpp_source.html#l00059">Vector::Libera_Memoria()</a>, <a class="el" href="../../d8/d7f/_rutinas___paralelas_8cpp_source.html#l00104">Rutinas_Paralelas::Producto_Matriz_Dispersa_Vector()</a>, <a class="el" href="../../d8/d7f/_rutinas___paralelas_8cpp_source.html#l00140">Rutinas_Paralelas::Producto_Matriz_Dispersa_Vector_Seccion()</a>, <a class="el" href="../../d8/d7f/_rutinas___paralelas_8cpp_source.html#l00070">Rutinas_Paralelas::Producto_MatrizT_Dispersa_Vector()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00188">Vector::Producto_Punto()</a>, <a class="el" href="../../d8/d7f/_rutinas___paralelas_8cpp_source.html#l00286">Rutinas_Paralelas::Recibe_Dato_Entero()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00051">Vector::Retorna()</a>, <a class="el" href="../../d4/d83/_vector___entero_8cpp_source.html#l00049">Vector_Entero::Retorna()</a>, <a class="el" href="../../db/d20/_vector_8hpp_source.html#l00068">Vector::Retorna_Puntero_Datos()</a>, <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00053">Archivo::SetModo()</a>, <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00049">Archivo::SetNombre()</a>, <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00003">Tiempo_Inicial_Comunicacion_LSQR</a>, <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00003">Tiempo_Parcial_Comunicacion_LSQR</a>, <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00026">tSistema</a>, y <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00201">Vector::Vector_Normal()</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00086"></a>00086 {
<a name="l00087"></a>00087      <span class="keywordtype">double</span> tolerancia=0.00000001;<span class="comment">//10e-8;</span>
<a name="l00088"></a>00088     <span class="keywordtype">int</span> size,rank;
<a name="l00089"></a>00089         <span class="keywordtype">int</span> TAG_iFila=10;       
<a name="l00090"></a>00090         
<a name="l00091"></a>00091     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>  *Inicio_Fila;
<a name="l00092"></a>00092         <span class="keywordtype">int</span> *DESP;
<a name="l00093"></a>00093         <span class="keywordtype">int</span> *convergencia=<span class="keyword">new</span> <span class="keywordtype">int</span>[1];
<a name="l00094"></a>00094         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> *iFila=<span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>[1];
<a name="l00095"></a>00095         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> *desplazamiento=<span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>[1];
<a name="l00096"></a>00096         <span class="keywordtype">double</span> suma=0.0;   
<a name="l00097"></a>00097         <span class="keywordtype">double</span> inicioLSQR,finalLSQR; 
<a name="l00098"></a>00098         <span class="comment">//double Tiempo_Producto_inicio,Tiempo_Producto_Final;</span>
<a name="l00099"></a>00099     
<a name="l00100"></a>00100         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> contador_global;
<a name="l00101"></a>00101     <span class="keywordtype">double</span> theta,phi, phibar, rho, rhobar;
<a name="l00102"></a>00102     <span class="keywordtype">double</span> c, s;
<a name="l00103"></a>00103     <span class="keywordtype">double</span> arnorm,pPunto,normaB,normaA;
<a name="l00104"></a>00104         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> nfilas, ncols,ctmp;
<a name="l00105"></a>00105     
<a name="l00106"></a>00106     <span class="keywordtype">double</span> suma_n1=10e9;
<a name="l00107"></a>00107         <span class="keywordtype">double</span> diferencia;
<a name="l00108"></a>00108     <span class="keywordtype">int</span> contador_verificacion=0;
<a name="l00109"></a>00109         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> dim;
<a name="l00110"></a>00110                 
<a name="l00111"></a>00111         
<a name="l00112"></a>00112     MPI_Comm_rank(MPI_COMM_WORLD,&amp;rank);        
<a name="l00113"></a>00113         MPI_Comm_size(MPI_COMM_WORLD, &amp;size);
<a name="l00114"></a>00114  
<a name="l00115"></a>00115         nfilas=ncols=x-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>();
<a name="l00116"></a>00116     convergencia[0]=0;
<a name="l00117"></a>00117         dim = iParticion[0] - 1;        
<a name="l00118"></a>00118         desplazamiento[0]=dim;
<a name="l00119"></a>00119     contador_global=0;
<a name="l00120"></a>00120         
<a name="l00121"></a>00121         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *U=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(dim,<span class="stringliteral">"U"</span>);  
<a name="l00122"></a>00122         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *ERROR=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(<a class="code" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones.">Get_Iteraciones</a>());
<a name="l00123"></a>00123         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *u=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas,<span class="stringliteral">"u"</span>);
<a name="l00124"></a>00124         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *w=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas,<span class="stringliteral">"w"</span>);
<a name="l00125"></a>00125         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *v=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas,<span class="stringliteral">"v"</span>);               
<a name="l00126"></a>00126         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *ax=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(dim,<span class="stringliteral">"ax"</span>);
<a name="l00127"></a>00127         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *V=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas,<span class="stringliteral">"V"</span>);       
<a name="l00128"></a>00128         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *AX=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas,<span class="stringliteral">"AX"</span>);     
<a name="l00129"></a>00129         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *Norma2=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas,<span class="stringliteral">"Norma2"</span>);     
<a name="l00130"></a>00130         <a class="code" href="../../d9/daf/class_rutinas___paralelas.html" title="Clase para trabajar con rutinas paralelas en almacenamiento y calculos.">Rutinas_Paralelas</a> *RUTINA;
<a name="l00131"></a>00131         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *x_star=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(dim,<span class="stringliteral">"XSTAR"</span>); 
<a name="l00132"></a>00132         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *x_new=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas,<span class="stringliteral">"XNEW"</span>);
<a name="l00133"></a>00133         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *X_NEW=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nfilas,<span class="stringliteral">"X_NEW"</span>);       
<a name="l00134"></a>00134                 
<a name="l00135"></a>00135         <span class="keywordflow">if</span>(rank==0)
<a name="l00136"></a>00136         { 
<a name="l00137"></a>00137                 inicioLSQR=MPI_Wtime();
<a name="l00138"></a>00138             Inicio_Fila = <span class="keyword">new</span>   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>  [<a class="code" href="../../d9/d85/class_sistema___lineal.html#22ec3a7c7156c6f16ca0ad38b6bd8aaf" title="Usado en el calculo paralelo para indicar fila inicial global.">INDICE_FILAS</a>-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#d1d5779a63bf05b51bec19fa6a03cd29" title="Retorna el numero de columnas.">Columnas</a>()];
<a name="l00139"></a>00139                 DESP = <span class="keyword">new</span> <span class="keywordtype">int</span> [(int) <a class="code" href="../../d9/d85/class_sistema___lineal.html#22ec3a7c7156c6f16ca0ad38b6bd8aaf" title="Usado en el calculo paralelo para indicar fila inicial global.">INDICE_FILAS</a>-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#d1d5779a63bf05b51bec19fa6a03cd29" title="Retorna el numero de columnas.">Columnas</a>()];
<a name="l00140"></a>00140                 Inicio_Fila[0]=0;
<a name="l00141"></a>00141                 iFila[0]=0;
<a name="l00142"></a>00142                 DESP[0]=dim;
<a name="l00143"></a>00143         <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#e6004a37dd8a8d722fdecf44f41bc225">Tiempo_Inicial_Comunicacion_LSQR</a>=MPI_Wtime();    
<a name="l00144"></a>00144                         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;size;i++)
<a name="l00145"></a>00145                         {
<a name="l00146"></a>00146                                 DESP[i] =(int) ( Inicio_Fila[ ( i-1 ) ] + <a class="code" href="../../d9/d85/class_sistema___lineal.html#22ec3a7c7156c6f16ca0ad38b6bd8aaf" title="Usado en el calculo paralelo para indicar fila inicial global.">INDICE_FILAS</a>-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(i));    <span class="comment">//original</span>
<a name="l00147"></a>00147                                 Inicio_Fila[i] = (      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> long ) dim*i; 
<a name="l00148"></a>00148                                 RUTINA-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#0e4f48806ae96b733b4571c86ed760eb" title="Envia un mensaje que contiene un dato entero.">Envio_Dato_Entero</a>(i,TAG_iFila,Inicio_Fila[i]); <span class="comment">// Envio la fila inicial</span>
<a name="l00149"></a>00149                                 
<a name="l00150"></a>00150                         }               
<a name="l00151"></a>00151                 
<a name="l00152"></a>00152          }
<a name="l00153"></a>00153   
<a name="l00154"></a>00154     <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#d001fb2b1e5819789a5252035bd795dc">Tiempo_Parcial_Comunicacion_LSQR</a>=0.0;
<a name="l00155"></a>00155         
<a name="l00156"></a>00156         <span class="keywordflow">if</span>(rank!=0)
<a name="l00157"></a>00157         {       
<a name="l00158"></a>00158                 RUTINA-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#75f07d2a047ad643fcf2f3c1acf5604d" title="Recibe un mensaje que contiene un dato entero.">Recibe_Dato_Entero</a>(0,TAG_iFila,iFila); <span class="comment">// Recibo la fila inicial</span>
<a name="l00159"></a>00159         }       
<a name="l00160"></a>00160         <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#d001fb2b1e5819789a5252035bd795dc">Tiempo_Parcial_Comunicacion_LSQR</a>+=MPI_Wtime() - <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#e6004a37dd8a8d722fdecf44f41bc225">Tiempo_Inicial_Comunicacion_LSQR</a>;
<a name="l00161"></a>00161         
<a name="l00162"></a>00162         
<a name="l00163"></a>00163   
<a name="l00164"></a>00164  
<a name="l00165"></a>00165 
<a name="l00166"></a>00166                                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0; j &lt; nfilas; j++)
<a name="l00167"></a>00167                                  u-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(j,b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j));     
<a name="l00168"></a>00168                           
<a name="l00169"></a>00169                                  normaB=b-&gt;<a class="code" href="../../d5/db2/class_vector.html#db22a12698caef87688b1577be609a93" title="Calcula el vector Normal.">Vector_Normal</a>();
<a name="l00170"></a>00170                                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0; j &lt; nfilas; j++) 
<a name="l00171"></a>00171                                  {
<a name="l00172"></a>00172                                   u-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(j,u-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j)/normaB);
<a name="l00173"></a>00173                                  }
<a name="l00174"></a>00174  
<a name="l00175"></a>00175                                  
<a name="l00176"></a>00176                                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0; j &lt; dim; j++) 
<a name="l00177"></a>00177                                  {
<a name="l00178"></a>00178                                   ctmp=j + iFila[0];     
<a name="l00179"></a>00179                                   U-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(j,u-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(ctmp)  ); 
<a name="l00180"></a>00180                                  }
<a name="l00181"></a>00181                                  
<a name="l00182"></a>00182 
<a name="l00183"></a>00183                                  
<a name="l00184"></a>00184 
<a name="l00185"></a>00185                                  RUTINA-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#64a4c2c4d1c46176706617cb510155c9" title="Multiplica una matriz dispersa por un vector, guardando en una seccion el vector...">Producto_Matriz_Dispersa_Vector_Seccion</a>(u,v,INDICES,COLUMNAS,DATOS,dim,iFila[0]);
<a name="l00186"></a>00186                                  
<a name="l00187"></a>00187                                  <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#e6004a37dd8a8d722fdecf44f41bc225">Tiempo_Inicial_Comunicacion_LSQR</a>=MPI_Wtime();
<a name="l00188"></a>00188                                  MPI_Allreduce( v-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(), V-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),nfilas, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD );
<a name="l00189"></a>00189                                  <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#d001fb2b1e5819789a5252035bd795dc">Tiempo_Parcial_Comunicacion_LSQR</a>+=MPI_Wtime() - <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#e6004a37dd8a8d722fdecf44f41bc225">Tiempo_Inicial_Comunicacion_LSQR</a>;
<a name="l00190"></a>00190                                  normaA = V-&gt;<a class="code" href="../../d5/db2/class_vector.html#db22a12698caef87688b1577be609a93" title="Calcula el vector Normal.">Vector_Normal</a>();
<a name="l00191"></a>00191                                  
<a name="l00192"></a>00192                                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i=0; i &lt; ncols; i++)
<a name="l00193"></a>00193                                  {
<a name="l00194"></a>00194                                         V-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,V-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i)/normaA);
<a name="l00195"></a>00195                                         w-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,V-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i));
<a name="l00196"></a>00196                                  }
<a name="l00197"></a>00197                                 
<a name="l00198"></a>00198                                  arnorm = normaA * normaB;
<a name="l00199"></a>00199                                  phibar = normaB; 
<a name="l00200"></a>00200                                  rhobar = normaA;
<a name="l00201"></a>00201         <span class="keywordflow">if</span>(rank==0) 
<a name="l00202"></a>00202     printf(<span class="stringliteral">"Comunicacion Inicial: %f"</span>,Tiempo_Parcial_Comunicacion_LSQR);
<a name="l00203"></a>00203 
<a name="l00204"></a>00204     <span class="keywordflow">while</span>(  ( Tipo_Parada ==1  ) ||  ( Tipo_Parada == 0 &amp;&amp; convergencia[0] == 0 ) ) <span class="comment">// Para en base a numero de iteraciones o en base a que se alacanza convergencia</span>
<a name="l00205"></a>00205     {
<a name="l00206"></a>00206             <span class="comment">//1 Multiplicacion</span>
<a name="l00207"></a>00207 
<a name="l00208"></a>00208                 <span class="comment">//Tiempo_Producto_inicio = MPI_Wtime();</span>
<a name="l00209"></a>00209                 RUTINA-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#40b52e00f2965f80e1241e6446e76ef5" title="Multiplica una matriz dispersa por un vector, guardando en vector salida el resultado...">Producto_Matriz_Dispersa_Vector</a>(V,x_star,INDICES,COLUMNAS,DATOS);
<a name="l00210"></a>00210         
<a name="l00211"></a>00211                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0; j &lt; dim; j++)
<a name="l00212"></a>00212                 U-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(j, (x_star-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j) - normaA*U-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j)));
<a name="l00213"></a>00213                 
<a name="l00214"></a>00214         pPunto=U-&gt;<a class="code" href="../../d5/db2/class_vector.html#1997155ab1b68e6e06bcc7fe8cbb23d0" title="Calcula el producto punto.">Producto_Punto</a>();
<a name="l00215"></a>00215                 
<a name="l00216"></a>00216                 <span class="comment">// 1 comunicacion ( pequenio)</span>
<a name="l00217"></a>00217                 <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#e6004a37dd8a8d722fdecf44f41bc225">Tiempo_Inicial_Comunicacion_LSQR</a>=MPI_Wtime(); 
<a name="l00218"></a>00218                 MPI_Allreduce( &amp;pPunto, &amp;normaB, 1, MPI_DOUBLE, MPI_SUM,MPI_COMM_WORLD ); <span class="comment">// Comunicacion minima</span>
<a name="l00219"></a>00219                 Tiempo_Parcial_Comunicacion_LSQR+=MPI_Wtime() - <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#e6004a37dd8a8d722fdecf44f41bc225">Tiempo_Inicial_Comunicacion_LSQR</a>;
<a name="l00220"></a>00220         
<a name="l00221"></a>00221                 normaB=(double)sqrt(normaB);
<a name="l00222"></a>00222                 
<a name="l00223"></a>00223            <span class="keywordflow">if</span> (normaB == 0.0)
<a name="l00224"></a>00224            {
<a name="l00225"></a>00225                 printf(<span class="stringliteral">"Vector normal en LSQR = 0.0 el programa no continuara\n"</span>);
<a name="l00226"></a>00226                 MPI_Finalize();
<a name="l00227"></a>00227         exit(1);
<a name="l00228"></a>00228            }
<a name="l00229"></a>00229                                         
<a name="l00230"></a>00230                                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0; j &lt; dim; j++) 
<a name="l00231"></a>00231                                  {
<a name="l00232"></a>00232                                    U-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(j,U-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j)/normaB  ); 
<a name="l00233"></a>00233                                  }
<a name="l00234"></a>00234                                 
<a name="l00235"></a>00235                                 x_new-&gt;<a class="code" href="../../d5/db2/class_vector.html#a32c56760a4a70f2e8c976cc16db84e8" title="Inicializa con valores val el vector.">Inicializa</a>(0.0);
<a name="l00236"></a>00236                                 <span class="comment">// 2 Multiplicacion </span>
<a name="l00237"></a>00237                                 RUTINA-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#196af3cdf301ea19da6a2fa1b387844f" title="Multiplica una matriz traspuesta dispersa por un vector, guardando en vector salida...">Producto_MatrizT_Dispersa_Vector</a>(U,x_new,INDICES,COLUMNAS,DATOS,dim,iFila[0]);   
<a name="l00238"></a>00238                 
<a name="l00239"></a>00239                                 <span class="comment">// 2 comunicacion ( grande )</span>
<a name="l00240"></a>00240                                 
<a name="l00241"></a>00241                         <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#e6004a37dd8a8d722fdecf44f41bc225">Tiempo_Inicial_Comunicacion_LSQR</a>=MPI_Wtime();   
<a name="l00242"></a>00242                                 MPI_Allreduce( x_new-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(), X_NEW-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),nfilas, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD ); <span class="comment">// Comunicacion principal</span>
<a name="l00243"></a>00243                         Tiempo_Parcial_Comunicacion_LSQR+=MPI_Wtime() - <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#e6004a37dd8a8d722fdecf44f41bc225">Tiempo_Inicial_Comunicacion_LSQR</a>;
<a name="l00244"></a>00244                          
<a name="l00245"></a>00245                              <span class="comment">// Asigancion serial es mas rapida que paralela + comunicacion</span>
<a name="l00246"></a>00246                                          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> k=0; k &lt; ncols; k++)
<a name="l00247"></a>00247                                          V-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(k, X_NEW-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k) - normaB*V-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k) );  
<a name="l00248"></a>00248                                          
<a name="l00249"></a>00249                                          
<a name="l00250"></a>00250                                          <span class="comment">// Calculo de la norma de V</span>
<a name="l00251"></a>00251                                          normaA=V-&gt;<a class="code" href="../../d5/db2/class_vector.html#db22a12698caef87688b1577be609a93" title="Calcula el vector Normal.">Vector_Normal</a>();
<a name="l00252"></a>00252                                 
<a name="l00253"></a>00253                                          <span class="keywordflow">if</span> (normaA == 0.0)
<a name="l00254"></a>00254                                            {
<a name="l00255"></a>00255                                                  printf(<span class="stringliteral">"Vector normal en LSQR = 0.0 el programa no continuara\n"</span>);
<a name="l00256"></a>00256                                                  MPI_Finalize();
<a name="l00257"></a>00257                                      exit(1);
<a name="l00258"></a>00258                                            }
<a name="l00259"></a>00259                         
<a name="l00260"></a>00260                                          <span class="comment">// Normalizacion de V</span>
<a name="l00261"></a>00261                                          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> k=0; k &lt; ncols; k++)
<a name="l00262"></a>00262                                          V-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(k, V-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k)/normaA);    
<a name="l00263"></a>00263                                 
<a name="l00264"></a>00264                                          
<a name="l00265"></a>00265                                          <span class="comment">// Construccion y aplicacion de la siguiente transformacion ortogonal</span>
<a name="l00266"></a>00266                                          
<a name="l00267"></a>00267                                          rho    =  sqrt( rhobar*rhobar + normaB*normaB );
<a name="l00268"></a>00268                                          c      =  rhobar / rho;
<a name="l00269"></a>00269                                          s      =  normaB   / rho;
<a name="l00270"></a>00270                                          theta  =  s * normaA;
<a name="l00271"></a>00271                                          rhobar = -c * normaA;
<a name="l00272"></a>00272                                          phi    =  c * phibar;
<a name="l00273"></a>00273                                          phibar =  s * phibar;
<a name="l00274"></a>00274                                          
<a name="l00275"></a>00275                                                          
<a name="l00276"></a>00276                                          <span class="comment">// Actualizacion de vectores</span>
<a name="l00277"></a>00277                                          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> k=0; k &lt; ncols; k++)
<a name="l00278"></a>00278                                          {
<a name="l00279"></a>00279                                            x-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(k,x-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k) +   (phi/rho) * w-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k)   );
<a name="l00280"></a>00280                                            w-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(k,V-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k) - (theta/rho) * w-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(k));       
<a name="l00281"></a>00281                                          }
<a name="l00282"></a>00282                                  
<a name="l00283"></a>00283 
<a name="l00284"></a>00284                                            
<a name="l00285"></a>00285                   
<a name="l00286"></a>00286          <span class="keywordflow">if</span>(Tipo_Parada==0 || ( Tipo_Parada ==1 &amp;&amp; traza == 1 )) <span class="comment">// solo para efectos de seguimiento del algoritmo</span>
<a name="l00287"></a>00287      {  
<a name="l00288"></a>00288 
<a name="l00289"></a>00289                  RUTINA-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#40b52e00f2965f80e1241e6446e76ef5" title="Multiplica una matriz dispersa por un vector, guardando en vector salida el resultado...">Producto_Matriz_Dispersa_Vector</a>(x,ax,INDICES,COLUMNAS,DATOS);                  
<a name="l00290"></a>00290         
<a name="l00291"></a>00291          <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#e6004a37dd8a8d722fdecf44f41bc225">Tiempo_Inicial_Comunicacion_LSQR</a>=MPI_Wtime();   
<a name="l00292"></a>00292          MPI_Gatherv(ax-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),dim,MPI_DOUBLE,AX-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),DESP,(<span class="keywordtype">int</span>*)Inicio_Fila,MPI_DOUBLE,0,MPI_COMM_WORLD);
<a name="l00293"></a>00293          Tiempo_Parcial_Comunicacion_LSQR+=MPI_Wtime() - <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#e6004a37dd8a8d722fdecf44f41bc225">Tiempo_Inicial_Comunicacion_LSQR</a>;
<a name="l00294"></a>00294         
<a name="l00295"></a>00295                          <span class="keywordflow">if</span>(rank==0) 
<a name="l00296"></a>00296                          {                       
<a name="l00297"></a>00297                                                         <span class="keywordflow">if</span>(contador_global!=0)
<a name="l00298"></a>00298                                                         suma_n1=suma;  
<a name="l00299"></a>00299                                                         suma=Norma2-&gt;<a class="code" href="../../d5/db2/class_vector.html#e192f9cd81d8348bbbe6e2ece818609c" title="Obtiene el error norma 2 entre dos vectores.">Error_Norma2</a>(AX,b);
<a name="l00300"></a>00300                                                         diferencia=suma_n1-suma;
<a name="l00301"></a>00301         
<a name="l00302"></a>00302                                                                         
<a name="l00303"></a>00303                                                          <span class="keywordflow">if</span>(contador_global%1==0.0 &amp;&amp;  traza ==1 || ( contador_global%100==0.0 &amp;&amp;traza==2 ))
<a name="l00304"></a>00304                                                          {
<a name="l00305"></a>00305                                                             printf(<span class="stringliteral">"Iteracion %Ld \n"</span>,contador_global);
<a name="l00306"></a>00306                                                                         
<a name="l00307"></a>00307                                                          }
<a name="l00308"></a>00308                                                                          
<a name="l00309"></a>00309                                                                                  <span class="keywordflow">if</span>(Tipo_Parada==0)
<a name="l00310"></a>00310                                                                                  {       
<a name="l00311"></a>00311                                                                                  <span class="keywordflow">if</span>(diferencia&lt;=tolerancia)
<a name="l00312"></a>00312                                                                                  contador_verificacion++;
<a name="l00313"></a>00313                                                                                  <span class="keywordflow">else</span>
<a name="l00314"></a>00314                                                                                  contador_verificacion=0;        
<a name="l00315"></a>00315                                                                                 }
<a name="l00316"></a>00316                                                                                                                         
<a name="l00317"></a>00317         
<a name="l00318"></a>00318                                                         <span class="keywordflow">if</span>( diferencia &lt;= tolerancia &amp;&amp; contador_verificacion &gt;= <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#af0fd8b5d5b6c134b4d5574136a09f00">Condicion_Convergencia</a>) 
<a name="l00319"></a>00319                                                         {
<a name="l00320"></a>00320                                                                  convergencia[0]=1;
<a name="l00321"></a>00321                                                          }       
<a name="l00322"></a>00322         
<a name="l00323"></a>00323                                 }
<a name="l00324"></a>00324                                 
<a name="l00325"></a>00325                  
<a name="l00326"></a>00326                 }
<a name="l00327"></a>00327                                          <span class="keywordflow">if</span>(rank==0) 
<a name="l00328"></a>00328                                                  {      
<a name="l00330"></a>00330                                                  <span class="keywordflow">if</span>(  contador_global%100==0.0 &amp;&amp;traza==2 )
<a name="l00331"></a>00331                                                                  {
<a name="l00332"></a>00332                                                                 printf(<span class="stringliteral">"Iteracion  %Ld  \n"</span>,contador_global);
<a name="l00333"></a>00333          
<a name="l00334"></a>00334                                                                 }        
<a name="l00335"></a>00335                                                 } 
<a name="l00336"></a>00336                                                 
<a name="l00337"></a>00337                                                 
<a name="l00338"></a>00338                         <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#e6004a37dd8a8d722fdecf44f41bc225">Tiempo_Inicial_Comunicacion_LSQR</a>=MPI_Wtime();   
<a name="l00339"></a>00339                                                 MPI_Bcast(&amp;convergencia[0],1,MPI_INT,0,MPI_COMM_WORLD);
<a name="l00340"></a>00340                                         Tiempo_Parcial_Comunicacion_LSQR+=MPI_Wtime() - <a class="code" href="../../d9/d2a/_sistema___lineal_8cpp.html#e6004a37dd8a8d722fdecf44f41bc225">Tiempo_Inicial_Comunicacion_LSQR</a>;
<a name="l00341"></a>00341         
<a name="l00342"></a>00342                                                 
<a name="l00343"></a>00343                                                  <span class="keywordflow">if</span>(traza==1)
<a name="l00344"></a>00344                                                  ERROR-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(contador_global,suma);
<a name="l00345"></a>00345 
<a name="l00346"></a>00346                                                  contador_global++;
<a name="l00347"></a>00347                                                  <span class="keywordflow">if</span>( contador_global &gt;= <a class="code" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones.">Get_Iteraciones</a>())
<a name="l00348"></a>00348                          <span class="keywordflow">break</span>;                                                  
<a name="l00349"></a>00349         }
<a name="l00350"></a>00350        
<a name="l00351"></a>00351                         <span class="keywordflow">if</span>(rank==0)
<a name="l00352"></a>00352                         {
<a name="l00353"></a>00353                                         <span class="keywordflow">if</span>(traza==1)
<a name="l00354"></a>00354                                         {
<a name="l00355"></a>00355                                                 <span class="keywordtype">char</span> *NombreSolucion=<span class="stringliteral">"ERROR_LSQR_Paralelo.dat"</span>;
<a name="l00356"></a>00356                                                 <a class="code" href="../../d2/dee/class_archivo.html" title="Clase para manipular archivos.">Archivo</a> *ERROR_ARCHIVO=<span class="keyword">new</span> <a class="code" href="../../d2/dee/class_archivo.html" title="Clase para manipular archivos.">Archivo</a>();
<a name="l00357"></a>00357                                                 ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#3960a9c7863da75e6e704a668c488293" title="Asigna un nombre al archivo.">SetNombre</a>(NombreSolucion);
<a name="l00358"></a>00358                                                 ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#4c756c8da75fab13f1c0b5cc636b2724" title="Define el tipo de acceso al archivo.">SetModo</a>(<a class="code" href="../../de/dc7/_archivo_8hpp.html#406416501f9b8dd55765eb0686ced406">GRABA_ARCHIVO</a>);  
<a name="l00359"></a>00359                                                 ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#812b1ef63ac695139f6b4bfb3aa7ff81" title="Abre el archivo.">Abrir</a>();
<a name="l00360"></a>00360                                                 ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#d1120aa3740cdc037ce2a3fb49351133" title="Escribe un Vector a un archivo (Recordar cambiar a Escribe_Vector).">Escribe_Vector</a>(ERROR,ERROR-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>());   
<a name="l00361"></a>00361                                                 ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#9dd5f77b08f09bfef21f03e5a0080bcb" title="Cierra el archivo.">Cerrar</a>();
<a name="l00362"></a>00362                                         }
<a name="l00363"></a>00363 
<a name="l00364"></a>00364                                         <span class="keywordflow">if</span>(suma &gt; 1000)
<a name="l00365"></a>00365                                         {
<a name="l00366"></a>00366                                                 printf(<span class="stringliteral">"\n\n ************ ATENCION ES MUY PROBABLE QUE LA APROXIMACION SEA INCORRECTA POR UNA MALA TRIANGULACION DE MALLA FEM UTILIZADA  *****************     "</span>);      
<a name="l00367"></a>00367                                                 printf(<span class="stringliteral">"\n    ************ SE ACONSEJA REFINAR LA MALLA Y EVITAR TRIANGULOS CON ANGULOS MUY AGUDOS ************* \n ************* YA QUE ESTE TIPO DE TRIANGULOS ES CAUSANTE DE DIVERGENCIA EN ALGUNAS APROXIMACIONES NODALES  *****************     \n TAMBIEN PUEDE SER POR QUE DEBEN SER MAS ITERACIONES\n"</span>);        
<a name="l00368"></a>00368                                 
<a name="l00369"></a>00369                                         }       
<a name="l00370"></a>00370                 
<a name="l00371"></a>00371                         finalLSQR=MPI_Wtime();  
<a name="l00372"></a>00372                                         
<a name="l00373"></a>00373                       <span class="keywordflow">if</span>(Tipo_Parada==0 || ( Tipo_Parada ==1 &amp;&amp; traza == 1 ))
<a name="l00374"></a>00374                   printf(<span class="stringliteral">"Iteraciones: %Ld  en   %f segundos con norma 2=%f y diferencia = %f\n"</span>,contador_global,finalLSQR-inicioLSQR,suma,diferencia);
<a name="l00375"></a>00375                       <span class="keywordflow">else</span>
<a name="l00376"></a>00376                       printf(<span class="stringliteral">"Iteraciones: %Ld  en   %f segundos \n"</span>,contador_global,finalLSQR-inicioLSQR);                     
<a name="l00377"></a>00377                         
<a name="l00378"></a>00378         }               
<a name="l00379"></a>00379      
<a name="l00380"></a>00380         <span class="keywordflow">if</span>(rank==0)
<a name="l00381"></a>00381         { 
<a name="l00382"></a>00382                 <a class="code" href="../../d9/d85/class_sistema___lineal.html#b5a2b3cc2401946436d9d348afda71c9" title="Tiempo utilizado en resolver sistema.">tSistema</a>=Tiempo_Parcial_Comunicacion_LSQR;    
<a name="l00383"></a>00383         }
<a name="l00384"></a>00384     u-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00385"></a>00385         w-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00386"></a>00386         x_star-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00387"></a>00387         x_new-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00388"></a>00388         Norma2-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();   
<a name="l00389"></a>00389         
<a name="l00390"></a>00390         
<a name="l00391"></a>00391 } 
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_2b9e62158dcb700a20e8f429c8c50454_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_2b9e62158dcb700a20e8f429c8c50454_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_2b9e62158dcb700a20e8f429c8c50454_cgraph_map">
<area shape="rect" id="node3" href="../../d2/dee/class_archivo.html#812b1ef63ac695139f6b4bfb3aa7ff81" title="Abre el archivo." alt="" coords="461,5,560,33"><area shape="rect" id="node5" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col." alt="" coords="777,258,884,286"><area shape="rect" id="node9" href="../../d2/dee/class_archivo.html#9dd5f77b08f09bfef21f03e5a0080bcb" title="Cierra el archivo." alt="" coords="457,511,564,539"><area shape="rect" id="node11" href="../../dd/d59/class_vector___entero.html#d1d5779a63bf05b51bec19fa6a03cd29" title="Retorna el numero de columnas." alt="" coords="425,562,596,590"><area shape="rect" id="node13" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas." alt="" coords="768,435,893,463"><area shape="rect" id="node15" href="../../d9/daf/class_rutinas___paralelas.html#0e4f48806ae96b733b4571c86ed760eb" title="Envia un mensaje que contiene un dato entero." alt="" coords="389,613,632,641"><area shape="rect" id="node17" href="../../d5/db2/class_vector.html#e192f9cd81d8348bbbe6e2ece818609c" title="Obtiene el error norma 2 entre dos vectores." alt="" coords="437,157,584,185"><area shape="rect" id="node19" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector." alt="" coords="775,207,887,235"><area shape="rect" id="node22" href="../../d2/dee/class_archivo.html#d1120aa3740cdc037ce2a3fb49351133" title="Escribe un Vector a un archivo (Recordar cambiar a Escribe_Vector)." alt="" coords="431,55,591,83"><area shape="rect" id="node25" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones." alt="" coords="407,663,615,691"><area shape="rect" id="node27" href="../../d5/db2/class_vector.html#a32c56760a4a70f2e8c976cc16db84e8" title="Inicializa con valores val el vector." alt="" coords="452,714,569,742"><area shape="rect" id="node29" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria." alt="" coords="431,765,591,793"><area shape="rect" id="node31" href="../../d9/daf/class_rutinas___paralelas.html#40b52e00f2965f80e1241e6446e76ef5" title="Multiplica una matriz dispersa por un vector, guardando en vector salida el resultado..." alt="" coords="345,359,676,387"><area shape="rect" id="node36" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col." alt="" coords="752,334,909,362"><area shape="rect" id="node40" href="../../d9/daf/class_rutinas___paralelas.html#64a4c2c4d1c46176706617cb510155c9" title="Multiplica una matriz dispersa por un vector, guardando en una seccion el vector..." alt="" coords="317,207,704,235"><area shape="rect" id="node45" href="../../d9/daf/class_rutinas___paralelas.html#196af3cdf301ea19da6a2fa1b387844f" title="Multiplica una matriz traspuesta dispersa por un vector, guardando en vector salida..." alt="" coords="341,258,680,286"><area shape="rect" id="node50" href="../../d5/db2/class_vector.html#1997155ab1b68e6e06bcc7fe8cbb23d0" title="Calcula el producto punto." alt="" coords="431,815,591,843"><area shape="rect" id="node52" href="../../d9/daf/class_rutinas___paralelas.html#75f07d2a047ad643fcf2f3c1acf5604d" title="Recibe un mensaje que contiene un dato entero." alt="" coords="384,866,637,894"><area shape="rect" id="node56" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector." alt="" coords="408,917,613,945"><area shape="rect" id="node58" href="../../d2/dee/class_archivo.html#4c756c8da75fab13f1c0b5cc636b2724" title="Define el tipo de acceso al archivo." alt="" coords="449,967,572,995"><area shape="rect" id="node60" href="../../d2/dee/class_archivo.html#3960a9c7863da75e6e704a668c488293" title="Asigna un nombre al archivo." alt="" coords="443,1018,579,1046"><area shape="rect" id="node62" href="../../d5/db2/class_vector.html#db22a12698caef87688b1577be609a93" title="Calcula el vector Normal." alt="" coords="435,1069,587,1097"><area shape="rect" id="node7" href="../../d5/db2/class_vector.html#1e61a24886a05a02609e75c3d2a53e16" title="Visualiza información general de la matriz." alt="" coords="980,233,1140,261"><area shape="rect" id="node38" href="../../dd/d59/class_vector___entero.html#f598217377e836e5c86f5c15ae8c6502" title="Visualiza información general de la matriz." alt="" coords="957,334,1163,362"></map>
</div>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_2b9e62158dcb700a20e8f429c8c50454_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_2b9e62158dcb700a20e8f429c8c50454_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_2b9e62158dcb700a20e8f429c8c50454_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="319,5,513,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="564,5,612,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="6b271c2d8e63404fcc68af22c05d6725"></a><!-- doxytag: member="Sistema_Lineal::LSRQ_Matriz_Dispersa" ref="6b271c2d8e63404fcc68af22c05d6725" args="(Matriz *A, Matriz_Dispersa *MDA)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::LSRQ_Matriz_Dispersa           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d6d/class_matriz___dispersa.html">Matriz_Dispersa</a> *&nbsp;</td>
          <td class="paramname"> <em>MDA</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00099">99</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00100"></a>00100    {
<a name="l00101"></a>00101            MDA=<span class="keyword">new</span> <a class="code" href="../../dd/d6d/class_matriz___dispersa.html" title="Clase para el trabajar con matrices dispersas de tipo double.">Matriz_Dispersa</a>(A);   
<a name="l00102"></a>00102         }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f87671a678c8abf8ce4c22fe7f5c0ae4"></a><!-- doxytag: member="Sistema_Lineal::Redimensionar_Sistema" ref="f87671a678c8abf8ce4c22fe7f5c0ae4" args="(Matriz *a, Vector *b, Vector_Entero *frontera, unsigned long long DimFrontera)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Redimensionar_Sistema           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d59/class_vector___entero.html">Vector_Entero</a> *&nbsp;</td>
          <td class="paramname"> <em>frontera</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long long&nbsp;</td>
          <td class="paramname"> <em>DimFrontera</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Redimensiona un sistema de ecuaciones representados matricialmente, indicando que filas-columnas se desean eliminar. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00037">37</a> del archivo <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00089">Matriz::Asigna()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00037">Vector::Asigna()</a>, <a class="el" href="../../d4/d83/_vector___entero_8cpp_source.html#l00088">Vector_Entero::Buscar_Valor_Limite()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00058">Matriz::Columnas()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00083">Vector::Copia()</a>, <a class="el" href="../../d1/d8b/_matriz_8cpp_source.html#l00090">Matriz::Copia()</a>, <a class="el" href="../../db/d20/_vector_8hpp_source.html#l00059">Vector::Libera_Memoria()</a>, <a class="el" href="../../d1/d8b/_matriz_8cpp_source.html#l00065">Matriz::Libera_Memoria()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00095">Matriz::Retorna()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00051">Vector::Retorna()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00004">Vector::Solicita_Memoria()</a>, y <a class="el" href="../../d1/d8b/_matriz_8cpp_source.html#l00036">Matriz::Solicita_Memoria()</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00434">FEM::Establecer_Condicion_Matricial_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00038"></a>00038 {
<a name="l00039"></a>00039 
<a name="l00040"></a>00040         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> NuevaDim,DimActual;
<a name="l00041"></a>00041         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> tmpi,tmpj,k,m;
<a name="l00042"></a>00042         DimActual=a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas.">Columnas</a>();
<a name="l00043"></a>00043         NuevaDim=DimActual-DimFrontera;
<a name="l00044"></a>00044         printf(<span class="stringliteral">"La Dimension del borde: %Ld, la nueva dimension del sisema es por lo tanto: %LdX%Ld\n "</span>,DimFrontera,NuevaDim,NuevaDim);
<a name="l00045"></a>00045         <a class="code" href="../../d4/d09/class_matriz.html" title="Clase para el trabajar con matrices de tipo double.">Matriz</a> *aReducida=<span class="keyword">new</span> <a class="code" href="../../d4/d09/class_matriz.html" title="Clase para el trabajar con matrices de tipo double.">Matriz</a>(NuevaDim,NuevaDim);
<a name="l00046"></a>00046         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *QReducido=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(NuevaDim);
<a name="l00047"></a>00047                 k=0;
<a name="l00048"></a>00048         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i = 0; i &lt; DimActual; i++)     
<a name="l00049"></a>00049         {
<a name="l00050"></a>00050                 m=0;     
<a name="l00051"></a>00051         tmpi=vBorde-&gt;Buscar_Valor_Limite(i,DimFrontera);
<a name="l00052"></a>00052         
<a name="l00053"></a>00053                 <span class="keywordflow">if</span>(tmpi!=1)
<a name="l00054"></a>00054                 {               
<a name="l00055"></a>00055          QReducido-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(k,b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i)); <span class="comment">//original</span>
<a name="l00056"></a>00056 
<a name="l00057"></a>00057                         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j = 0; j &lt; DimActual; j++)  
<a name="l00058"></a>00058                                    {
<a name="l00059"></a>00059                                             tmpj=vBorde-&gt;Buscar_Valor_Limite(j,DimFrontera);
<a name="l00060"></a>00060                                                                 <span class="keywordflow">if</span>(tmpj!=1)   
<a name="l00061"></a>00061                                                                 {
<a name="l00062"></a>00062                                                                 aReducida-&gt;<a class="code" href="../../d4/d09/class_matriz.html#ef90ff9c24c5474b0e09818be945207a" title="Asigna valor en fila, columna.">Asigna</a>(k,m,a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,j)); 
<a name="l00063"></a>00063                                                                 m++;    
<a name="l00064"></a>00064                                                                 }  
<a name="l00065"></a>00065                                            
<a name="l00066"></a>00066                                    }
<a name="l00067"></a>00067                    k++;
<a name="l00068"></a>00068            }
<a name="l00069"></a>00069 }       
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#1b7ea548801007f4623fef009256d705" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00073"></a>00073 a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a06886e02a6eb98b9e1ae364c4174c6a" title="Asigna memoria.">Solicita_Memoria</a>(NuevaDim,NuevaDim);
<a name="l00074"></a>00074 aReducida-&gt;<a class="code" href="../../d4/d09/class_matriz.html#659de37a940bb4303e53c3751f1a2c5f" title="Copia el contenido de la matriz a la matriz a.">Copia</a>(a);
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 b-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00077"></a>00077 b-&gt;<a class="code" href="../../d5/db2/class_vector.html#91c0508e962ed5ed8d5014c46beea316" title="Solicita la memoria para el vector.">Solicita_Memoria</a>(NuevaDim,0.0);
<a name="l00078"></a>00078 QReducido-&gt;<a class="code" href="../../d5/db2/class_vector.html#548bf4d3142df8532124c79cc6a9cb4d" title="Copia el vector a otro vector a.">Copia</a>(b);
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 }
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_f87671a678c8abf8ce4c22fe7f5c0ae4_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_f87671a678c8abf8ce4c22fe7f5c0ae4_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_f87671a678c8abf8ce4c22fe7f5c0ae4_cgraph_map">
<area shape="rect" id="node3" href="../../d4/d09/class_matriz.html#ef90ff9c24c5474b0e09818be945207a" title="Asigna valor en fila, columna." alt="" coords="605,8,709,36"><area shape="rect" id="node5" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col." alt="" coords="604,109,711,137"><area shape="rect" id="node9" href="../../dd/d59/class_vector___entero.html#8a5590781f0c14a10b03458a7bc70de8" title="Busca un valor en el vector hasta un cierto indice y retorna 1 en caso verdadero..." alt="" coords="315,363,547,391"><area shape="rect" id="node11" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas." alt="" coords="369,413,492,441"><area shape="rect" id="node13" href="../../d5/db2/class_vector.html#548bf4d3142df8532124c79cc6a9cb4d" title="Copia el vector a otro vector a." alt="" coords="381,211,480,239"><area shape="rect" id="node19" href="../../d4/d09/class_matriz.html#659de37a940bb4303e53c3751f1a2c5f" title="Copia el contenido de la matriz a la matriz a." alt="" coords="381,59,480,87"><area shape="rect" id="node22" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna." alt="" coords="603,59,712,87"><area shape="rect" id="node24" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria." alt="" coords="351,464,511,492"><area shape="rect" id="node26" href="../../d4/d09/class_matriz.html#1b7ea548801007f4623fef009256d705" title="Libera memoria." alt="" coords="352,515,509,543"><area shape="rect" id="node29" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector." alt="" coords="601,261,713,289"><area shape="rect" id="node32" href="../../d5/db2/class_vector.html#91c0508e962ed5ed8d5014c46beea316" title="Solicita la memoria para el vector." alt="" coords="347,312,515,340"><area shape="rect" id="node37" href="../../d4/d09/class_matriz.html#a06886e02a6eb98b9e1ae364c4174c6a" title="Asigna memoria." alt="" coords="348,565,513,593"><area shape="rect" id="node7" href="../../d5/db2/class_vector.html#1e61a24886a05a02609e75c3d2a53e16" title="Visualiza información general de la matriz." alt="" coords="768,211,928,239"><area shape="rect" id="node16" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas." alt="" coords="595,211,720,239"><area shape="rect" id="node34" href="../../d5/db2/class_vector.html#a32c56760a4a70f2e8c976cc16db84e8" title="Inicializa con valores val el vector." alt="" coords="599,363,716,391"></map>
</div>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_f87671a678c8abf8ce4c22fe7f5c0ae4_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_f87671a678c8abf8ce4c22fe7f5c0ae4_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_f87671a678c8abf8ce4c22fe7f5c0ae4_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#826fb0f16335d5896d17a3a7abab46aa" title="Establece el tipo de tratamiento numerico con el cula se trabaja en la resolucion..." alt="" coords="315,5,589,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="639,5,687,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="58e4ff1cef59effef111da197b1caf0a"></a><!-- doxytag: member="Sistema_Lineal::Redimensionar_Sistema_Hashing" ref="58e4ff1cef59effef111da197b1caf0a" args="(map&lt; unsigned long long, double &gt; A_FEM, map&lt; unsigned long long, unsigned long long &gt; mFila, map&lt; unsigned long long, unsigned long long &gt; mColumna, Vector *b, Vector_Entero *frontera, unsigned long DimActual)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Redimensionar_Sistema_Hashing           </td>
          <td>(</td>
          <td class="paramtype">map&lt; unsigned long long, double &gt;&nbsp;</td>
          <td class="paramname"> <em>A_FEM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">map&lt; unsigned long long, unsigned long long &gt;&nbsp;</td>
          <td class="paramname"> <em>mFila</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">map&lt; unsigned long long, unsigned long long &gt;&nbsp;</td>
          <td class="paramname"> <em>mColumna</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d59/class_vector___entero.html">Vector_Entero</a> *&nbsp;</td>
          <td class="paramname"> <em>frontera</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>DimActual</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Redimensiona un sistema de ecuaciones representados matricialmente con Hashing , indicando que filas-columnas se desean eliminar. 
<p>

<p>
Elimina la informacion de tipo map de columnas, filas y datos, a partir del vector de entrada donde se indica que filas - columnas se quieren eliminar de la matriz 
<p>Definición en la línea <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00006">6</a> del archivo <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d2/dbe/_vector___entero_8hpp_source.html#l00080">Vector_Entero::Columnas()</a>, y <a class="el" href="../../d4/d83/_vector___entero_8cpp_source.html#l00049">Vector_Entero::Retorna()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00007"></a>00007 {
<a name="l00008"></a>00008         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> indice,tmp,ubicacion;
<a name="l00009"></a>00009         std::map&lt;unsigned long long,unsigned long long&gt;::iterator posicion;
<a name="l00010"></a>00010         std::map&lt;unsigned long long,double&gt;::iterator indice_nuevo;
<a name="l00011"></a>00011         <span class="keywordflow">for</span>(indice=0; indice&lt;vBorde-&gt;Columnas(); indice++)
<a name="l00012"></a>00012         {       
<a name="l00013"></a>00013                 
<a name="l00014"></a>00014                 tmp=vBorde-&gt;Retorna(indice);
<a name="l00015"></a>00015                         
<a name="l00017"></a>00017                 <span class="keywordflow">for</span> (posicion = Mapeo_FEM_Fila.begin(); posicion != Mapeo_FEM_Fila.end();) <span class="comment">// recorre el mapeo de las filas</span>
<a name="l00018"></a>00018                 {
<a name="l00019"></a>00019                                 <span class="keywordflow">if</span>(posicion-&gt;second==tmp || Mapeo_FEM_Columna[posicion-&gt;first] == tmp) <span class="comment">// si una fila o columna del mapeo pertenece al vector fronteras</span>
<a name="l00020"></a>00020                                 {
<a name="l00021"></a>00021                                 ubicacion =  posicion-&gt;first;                                                         <span class="comment">// se almacena la llave asociada al indice de la matriz dispersa en map</span>
<a name="l00022"></a>00022                                 Mapeo_FEM_Columna.erase(ubicacion);                                                        <span class="comment">// se elimina el indice de columna asociada a la llave</span>
<a name="l00023"></a>00023                                 Matriz_A_FEM.erase(ubicacion);                                                              <span class="comment">// se elimina el dato asociada a la llave</span>
<a name="l00024"></a>00024                                 Mapeo_FEM_Fila.erase(posicion++);                                                             <span class="comment">// se elimina el indice de fila asociada a la llave</span>
<a name="l00025"></a>00025                                 }
<a name="l00026"></a>00026                                 <span class="keywordflow">else</span>
<a name="l00027"></a>00027                                 ++posicion;
<a name="l00028"></a>00028             }           
<a name="l00029"></a>00029                 
<a name="l00030"></a>00030         }
<a name="l00031"></a>00031         
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 }
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_58e4ff1cef59effef111da197b1caf0a_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_58e4ff1cef59effef111da197b1caf0a_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_58e4ff1cef59effef111da197b1caf0a_cgraph_map">
<area shape="rect" id="node3" href="../../dd/d59/class_vector___entero.html#d1d5779a63bf05b51bec19fa6a03cd29" title="Retorna el numero de columnas." alt="" coords="368,5,539,33"><area shape="rect" id="node5" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col." alt="" coords="375,55,532,83"><area shape="rect" id="node7" href="../../dd/d59/class_vector___entero.html#f598217377e836e5c86f5c15ae8c6502" title="Visualiza información general de la matriz." alt="" coords="587,55,792,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="fd67cab00f52f81023d49c8ac27a6ba7"></a><!-- doxytag: member="Sistema_Lineal::Resuelve_Factorizacion_LU" ref="fd67cab00f52f81023d49c8ac27a6ba7" args="(Matriz *a, Vector *x, Vector *b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Resuelve_Factorizacion_LU           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Resuelve el sistema Ax=b usando factorizacion LU. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00858">858</a> del archivo <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00865">Factoriza_LU()</a>, y <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00891">Solve_LU()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00859"></a>00859 {
<a name="l00860"></a>00860    <a class="code" href="../../d9/d85/class_sistema___lineal.html#26bfadb6eb48dad7204072cc0cb06d00" title="Factoriza la matriz A en L y U dejandolas en la misma matriz.">Factoriza_LU</a>(a);
<a name="l00861"></a>00861    <a class="code" href="../../d9/d85/class_sistema___lineal.html#5b4cee95d591129db28aa76341a0d646" title="Resuelve el sistema Ax=LUx = b.">Solve_LU</a>(a,x,b);
<a name="l00862"></a>00862 }
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_fd67cab00f52f81023d49c8ac27a6ba7_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_fd67cab00f52f81023d49c8ac27a6ba7_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_fd67cab00f52f81023d49c8ac27a6ba7_cgraph_map">
<area shape="rect" id="node3" href="../../d9/d85/class_sistema___lineal.html#26bfadb6eb48dad7204072cc0cb06d00" title="Factoriza la matriz A en L y U dejandolas en la misma matriz." alt="" coords="335,55,529,83"><area shape="rect" id="node11" href="../../d9/d85/class_sistema___lineal.html#5b4cee95d591129db28aa76341a0d646" title="Resuelve el sistema Ax=LUx = b." alt="" coords="347,106,517,134"><area shape="rect" id="node5" href="../../d4/d09/class_matriz.html#ef90ff9c24c5474b0e09818be945207a" title="Asigna valor en fila, columna." alt="" coords="589,5,693,33"><area shape="rect" id="node7" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas." alt="" coords="580,106,703,134"><area shape="rect" id="node9" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna." alt="" coords="587,55,696,83"><area shape="rect" id="node13" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col." alt="" coords="588,157,695,185"><area shape="rect" id="node19" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector." alt="" coords="585,207,697,235"><area shape="rect" id="node15" href="../../d5/db2/class_vector.html#1e61a24886a05a02609e75c3d2a53e16" title="Visualiza información general de la matriz." alt="" coords="752,182,912,210"></map>
</div>

</div>
</div><p>
<a class="anchor" name="62051f00d59e3aa833a0d5fc4d2953ab"></a><!-- doxytag: member="Sistema_Lineal::Resuelve_Gauss_Seidel" ref="62051f00d59e3aa833a0d5fc4d2953ab" args="(Matriz *a, Vector *x, Vector *b, double ep, int Tipo_Parada, int traza)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Resuelve_Gauss_Seidel           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Tipo_Parada</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>traza</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Resuelve Ax=b usando el metodo Gauss Seidel. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l01025">1025</a> del archivo <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00021">Archivo::Abrir()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00037">Vector::Asigna()</a>, <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00012">Archivo::Cerrar()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00058">Matriz::Columnas()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00236">Vector::Error_Norma2()</a>, <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00052">Archivo::Escribe_Vector()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00054">Matriz::Filas()</a>, <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00057">Get_Iteraciones()</a>, <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00005">GRABA_ARCHIVO</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00069">Matriz::Matriz_Cuadrada()</a>, <a class="el" href="../../d1/d8b/_matriz_8cpp_source.html#l00218">Matriz::Multiplica()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00051">Vector::Retorna()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00095">Matriz::Retorna()</a>, <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00053">Archivo::SetModo()</a>, y <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00049">Archivo::SetNombre()</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01026"></a>01026 {
<a name="l01027"></a>01027 
<a name="l01028"></a>01028    <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *ax_tmp= <span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas.">Columnas</a>()); <span class="comment">// solo para traza</span>
<a name="l01029"></a>01029 
<a name="l01030"></a>01030         
<a name="l01031"></a>01031    <span class="keywordflow">if</span> (!a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#4d1f96909ec692037ef7b81f80fbd6dc" title="Retorna 1 si es matriz cuadrada en caso contrario regresa 0.">Matriz_Cuadrada</a>())
<a name="l01032"></a>01032    {
<a name="l01033"></a>01033       printf(<span class="stringliteral">"\nError resolver por Gauss Siedel, matriz no cuadrada\n\n"</span>);
<a name="l01034"></a>01034       MPI_Finalize();
<a name="l01035"></a>01035           exit(1);
<a name="l01036"></a>01036    }
<a name="l01037"></a>01037 
<a name="l01038"></a>01038 
<a name="l01039"></a>01039    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> m;
<a name="l01040"></a>01040    <span class="keywordtype">int</span> sw;
<a name="l01041"></a>01041    <span class="keywordtype">double</span> sum,sum1,sum2;
<a name="l01042"></a>01042    <span class="keywordtype">double</span> tol;
<a name="l01043"></a>01043    <span class="keywordtype">double</span> tol_global=0.0;
<a name="l01044"></a>01044    <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *xt = <span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas.">Columnas</a>());
<a name="l01045"></a>01045    <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *ERROR=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(<a class="code" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones.">Get_Iteraciones</a>());
<a name="l01046"></a>01046    m = 0;
<a name="l01047"></a>01047    <span class="keywordflow">do</span>
<a name="l01048"></a>01048    {
<a name="l01049"></a>01049        m++;
<a name="l01050"></a>01050        sw = 0;
<a name="l01051"></a>01051                    tol_global = 0.0;
<a name="l01052"></a>01052        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i = 0; i &lt; a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#42cedb6b70724eff1b10e4bacbf94fda" title="Retorna el numero de filas.">Filas</a>(); i++)
<a name="l01053"></a>01053        {
<a name="l01054"></a>01054           sum = 0.0;
<a name="l01055"></a>01055                   sum1 = 0.0;
<a name="l01056"></a>01056                   sum2 = 0.0;              
<a name="l01057"></a>01057            
<a name="l01058"></a>01058                   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j = 0; j &lt; i; j ++)
<a name="l01059"></a>01059           {
<a name="l01060"></a>01060              sum1 += a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,j) * x-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j);
<a name="l01061"></a>01061               }
<a name="l01062"></a>01062                   
<a name="l01063"></a>01063                   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j = i+1; j &lt; a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas.">Columnas</a>(); j ++)
<a name="l01064"></a>01064           {
<a name="l01065"></a>01065              sum2 += a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,j) * x-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j);
<a name="l01066"></a>01066               }
<a name="l01067"></a>01067                    sum = sum1 + sum2;
<a name="l01068"></a>01068           
<a name="l01069"></a>01069                    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,i) == 0.0) 
<a name="l01070"></a>01070                   { 
<a name="l01071"></a>01071                           printf(<span class="stringliteral">"\nError al resolver por Gauss Siedel, la diagonal po debe tener valores nulos\n\n"</span>);
<a name="l01072"></a>01072               MPI_Finalize();
<a name="l01073"></a>01073                           exit(1);
<a name="l01074"></a>01074                   }
<a name="l01075"></a>01075           xt-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,(1.0 / a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,i)) * (b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i) - sum));
<a name="l01076"></a>01076 
<a name="l01077"></a>01077 
<a name="l01078"></a>01078          
<a name="l01079"></a>01079                 <span class="keywordflow">if</span>(Tipo_Parada==0)
<a name="l01080"></a>01080                  {      
<a name="l01081"></a>01081                tol=fabs(x-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i) - xt-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i));
<a name="l01082"></a>01082                    tol_global = tol_global + tol;
<a name="l01083"></a>01083                  }
<a name="l01084"></a>01084                  
<a name="l01085"></a>01085                  
<a name="l01086"></a>01086                  
<a name="l01087"></a>01087           x-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,xt-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i));
<a name="l01088"></a>01088        }
<a name="l01089"></a>01089            
<a name="l01090"></a>01090            
<a name="l01091"></a>01091                      <span class="keywordflow">if</span> (tol_global &gt;= ep &amp;&amp; Tipo_Parada==0)
<a name="l01092"></a>01092                                  {
<a name="l01093"></a>01093                                          sw = 1;
<a name="l01094"></a>01094                                  }
<a name="l01095"></a>01095                                  <span class="keywordflow">if</span>( Tipo_Parada==1)
<a name="l01096"></a>01096                                  sw =1;  
<a name="l01097"></a>01097            
<a name="l01098"></a>01098            
<a name="l01099"></a>01099                 <span class="keywordflow">if</span>(traza==1)
<a name="l01100"></a>01100         {
<a name="l01101"></a>01101            <span class="comment">// Solo para traza de convergencia</span>
<a name="l01102"></a>01102           a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#f508444c1182581eebcca988cdc28e26" title="Multiplica la matriz por el escalar ESC.">Multiplica</a>(x,ax_tmp);
<a name="l01103"></a>01103       ERROR-&gt;Asigna(m-1,ax_tmp-&gt;<a class="code" href="../../d5/db2/class_vector.html#e192f9cd81d8348bbbe6e2ece818609c" title="Obtiene el error norma 2 entre dos vectores.">Error_Norma2</a>(ax_tmp,b));
<a name="l01104"></a>01104            printf(<span class="stringliteral">" [%Ld] "</span>,m-1);
<a name="l01105"></a>01105         }       
<a name="l01106"></a>01106 
<a name="l01107"></a>01107                         <span class="keywordflow">if</span>(m%1 == 0.0 &amp;&amp; traza==1 || ( m%100==0.0 &amp;&amp;traza==2 ))
<a name="l01108"></a>01108                                 {        
<a name="l01109"></a>01109                                   <span class="keywordflow">if</span>(Tipo_Parada==0)    
<a name="l01110"></a>01110                           printf(<span class="stringliteral">" Iteracion %Ld con tolerancia global = %f \n"</span>,m,tol_global);
<a name="l01111"></a>01111                       <span class="keywordflow">else</span>
<a name="l01112"></a>01112                                   printf(<span class="stringliteral">" Iteracion %Ld\n"</span>,m);  
<a name="l01113"></a>01113                                 }       
<a name="l01114"></a>01114            
<a name="l01115"></a>01115        <span class="keywordflow">if</span> (m &gt;= <a class="code" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones.">Get_Iteraciones</a>()) <span class="keywordflow">break</span>;
<a name="l01116"></a>01116    } <span class="keywordflow">while</span> (sw);
<a name="l01117"></a>01117    printf(<span class="stringliteral">" Finalizo en la Iteracion %Ld \n"</span>,m);   <span class="comment">//Efectos de traza</span>
<a name="l01118"></a>01118      <span class="keywordflow">if</span>(traza==1)
<a name="l01119"></a>01119         {
<a name="l01120"></a>01120         <span class="keywordtype">char</span> *NombreSolucion=<span class="stringliteral">"ERROR_Gauss_Seidel.dat"</span>;
<a name="l01121"></a>01121         <a class="code" href="../../d2/dee/class_archivo.html" title="Clase para manipular archivos.">Archivo</a> *ERROR_ARCHIVO=<span class="keyword">new</span> <a class="code" href="../../d2/dee/class_archivo.html" title="Clase para manipular archivos.">Archivo</a>();
<a name="l01122"></a>01122         ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#3960a9c7863da75e6e704a668c488293" title="Asigna un nombre al archivo.">SetNombre</a>(NombreSolucion);
<a name="l01123"></a>01123         ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#4c756c8da75fab13f1c0b5cc636b2724" title="Define el tipo de acceso al archivo.">SetModo</a>(<a class="code" href="../../de/dc7/_archivo_8hpp.html#406416501f9b8dd55765eb0686ced406">GRABA_ARCHIVO</a>);  
<a name="l01124"></a>01124         ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#812b1ef63ac695139f6b4bfb3aa7ff81" title="Abre el archivo.">Abrir</a>();
<a name="l01125"></a>01125     ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#d1120aa3740cdc037ce2a3fb49351133" title="Escribe un Vector a un archivo (Recordar cambiar a Escribe_Vector).">Escribe_Vector</a>(ERROR,ERROR-&gt;Columnas());   
<a name="l01126"></a>01126     ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#9dd5f77b08f09bfef21f03e5a0080bcb" title="Cierra el archivo.">Cerrar</a>();
<a name="l01127"></a>01127     }
<a name="l01128"></a>01128    
<a name="l01129"></a>01129     <span class="keyword">delete</span> ERROR;
<a name="l01130"></a>01130 }
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_62051f00d59e3aa833a0d5fc4d2953ab_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_62051f00d59e3aa833a0d5fc4d2953ab_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_62051f00d59e3aa833a0d5fc4d2953ab_cgraph_map">
<area shape="rect" id="node3" href="../../d2/dee/class_archivo.html#812b1ef63ac695139f6b4bfb3aa7ff81" title="Abre el archivo." alt="" coords="368,5,467,33"><area shape="rect" id="node5" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col." alt="" coords="573,106,680,134"><area shape="rect" id="node9" href="../../d2/dee/class_archivo.html#9dd5f77b08f09bfef21f03e5a0080bcb" title="Cierra el archivo." alt="" coords="364,106,471,134"><area shape="rect" id="node11" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas." alt="" coords="356,157,479,185"><area shape="rect" id="node13" href="../../d5/db2/class_vector.html#e192f9cd81d8348bbbe6e2ece818609c" title="Obtiene el error norma 2 entre dos vectores." alt="" coords="344,207,491,235"><area shape="rect" id="node15" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector." alt="" coords="571,233,683,261"><area shape="rect" id="node18" href="../../d2/dee/class_archivo.html#d1120aa3740cdc037ce2a3fb49351133" title="Escribe un Vector a un archivo (Recordar cambiar a Escribe_Vector)." alt="" coords="337,309,497,337"><area shape="rect" id="node21" href="../../d4/d09/class_matriz.html#42cedb6b70724eff1b10e4bacbf94fda" title="Retorna el numero de filas." alt="" coords="371,359,464,387"><area shape="rect" id="node23" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones." alt="" coords="313,410,521,438"><area shape="rect" id="node25" href="../../d4/d09/class_matriz.html#4d1f96909ec692037ef7b81f80fbd6dc" title="Retorna 1 si es matriz cuadrada en caso contrario regresa 0." alt="" coords="336,461,499,489"><area shape="rect" id="node27" href="../../d4/d09/class_matriz.html#f508444c1182581eebcca988cdc28e26" title="Multiplica la matriz por el escalar ESC." alt="" coords="357,511,477,539"><area shape="rect" id="node31" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna." alt="" coords="572,562,681,590"><area shape="rect" id="node35" href="../../d2/dee/class_archivo.html#4c756c8da75fab13f1c0b5cc636b2724" title="Define el tipo de acceso al archivo." alt="" coords="356,613,479,641"><area shape="rect" id="node37" href="../../d2/dee/class_archivo.html#3960a9c7863da75e6e704a668c488293" title="Asigna un nombre al archivo." alt="" coords="349,663,485,691"><area shape="rect" id="node7" href="../../d5/db2/class_vector.html#1e61a24886a05a02609e75c3d2a53e16" title="Visualiza información general de la matriz." alt="" coords="731,170,891,198"><area shape="rect" id="node29" href="../../d4/d09/class_matriz.html#ef90ff9c24c5474b0e09818be945207a" title="Asigna valor en fila, columna." alt="" coords="575,511,679,539"></map>
</div>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_62051f00d59e3aa833a0d5fc4d2953ab_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_62051f00d59e3aa833a0d5fc4d2953ab_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_62051f00d59e3aa833a0d5fc4d2953ab_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="313,5,508,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="559,5,607,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="f9c6e4765b533131244361805898a91a"></a><!-- doxytag: member="Sistema_Lineal::Resuelve_Jacobi" ref="f9c6e4765b533131244361805898a91a" args="(Matriz *A, Vector *x, Vector *b, double ep, int Tipo_Parada, int traza)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Resuelve_Jacobi           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>ep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Tipo_Parada</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>traza</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Resuelve Ax=b usando el metodo Jacobi. 
<p>
Resuelve un sistema de ecuaciones utilizando el metodo Jacobi. 
<p>Definición en la línea <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00922">922</a> del archivo <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00021">Archivo::Abrir()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00037">Vector::Asigna()</a>, <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00012">Archivo::Cerrar()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00058">Matriz::Columnas()</a>, <a class="el" href="../../db/d20/_vector_8hpp_source.html#l00084">Vector::Columnas()</a>, <a class="el" href="../../d1/dad/_archivo_8cpp_source.html#l00052">Archivo::Escribe_Vector()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00054">Matriz::Filas()</a>, <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00057">Get_Iteraciones()</a>, <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00005">GRABA_ARCHIVO</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00069">Matriz::Matriz_Cuadrada()</a>, <a class="el" href="../../d1/d8b/_matriz_8cpp_source.html#l00218">Matriz::Multiplica()</a>, <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00051">Vector::Retorna()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00095">Matriz::Retorna()</a>, <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00053">Archivo::SetModo()</a>, y <a class="el" href="../../de/dc7/_archivo_8hpp_source.html#l00049">Archivo::SetNombre()</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00923"></a>00923 {
<a name="l00924"></a>00924  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> dimLocal;
<a name="l00925"></a>00925  dimLocal=x-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>();
<a name="l00926"></a>00926    <span class="keywordflow">if</span> (!a-&gt;Matriz_Cuadrada())
<a name="l00927"></a>00927    {
<a name="l00928"></a>00928       printf(<span class="stringliteral">"\nError resolver por Jacobi, matriz no cuadrada\n\n"</span>);
<a name="l00929"></a>00929       MPI_Finalize();
<a name="l00930"></a>00930           exit(1);
<a name="l00931"></a>00931    }
<a name="l00932"></a>00932 
<a name="l00933"></a>00933    printf(<span class="stringliteral">"\nResolviendo por Jacobi DIM %Ld %Ld Iteraciones %Ld condicion %d - -\n\n"</span>,dimLocal,b-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>(),<a class="code" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones.">Get_Iteraciones</a>(),Tipo_Parada);
<a name="l00934"></a>00934    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> m;
<a name="l00935"></a>00935    <span class="keywordtype">int</span> sw;
<a name="l00936"></a>00936    <span class="keywordtype">double</span> sum,tol;
<a name="l00937"></a>00937    <span class="keywordtype">double</span> tol_global;
<a name="l00938"></a>00938    <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *xt = <span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(a-&gt;Columnas());
<a name="l00939"></a>00939    <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *xtem = <span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(a-&gt;Columnas());
<a name="l00940"></a>00940    <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *ax_tmp= <span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(a-&gt;Columnas()); <span class="comment">// solo para traza</span>
<a name="l00941"></a>00941    <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *ERROR=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(<a class="code" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones.">Get_Iteraciones</a>());
<a name="l00942"></a>00942    m = 0;
<a name="l00943"></a>00943    <span class="keywordflow">do</span>
<a name="l00944"></a>00944    {
<a name="l00945"></a>00945        m++;
<a name="l00946"></a>00946        sw = 0;
<a name="l00947"></a>00947            tol_global = 0.0;
<a name="l00948"></a>00948        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i = 0; i &lt; a-&gt;Filas() ;i++)
<a name="l00949"></a>00949        {
<a name="l00950"></a>00950           sum = 0.0;
<a name="l00951"></a>00951           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j = 0; j &lt; a-&gt;Columnas(); j ++)
<a name="l00952"></a>00952           {
<a name="l00953"></a>00953              <span class="keywordflow">if</span> ( i == j) <span class="keywordflow">continue</span>;
<a name="l00954"></a>00954              sum += a-&gt;Retorna(i,j) * x-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j);
<a name="l00955"></a>00955           }
<a name="l00956"></a>00956           <span class="keywordflow">if</span> (a-&gt;Retorna(i,i) == 0.0) {
<a name="l00957"></a>00957              <span class="keyword">delete</span> xt;
<a name="l00958"></a>00958           }
<a name="l00959"></a>00959           xt-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,(1.0 / a-&gt;Retorna(i,i)) * (b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i) - sum));
<a name="l00960"></a>00960           xtem-&gt;Asigna(i,x-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i));
<a name="l00961"></a>00961                 
<a name="l00962"></a>00962                   <span class="keywordflow">if</span>(Tipo_Parada==0)
<a name="l00963"></a>00963                  {      
<a name="l00964"></a>00964                tol=fabs(x-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i) - xt-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i));
<a name="l00965"></a>00965                    tol_global = tol_global + tol;
<a name="l00966"></a>00966                  }
<a name="l00967"></a>00967 
<a name="l00968"></a>00968           x-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,xt-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i));  
<a name="l00969"></a>00969         
<a name="l00970"></a>00970                   }
<a name="l00971"></a>00971            
<a name="l00972"></a>00972                      <span class="keywordflow">if</span> (tol_global &gt;= ep &amp;&amp; Tipo_Parada==0)
<a name="l00973"></a>00973                                  {sw = 1;}
<a name="l00974"></a>00974                                  <span class="keywordflow">if</span>( Tipo_Parada==1)
<a name="l00975"></a>00975                                  {sw =1;}
<a name="l00976"></a>00976            
<a name="l00977"></a>00977         <span class="keywordflow">if</span>(traza==1) <span class="comment">// Traza de convergencia</span>
<a name="l00978"></a>00978         {
<a name="l00979"></a>00979            <span class="comment">// Solo para traza de convergencia</span>
<a name="l00980"></a>00980           a-&gt;Multiplica(x,ax_tmp);
<a name="l00981"></a>00981       ERROR-&gt;Asigna(m-1,ax_tmp-&gt;Error_Norma2(ax_tmp,b));
<a name="l00982"></a>00982           printf(<span class="stringliteral">" [%Ld] "</span>,m-1);
<a name="l00983"></a>00983         }       
<a name="l00984"></a>00984         
<a name="l00985"></a>00985          <span class="keywordflow">if</span>(m%1 == 0.0 &amp;&amp; traza==1 || ( m%100==0.0 &amp;&amp;traza==2 ))
<a name="l00986"></a>00986          {       
<a name="l00987"></a>00987                   <span class="keywordflow">if</span>(Tipo_Parada==0)
<a name="l00988"></a>00988                    printf(<span class="stringliteral">" Iteracion %Ld con error (tolerancia) global = %f \n"</span>,m,tol_global);
<a name="l00989"></a>00989                   <span class="keywordflow">else</span>
<a name="l00990"></a>00990                   {
<a name="l00991"></a>00991                          printf(<span class="stringliteral">" Iteracion %Ld \n"</span>,m);  
<a name="l00992"></a>00992                   }       
<a name="l00993"></a>00993          }         
<a name="l00994"></a>00994 
<a name="l00995"></a>00995            
<a name="l00996"></a>00996      <span class="keywordflow">if</span> (m &gt;= <a class="code" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones.">Get_Iteraciones</a>() ) <span class="keywordflow">break</span>;
<a name="l00997"></a>00997    } <span class="keywordflow">while</span>(sw);
<a name="l00998"></a>00998    tol_global =0.0;
<a name="l00999"></a>00999    
<a name="l01000"></a>01000    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i=0;i&lt;a-&gt;Columnas();i++)
<a name="l01001"></a>01001    {   
<a name="l01002"></a>01002                tol=fabs(xtem-&gt;Retorna(i) - xt-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i));
<a name="l01003"></a>01003                    tol_global = tol_global + tol;
<a name="l01004"></a>01004    } 
<a name="l01005"></a>01005          printf(<span class="stringliteral">" Finalizo en la Iteracion %Ld \n"</span>,m);   <span class="comment">//Efectos de traza</span>
<a name="l01006"></a>01006     <span class="keywordflow">if</span>(traza==1)
<a name="l01007"></a>01007         {
<a name="l01008"></a>01008         <span class="keywordtype">char</span> *NombreSolucion=<span class="stringliteral">"ERROR_Jacobi.dat"</span>;
<a name="l01009"></a>01009         <a class="code" href="../../d2/dee/class_archivo.html" title="Clase para manipular archivos.">Archivo</a> *ERROR_ARCHIVO=<span class="keyword">new</span> <a class="code" href="../../d2/dee/class_archivo.html" title="Clase para manipular archivos.">Archivo</a>();
<a name="l01010"></a>01010         ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#3960a9c7863da75e6e704a668c488293" title="Asigna un nombre al archivo.">SetNombre</a>(NombreSolucion);
<a name="l01011"></a>01011         ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#4c756c8da75fab13f1c0b5cc636b2724" title="Define el tipo de acceso al archivo.">SetModo</a>(<a class="code" href="../../de/dc7/_archivo_8hpp.html#406416501f9b8dd55765eb0686ced406">GRABA_ARCHIVO</a>);  
<a name="l01012"></a>01012         ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#812b1ef63ac695139f6b4bfb3aa7ff81" title="Abre el archivo.">Abrir</a>();
<a name="l01013"></a>01013     ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#d1120aa3740cdc037ce2a3fb49351133" title="Escribe un Vector a un archivo (Recordar cambiar a Escribe_Vector).">Escribe_Vector</a>(ERROR,ERROR-&gt;Columnas());   
<a name="l01014"></a>01014     ERROR_ARCHIVO-&gt;<a class="code" href="../../d2/dee/class_archivo.html#9dd5f77b08f09bfef21f03e5a0080bcb" title="Cierra el archivo.">Cerrar</a>();
<a name="l01015"></a>01015     }
<a name="l01016"></a>01016    
<a name="l01017"></a>01017    <span class="keyword">delete</span> xtem;
<a name="l01018"></a>01018    <span class="keyword">delete</span> ERROR;
<a name="l01019"></a>01019    <span class="keyword">delete</span> ax_tmp;
<a name="l01020"></a>01020    <span class="keyword">delete</span> xt;
<a name="l01021"></a>01021 }
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_f9c6e4765b533131244361805898a91a_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_f9c6e4765b533131244361805898a91a_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_f9c6e4765b533131244361805898a91a_cgraph_map">
<area shape="rect" id="node3" href="../../d2/dee/class_archivo.html#812b1ef63ac695139f6b4bfb3aa7ff81" title="Abre el archivo." alt="" coords="325,5,424,33"><area shape="rect" id="node5" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col." alt="" coords="531,131,637,159"><area shape="rect" id="node9" href="../../d2/dee/class_archivo.html#9dd5f77b08f09bfef21f03e5a0080bcb" title="Cierra el archivo." alt="" coords="321,106,428,134"><area shape="rect" id="node11" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas." alt="" coords="313,157,436,185"><area shape="rect" id="node13" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas." alt="" coords="312,207,437,235"><area shape="rect" id="node15" href="../../d2/dee/class_archivo.html#d1120aa3740cdc037ce2a3fb49351133" title="Escribe un Vector a un archivo (Recordar cambiar a Escribe_Vector)." alt="" coords="295,258,455,286"><area shape="rect" id="node17" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector." alt="" coords="528,258,640,286"><area shape="rect" id="node20" href="../../d4/d09/class_matriz.html#42cedb6b70724eff1b10e4bacbf94fda" title="Retorna el numero de filas." alt="" coords="328,359,421,387"><area shape="rect" id="node22" href="../../d9/d85/class_sistema___lineal.html#23388dc06545a801456333c486e94af4" title="Asigna numero de iteraciones." alt="" coords="271,410,479,438"><area shape="rect" id="node24" href="../../d4/d09/class_matriz.html#4d1f96909ec692037ef7b81f80fbd6dc" title="Retorna 1 si es matriz cuadrada en caso contrario regresa 0." alt="" coords="293,461,456,489"><area shape="rect" id="node26" href="../../d4/d09/class_matriz.html#f508444c1182581eebcca988cdc28e26" title="Multiplica la matriz por el escalar ESC." alt="" coords="315,511,435,539"><area shape="rect" id="node30" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna." alt="" coords="529,562,639,590"><area shape="rect" id="node34" href="../../d2/dee/class_archivo.html#4c756c8da75fab13f1c0b5cc636b2724" title="Define el tipo de acceso al archivo." alt="" coords="313,613,436,641"><area shape="rect" id="node36" href="../../d2/dee/class_archivo.html#3960a9c7863da75e6e704a668c488293" title="Asigna un nombre al archivo." alt="" coords="307,663,443,691"><area shape="rect" id="node7" href="../../d5/db2/class_vector.html#1e61a24886a05a02609e75c3d2a53e16" title="Visualiza información general de la matriz." alt="" coords="688,195,848,223"><area shape="rect" id="node28" href="../../d4/d09/class_matriz.html#ef90ff9c24c5474b0e09818be945207a" title="Asigna valor en fila, columna." alt="" coords="532,511,636,539"></map>
</div>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_f9c6e4765b533131244361805898a91a_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_f9c6e4765b533131244361805898a91a_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_f9c6e4765b533131244361805898a91a_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="271,5,465,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="516,5,564,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="4e568aca0fcd8fa87af7b5099005ce5b"></a><!-- doxytag: member="Sistema_Lineal::Set_Iteraciones" ref="4e568aca0fcd8fa87af7b5099005ce5b" args="(int Iter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Set_Iteraciones           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Iter</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Asigna numero de procesos - procesadores. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00062">62</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00020">Iteraciones</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00063"></a>00063    {
<a name="l00064"></a>00064         <a class="code" href="../../d9/d85/class_sistema___lineal.html#6499811137fbc0ee092d3266f601dc28" title="Numero de iteraciones para uso en metodos iterativos.">Iteraciones</a>=Iter;   
<a name="l00065"></a>00065    }   
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_4e568aca0fcd8fa87af7b5099005ce5b_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_4e568aca0fcd8fa87af7b5099005ce5b_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_4e568aca0fcd8fa87af7b5099005ce5b_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="263,5,457,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="508,5,556,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="b5ce5f903912eeecc39af1328b7bef9c"></a><!-- doxytag: member="Sistema_Lineal::Set_nDesconocido" ref="b5ce5f903912eeecc39af1328b7bef9c" args="(unsigned long long variables_X)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Set_nDesconocido           </td>
          <td>(</td>
          <td class="paramtype">unsigned long long&nbsp;</td>
          <td class="paramname"> <em>variables_X</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Asigna el numeros de incognitas del sistema. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00092">92</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00016">nDesconocido</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00434">FEM::Establecer_Condicion_Matricial_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00093"></a>00093    {
<a name="l00094"></a>00094         <a class="code" href="../../d9/d85/class_sistema___lineal.html#a0e532bf4b0effd912e3b40b64a10b6d" title="Numero de variables desconocidas.">nDesconocido</a>=variables_X;   
<a name="l00095"></a>00095    }   
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_b5ce5f903912eeecc39af1328b7bef9c_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_b5ce5f903912eeecc39af1328b7bef9c_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_b5ce5f903912eeecc39af1328b7bef9c_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#826fb0f16335d5896d17a3a7abab46aa" title="Establece el tipo de tratamiento numerico con el cula se trabaja en la resolucion..." alt="" coords="283,5,557,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="607,5,655,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="ac8deab6e27e5277162801d72e3d7812"></a><!-- doxytag: member="Sistema_Lineal::Set_Traza" ref="ac8deab6e27e5277162801d72e3d7812" args="(int traza)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Set_Traza           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>traza</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Asigna numero de iteraciones. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00045">45</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00022">Traza</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00046"></a>00046    {
<a name="l00047"></a>00047         <a class="code" href="../../d9/d85/class_sistema___lineal.html#61120f444e00866ec11ad5aa10e3cfdc" title="Indica si se desea alamcenar en archivo la convergencia del error.">Traza</a>=traza;   
<a name="l00048"></a>00048    }   
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_ac8deab6e27e5277162801d72e3d7812_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_ac8deab6e27e5277162801d72e3d7812_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_ac8deab6e27e5277162801d72e3d7812_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="233,5,428,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="479,5,527,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="a699432204b6cd794d28e150c2ac6e3f"></a><!-- doxytag: member="Sistema_Lineal::SetNP" ref="a699432204b6cd794d28e150c2ac6e3f" args="(int procesos)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::SetNP           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>procesos</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Asigna numero de procesos - procesadores. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00068">68</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00018">NP</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00069"></a>00069    {
<a name="l00070"></a>00070         <a class="code" href="../../d9/d85/class_sistema___lineal.html#661c39bcb3d3391b09e602d6d7aed46e" title="Numero de procesos.">NP</a>=procesos;   
<a name="l00071"></a>00071    }   
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_a699432204b6cd794d28e150c2ac6e3f_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_a699432204b6cd794d28e150c2ac6e3f_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_a699432204b6cd794d28e150c2ac6e3f_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="212,5,407,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="457,5,505,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="5f7919109bfc14849f6538e5aa0f9bc0"></a><!-- doxytag: member="Sistema_Lineal::Solve_L" ref="5f7919109bfc14849f6538e5aa0f9bc0" args="(Matriz *a, Vector *y, Vector *b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Solve_L           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Resuelve el sistema LY=B, dados L y B. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00748">748</a> del archivo <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00037">Vector::Asigna()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00058">Matriz::Columnas()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00095">Matriz::Retorna()</a>, y <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00051">Vector::Retorna()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00749"></a>00749 {
<a name="l00750"></a>00750    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i, j, n;
<a name="l00751"></a>00751    <span class="keywordtype">double</span> t;
<a name="l00752"></a>00752    n = a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas.">Columnas</a>();
<a name="l00753"></a>00753 
<a name="l00754"></a>00754    y-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(0,  b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(0) / a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(0,0) );
<a name="l00755"></a>00755    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l00756"></a>00756    {
<a name="l00757"></a>00757       t = b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i);
<a name="l00758"></a>00758 
<a name="l00759"></a>00759       <span class="keywordflow">for</span> (j = 0; j &lt; i ; j++)
<a name="l00760"></a>00760           t -= a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,j) * y-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j);
<a name="l00761"></a>00761       y-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i, t);
<a name="l00762"></a>00762    }
<a name="l00763"></a>00763 }
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_5f7919109bfc14849f6538e5aa0f9bc0_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_5f7919109bfc14849f6538e5aa0f9bc0_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_5f7919109bfc14849f6538e5aa0f9bc0_cgraph_map">
<area shape="rect" id="node3" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col." alt="" coords="228,5,335,33"><area shape="rect" id="node7" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas." alt="" coords="220,55,343,83"><area shape="rect" id="node9" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna." alt="" coords="227,106,336,134"><area shape="rect" id="node11" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector." alt="" coords="225,157,337,185"><area shape="rect" id="node5" href="../../d5/db2/class_vector.html#1e61a24886a05a02609e75c3d2a53e16" title="Visualiza información general de la matriz." alt="" coords="392,81,552,109"></map>
</div>

</div>
</div><p>
<a class="anchor" name="5b8fc00508e86a9070dac2aa213d3e51"></a><!-- doxytag: member="Sistema_Lineal::Solve_LLT" ref="5b8fc00508e86a9070dac2aa213d3e51" args="(Matriz *a, Vector *x, Vector *b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Solve_LLT           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Resuelve un sistema factorizado utilizando Cholesky LLT. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00822">822</a> del archivo <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00037">Vector::Asigna()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00058">Matriz::Columnas()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00095">Matriz::Retorna()</a>, y <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00051">Vector::Retorna()</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00823"></a>00823 {
<a name="l00824"></a>00824    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> n,i,j;
<a name="l00825"></a>00825    
<a name="l00826"></a>00826    n =   (<span class="keywordtype">long</span> <span class="keywordtype">long</span> int)  a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas.">Columnas</a>();
<a name="l00827"></a>00827    printf(<span class="stringliteral">"Resolviendo LLT\n"</span>);
<a name="l00828"></a>00828         
<a name="l00829"></a>00829         <span class="keywordflow">for</span>( i=0;i&lt;n;i++)
<a name="l00830"></a>00830         {
<a name="l00831"></a>00831                 <span class="keywordflow">for</span>( j=1;j&lt;i;j++)
<a name="l00832"></a>00832                 {       
<a name="l00833"></a>00833                 b-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i, b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i) - a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(j,i)*b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j) );
<a name="l00834"></a>00834                 }
<a name="l00835"></a>00835   
<a name="l00836"></a>00836                 b-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i)/a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,i));     
<a name="l00837"></a>00837         
<a name="l00838"></a>00838         }
<a name="l00839"></a>00839 
<a name="l00840"></a>00840         b-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(n-1, b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(n-1)/a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(n-1,n-1));
<a name="l00841"></a>00841          x-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(n-1,b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(n-1));
<a name="l00842"></a>00842         <span class="keywordflow">for</span>( i=n-2; i &gt;= 0; i--)
<a name="l00843"></a>00843         {
<a name="l00844"></a>00844                 
<a name="l00845"></a>00845                 <span class="keywordflow">for</span>(  j=i+1;j&lt;n;j++)
<a name="l00846"></a>00846                 {       
<a name="l00847"></a>00847                 b-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i, b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i) - a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,j)*b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j) );
<a name="l00848"></a>00848                 }
<a name="l00849"></a>00849   
<a name="l00850"></a>00850                 b-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i)/a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,i));     
<a name="l00851"></a>00851             x-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i));
<a name="l00852"></a>00852                 
<a name="l00853"></a>00853         }
<a name="l00854"></a>00854 
<a name="l00855"></a>00855 }
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_5b8fc00508e86a9070dac2aa213d3e51_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_5b8fc00508e86a9070dac2aa213d3e51_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_5b8fc00508e86a9070dac2aa213d3e51_cgraph_map">
<area shape="rect" id="node3" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col." alt="" coords="241,5,348,33"><area shape="rect" id="node7" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas." alt="" coords="233,55,356,83"><area shape="rect" id="node9" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna." alt="" coords="240,106,349,134"><area shape="rect" id="node11" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector." alt="" coords="239,157,351,185"><area shape="rect" id="node5" href="../../d5/db2/class_vector.html#1e61a24886a05a02609e75c3d2a53e16" title="Visualiza información general de la matriz." alt="" coords="405,81,565,109"></map>
</div>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_5b8fc00508e86a9070dac2aa213d3e51_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_5b8fc00508e86a9070dac2aa213d3e51_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_5b8fc00508e86a9070dac2aa213d3e51_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="233,5,428,33"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="479,5,527,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="5b4cee95d591129db28aa76341a0d646"></a><!-- doxytag: member="Sistema_Lineal::Solve_LU" ref="5b4cee95d591129db28aa76341a0d646" args="(Matriz *a, Vector *x, Vector *b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Solve_LU           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Resuelve el sistema Ax=LUx = b. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00891">891</a> del archivo <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00037">Vector::Asigna()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00058">Matriz::Columnas()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00095">Matriz::Retorna()</a>, y <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00051">Vector::Retorna()</a>.</p>

<p>Referenciado por <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>, y <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00858">Resuelve_Factorizacion_LU()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00892"></a>00892 {
<a name="l00893"></a>00893    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i, j, n = (<span class="keywordtype">long</span> <span class="keywordtype">long</span> int) a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas.">Columnas</a>();
<a name="l00894"></a>00894    <span class="keywordtype">double</span> t;
<a name="l00895"></a>00895 
<a name="l00896"></a>00896    <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *y = <span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(n,<span class="stringliteral">"Vector Y"</span>);
<a name="l00897"></a>00897         
<a name="l00898"></a>00898    <span class="comment">// Resuelve el sistema LY=B, dados L y B</span>
<a name="l00899"></a>00899    y-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(0,  b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(0) / a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(0,0) );
<a name="l00900"></a>00900    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l00901"></a>00901    {
<a name="l00902"></a>00902       t = b-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i);
<a name="l00903"></a>00903       <span class="keywordflow">for</span> (j = 0; j &lt; i ; j++) t -= a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,j) * y-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j);
<a name="l00904"></a>00904       y-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i, t);
<a name="l00905"></a>00905    }
<a name="l00906"></a>00906 
<a name="l00907"></a>00907    <span class="comment">// Resuelve el sistema UX=Y, dados U  y Y</span>
<a name="l00908"></a>00908    x-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(n - 1, y-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(n - 1) / a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(n - 1, n-1) );
<a name="l00909"></a>00909    <span class="keywordflow">for</span> (i = (n - 2); i &gt;= 0; i--)
<a name="l00910"></a>00910    {
<a name="l00911"></a>00911         
<a name="l00912"></a>00912       t = y-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i);
<a name="l00913"></a>00913       <span class="keywordflow">for</span> (j = (n - 1); j &gt; i; j--) t -= a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,j) * x-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j);
<a name="l00914"></a>00914       x-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i, t / a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,j) );
<a name="l00915"></a>00915    }
<a name="l00916"></a>00916 
<a name="l00917"></a>00917    <span class="keyword">delete</span> y;
<a name="l00918"></a>00918 }
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_5b4cee95d591129db28aa76341a0d646_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_5b4cee95d591129db28aa76341a0d646_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_5b4cee95d591129db28aa76341a0d646_cgraph_map">
<area shape="rect" id="node3" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col." alt="" coords="236,5,343,33"><area shape="rect" id="node7" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas." alt="" coords="228,55,351,83"><area shape="rect" id="node9" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna." alt="" coords="235,106,344,134"><area shape="rect" id="node11" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector." alt="" coords="233,157,345,185"><area shape="rect" id="node5" href="../../d5/db2/class_vector.html#1e61a24886a05a02609e75c3d2a53e16" title="Visualiza información general de la matriz." alt="" coords="400,81,560,109"></map>
</div>

<p>
<div class="dynheader">
Gráfico de llamadas a esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_5b4cee95d591129db28aa76341a0d646_icgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_5b4cee95d591129db28aa76341a0d646_icgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_5b4cee95d591129db28aa76341a0d646_icgraph_map">
<area shape="rect" id="node3" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones." alt="" coords="269,5,464,33"><area shape="rect" id="node7" href="../../d9/d85/class_sistema___lineal.html#fd67cab00f52f81023d49c8ac27a6ba7" title="Resuelve el sistema Ax=b usando factorizacion LU." alt="" coords="228,55,505,83"><area shape="rect" id="node5" href="../../df/d0a/main_8cpp.html#0ddf1224851353fc92bfbff6f499fa97" title="Programa principal &#45; Soluciona la ecuacion diferencial de transporte de la luz en..." alt="" coords="556,5,604,33"></map>
</div>

</div>
</div><p>
<a class="anchor" name="a5f79942effd4bb705f09a054db19ca3"></a><!-- doxytag: member="Sistema_Lineal::Solve_U" ref="a5f79942effd4bb705f09a054db19ca3" args="(Matriz *a, Vector *x, Vector *y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sistema_Lineal::Solve_U           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d09/class_matriz.html">Matriz</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/db2/class_vector.html">Vector</a> *&nbsp;</td>
          <td class="paramname"> <em>y</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Resuelve el sistema UX=Y, dados U y Y. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00768">768</a> del archivo <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a>.</p>

<p>Hace referencia a <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00037">Vector::Asigna()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00058">Matriz::Columnas()</a>, <a class="el" href="../../d3/dfa/_matriz_8hpp_source.html#l00095">Matriz::Retorna()</a>, y <a class="el" href="../../d6/d4f/_vector_8cpp_source.html#l00051">Vector::Retorna()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00769"></a>00769 {
<a name="l00770"></a>00770    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i, j, n = a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas.">Columnas</a>();
<a name="l00771"></a>00771    <span class="keywordtype">double</span> t;
<a name="l00772"></a>00772    
<a name="l00773"></a>00773    x-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(n - 1, y-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(n - 1) / a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(n - 1, n-1) );
<a name="l00774"></a>00774    <span class="keywordflow">for</span> (i = (n - 2); i &gt;= 0; i--)
<a name="l00775"></a>00775    {
<a name="l00776"></a>00776       t = y-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i);
<a name="l00777"></a>00777       <span class="keywordflow">for</span> (j = (n - 1); j &gt; i; j--) t -= a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,j) * x-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j);
<a name="l00778"></a>00778       x-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i, t / a-&gt;<a class="code" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna.">Retorna</a>(i,j) );
<a name="l00779"></a>00779    }
<a name="l00780"></a>00780 }
</pre></div>
<p>

<p>
<div class="dynheader">
Gráfico de llamadas para esta función:</div>
<div class="dynsection">
<p><center><img src="../../d9/d85/class_sistema___lineal_a5f79942effd4bb705f09a054db19ca3_cgraph.png" border="0" usemap="#d9/d85/class_sistema___lineal_a5f79942effd4bb705f09a054db19ca3_cgraph_map" alt=""></center>
<map name="d9/d85/class_sistema___lineal_a5f79942effd4bb705f09a054db19ca3_cgraph_map">
<area shape="rect" id="node3" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col." alt="" coords="228,5,335,33"><area shape="rect" id="node7" href="../../d4/d09/class_matriz.html#45dd5eb4b50fa4371a0ebc9cc0eb270a" title="Retorna el numero de columnas." alt="" coords="220,55,343,83"><area shape="rect" id="node9" href="../../d4/d09/class_matriz.html#a16830eeeea822a3d5e1277d4b718c25" title="Retorna valor en fila, columna." alt="" coords="227,106,336,134"><area shape="rect" id="node11" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector." alt="" coords="225,157,337,185"><area shape="rect" id="node5" href="../../d5/db2/class_vector.html#1e61a24886a05a02609e75c3d2a53e16" title="Visualiza información general de la matriz." alt="" coords="392,81,552,109"></map>
</div>

</div>
</div><p>
<hr><h2>Documentación de los datos miembro</h2>
<a class="anchor" name="22ec3a7c7156c6f16ca0ad38b6bd8aaf"></a><!-- doxytag: member="Sistema_Lineal::INDICE_FILAS" ref="22ec3a7c7156c6f16ca0ad38b6bd8aaf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d59/class_vector___entero.html">Vector_Entero</a>* <a class="el" href="../../d9/d85/class_sistema___lineal.html#22ec3a7c7156c6f16ca0ad38b6bd8aaf">Sistema_Lineal::INDICE_FILAS</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Usado en el calculo paralelo para indicar fila inicial global. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00024">24</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Referenciado por <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00079">Asigna_Indice_FIla()</a>, y <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00085">LSQR_Resolver_Paralelo()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6499811137fbc0ee092d3266f601dc28"></a><!-- doxytag: member="Sistema_Lineal::Iteraciones" ref="6499811137fbc0ee092d3266f601dc28" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long long <a class="el" href="../../d9/d85/class_sistema___lineal.html#6499811137fbc0ee092d3266f601dc28">Sistema_Lineal::Iteraciones</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Numero de iteraciones para uso en metodos iterativos. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00020">20</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Referenciado por <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00057">Get_Iteraciones()</a>, y <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00062">Set_Iteraciones()</a>.</p>

</div>
</div><p>
<a class="anchor" name="a0e532bf4b0effd912e3b40b64a10b6d"></a><!-- doxytag: member="Sistema_Lineal::nDesconocido" ref="a0e532bf4b0effd912e3b40b64a10b6d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long long <a class="el" href="../../d9/d85/class_sistema___lineal.html#a0e532bf4b0effd912e3b40b64a10b6d">Sistema_Lineal::nDesconocido</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Numero de variables desconocidas. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00016">16</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Referenciado por <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00086">Get_nDesconocido()</a>, y <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00092">Set_nDesconocido()</a>.</p>

</div>
</div><p>
<a class="anchor" name="661c39bcb3d3391b09e602d6d7aed46e"></a><!-- doxytag: member="Sistema_Lineal::NP" ref="661c39bcb3d3391b09e602d6d7aed46e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d9/d85/class_sistema___lineal.html#661c39bcb3d3391b09e602d6d7aed46e">Sistema_Lineal::NP</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Numero de procesos. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00018">18</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Referenciado por <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00074">GetNP()</a>, y <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00068">SetNP()</a>.</p>

</div>
</div><p>
<a class="anchor" name="61120f444e00866ec11ad5aa10e3cfdc"></a><!-- doxytag: member="Sistema_Lineal::Traza" ref="61120f444e00866ec11ad5aa10e3cfdc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d9/d85/class_sistema___lineal.html#61120f444e00866ec11ad5aa10e3cfdc">Sistema_Lineal::Traza</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Indica si se desea alamcenar en archivo la convergencia del error. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00022">22</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Referenciado por <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00051">Get_Traza()</a>, <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00045">Set_Traza()</a>, y <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00033">Sistema_Lineal()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b5a2b3cc2401946436d9d348afda71c9"></a><!-- doxytag: member="Sistema_Lineal::tSistema" ref="b5a2b3cc2401946436d9d348afda71c9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="../../d9/d85/class_sistema___lineal.html#b5a2b3cc2401946436d9d348afda71c9">Sistema_Lineal::tSistema</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Tiempo utilizado en resolver sistema. 
<p>

<p>Definición en la línea <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html#l00026">26</a> del archivo <a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a>.</p>

<p>Referenciado por <a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html#l00085">LSQR_Resolver_Paralelo()</a>, y <a class="el" href="../../d8/db6/_f_e_m_8cpp_source.html#l00550">FEM::Resolver_Sistema_FEM()</a>.</p>

</div>
</div><p>
<hr>La documentación para esta clase fue generada a partir de los siguientes ficheros:<ul>
<li><a class="el" href="../../d9/dc1/_sistema___lineal_8hpp_source.html">Sistema_Lineal.hpp</a><li><a class="el" href="../../d9/d2a/_sistema___lineal_8cpp_source.html">Sistema_Lineal.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generado el Mon Oct 5 22:07:55 2009 para ETRAD por&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
