<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>ETRAD: Fichero Fuente FEM.cpp</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css">
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generado por Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../main.html"><span>Página&nbsp;principal</span></a></li>
      <li><a href="../../annotated.html"><span>Clases</span></a></li>
      <li class="current"><a href="../../files.html"><span>Archivos</span></a></li>
    <li>
      <form action="../../search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;Buscar&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../files.html"><span>Lista&nbsp;de&nbsp;archivos</span></a></li>
      <li><a href="../../globals.html"><span>Miembros&nbsp;de&nbsp;los&nbsp;ficheros</span></a></li>
    </ul>
  </div>
<h1>FEM.cpp</h1><a href="../../d8/db6/_f_e_m_8cpp.html">Ir a la documentación de este archivo.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include "<a class="code" href="../../d7/dd9/_f_e_m_8hpp.html">FEM.hpp</a>"</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 
<a name="l00005"></a><a class="code" href="../../d2/d56/class_f_e_m.html#d1aea7b8611e582dbb499b100ffe67b1">00005</a> <span class="keywordtype">void</span> <a class="code" href="../../d2/d56/class_f_e_m.html#d1aea7b8611e582dbb499b100ffe67b1" title="Carga datos de calculos elementales a una matriz global para futuro calculo paralelo...">FEM::Carga_Datos_Elementos_Grilla</a>(<span class="keywordtype">void</span>)
<a name="l00006"></a>00006 {
<a name="l00007"></a>00007         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n1,n2,n3;
<a name="l00008"></a>00008         <span class="keywordtype">double</span> area,fi1,fi2,fi3;
<a name="l00009"></a>00009         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> nElementos;
<a name="l00010"></a>00010         <span class="keywordtype">int</span> rank;
<a name="l00011"></a>00011     MPI_Comm_rank(MPI_COMM_WORLD,&amp;rank);        
<a name="l00012"></a>00012         
<a name="l00013"></a>00013         <span class="keywordflow">if</span>(rank==0)
<a name="l00014"></a>00014         nElementos =  <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../df/d5d/class_geometria.html#cca22abfeb1e3fdb0499efd69c9aaec9" title="Retorna el numero de elementos.">Retorna_Numero_Elementos</a>();
<a name="l00015"></a>00015 
<a name="l00016"></a>00016         <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>=MPI_Wtime();
<a name="l00017"></a>00017     MPI_Bcast(&amp;nElementos,1,MPI_INT,0,MPI_COMM_WORLD);
<a name="l00018"></a>00018         <a class="code" href="../../d2/d56/class_f_e_m.html#9c8c01f9763ddc1a3fff6e76dbd69f30">Tiempo_Parcial_Comunicacion_Grilla</a>=MPI_Wtime() - <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>;
<a name="l00019"></a>00019   
<a name="l00020"></a>00020         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#016bfdd04bd24732d2f32e17bf9c44d7" title="Reserva memoria para los datos de todo el calculo realizado por la aproximacion original...">Reserva_Memoria_Datos_Elementos_Vector</a>(nElementos);
<a name="l00021"></a>00021         
<a name="l00022"></a>00022         <span class="keywordflow">if</span>(rank==0)
<a name="l00023"></a>00023         {       
<a name="l00024"></a>00024         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#51a1f2b5b2a637956032ea1a79eb5cec" title="Matriz que contiene todo los datos de los elementos (id elemento, area, coeficientes...">Datos_Elementos</a> = <span class="keyword">new</span> <a class="code" href="../../d4/d09/class_matriz.html" title="Clase para el trabajar con matrices de tipo double.">Matriz</a>(nElementos,17);
<a name="l00025"></a>00025         
<a name="l00026"></a>00026                         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>  i=0;i&lt;nElementos;i++)
<a name="l00027"></a>00027                         {
<a name="l00028"></a>00028                         
<a name="l00029"></a>00029                                 n1 =<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#d05da9769648adf32919e53c1786b928" title="Retorna el arreglo de objetos Elemento_Triangular[] de la geometria.">Retornar_Elementos_Geometria</a>()[i].<a class="code" href="../../d6/db7/class_elemento___triangular.html#4c0655995692de148ec43529a6c9a013" title="Retorna la numeracion nodal global del nodo local &amp;quot;Posicion_Nodal&amp;quot;.">Get_Valor_Nodo</a>(0);
<a name="l00030"></a>00030                                 n2 =<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#d05da9769648adf32919e53c1786b928" title="Retorna el arreglo de objetos Elemento_Triangular[] de la geometria.">Retornar_Elementos_Geometria</a>()[i].<a class="code" href="../../d6/db7/class_elemento___triangular.html#4c0655995692de148ec43529a6c9a013" title="Retorna la numeracion nodal global del nodo local &amp;quot;Posicion_Nodal&amp;quot;.">Get_Valor_Nodo</a>(1);
<a name="l00031"></a>00031                                 n3 =<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#d05da9769648adf32919e53c1786b928" title="Retorna el arreglo de objetos Elemento_Triangular[] de la geometria.">Retornar_Elementos_Geometria</a>()[i].<a class="code" href="../../d6/db7/class_elemento___triangular.html#4c0655995692de148ec43529a6c9a013" title="Retorna la numeracion nodal global del nodo local &amp;quot;Posicion_Nodal&amp;quot;.">Get_Valor_Nodo</a>(2);
<a name="l00032"></a>00032                                 
<a name="l00033"></a>00033                                 area = <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#d05da9769648adf32919e53c1786b928" title="Retorna el arreglo de objetos Elemento_Triangular[] de la geometria.">Retornar_Elementos_Geometria</a>()[i].<a class="code" href="../../d6/db7/class_elemento___triangular.html#d067704991ae4527c9f216abc134b45b" title="retorna el area del elemento">Get_Area</a>();
<a name="l00034"></a>00034                                 
<a name="l00035"></a>00035                                 fi1 = <a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(n1);
<a name="l00036"></a>00036                                 fi2 = <a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(n2);
<a name="l00037"></a>00037                                 fi3 = <a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(n3);
<a name="l00038"></a>00038                                 
<a name="l00039"></a>00039                                 <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#8c69adffccf5332ba7f9ccb7b9a69214" title="Almacena en una fila especifica de la matriz Datos_Elementos (id elemento, area,...">Almacenar_Datos_Elemento</a>(i,i, n1, n2, n3, area, fi1, fi2, fi3,  <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#d05da9769648adf32919e53c1786b928" title="Retorna el arreglo de objetos Elemento_Triangular[] de la geometria.">Retornar_Elementos_Geometria</a>()[i].<a class="code" href="../../d6/db7/class_elemento___triangular.html#1c51055dbe2c2eca303110d31e830b50" title="Retorna la matriz de permutacion del elemento.">Get_Coeficientes_Permutacion</a>());
<a name="l00040"></a>00040                         
<a name="l00041"></a>00041                         }
<a name="l00042"></a>00042                         
<a name="l00043"></a>00043         
<a name="l00044"></a>00044     
<a name="l00045"></a>00045         }
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 }
<a name="l00048"></a>00048 
<a name="l00051"></a><a class="code" href="../../d2/d56/class_f_e_m.html#f645ce4e1d5af2b75657f77a03700055">00051</a> <span class="keywordtype">void</span> <a class="code" href="../../d2/d56/class_f_e_m.html#f645ce4e1d5af2b75657f77a03700055" title="Carga la geometria y calcula las areas de los elementos y matrices de permutacion...">FEM::CargarGeometriaFEM</a>()
<a name="l00052"></a>00052 { 
<a name="l00053"></a>00053   <span class="keywordtype">int</span> rank;
<a name="l00054"></a>00054   MPI_Comm_rank(MPI_COMM_WORLD,&amp;rank);  
<a name="l00055"></a>00055 
<a name="l00056"></a>00056    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d56/class_f_e_m.html#965e8ec1d9b1fe17ceaafdf03360560e" title="Tipo de geometria a utilizar.">TIPO_GEOMETRIA</a> == <a class="code" href="../../d7/dd9/_f_e_m_8hpp.html#d64fdbe91944c7e5ac56e660844a1c06" title="Indica que se utilizara geometria basada en elementos triangulares.">GEOMETRIA_TRIANGULOS</a>)
<a name="l00057"></a>00057    {
<a name="l00058"></a>00058    printf(<span class="stringliteral">"Cargando Geometria2DTriangulos FEM con elementos triangulares\n"</span>);     
<a name="l00059"></a>00059            
<a name="l00060"></a>00060    <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>=<span class="keyword">new</span> <a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html" title="Clase para generar una geometria triangular 2D.">Geometria2D_Triangulos</a>();
<a name="l00061"></a>00061    <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#a6567796bc94639cde89950e61f0c151" title="Carga la informacion de los Nodos de la geometria desde el archivo en formato Matlab-PDETool...">Carga_Nodos</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#e2db7bc557e6ed5030beab0e5d022e26" title="Retorna el nombre del archivo nodos.">GetNombreArchivoNodos</a>()); 
<a name="l00062"></a>00062    <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#ff0abe00a2cb92cf0687156afbb9b803" title="Carga la informacion de los Elementos de la geometria desde el archivo en formato...">Carga_Elementos</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#a86adb47841c30d564d495e71fd76125" title="Retorna el nombre del archivo elementos.">GetNombreArchivoElementos</a>()); 
<a name="l00063"></a>00063    <span class="comment">// Estos calculos se realizan en esta instancia para no repetir los ciclos for al momento de obtener las matrices de rigidez y masa locales, donde es necesario </span>
<a name="l00064"></a>00064    <span class="comment">// tener como dato, el area y la matriz de permutacion          </span>
<a name="l00065"></a>00065  
<a name="l00066"></a>00066    <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#f845493234981a5489423df055cad16b" title="Calcula los centroides de todos los elementos de la geometria.">Centroides_Elementos</a>();
<a name="l00067"></a>00067    <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#f4bf02e35914dfd2b073b6d683e59ee4" title="Calcula las permutaciones de todos los elementos de la geometria.">Permutaciones_Elementos</a>();
<a name="l00068"></a>00068    <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#f0858b4a30c7118f64700b1517b52849" title="Calcula todas las areas de los elementos de la geometria.">Areas_Elementos</a>();
<a name="l00069"></a>00069    <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#70e5eb1ebd6ccbffa5a0cf12d33d6aa1" title="Carga la informacion de las Fronteras de la geometria desde el archivo en formato...">Carga_Fronteras</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#53480d350bb8538669e816767d2e27ed" title="Retorna el nombre del archivo fronteras.">GetNombreArchivoFronteras</a>());
<a name="l00070"></a>00070            
<a name="l00071"></a>00071    }
<a name="l00072"></a>00072 
<a name="l00073"></a>00073    
<a name="l00074"></a>00074    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d56/class_f_e_m.html#965e8ec1d9b1fe17ceaafdf03360560e" title="Tipo de geometria a utilizar.">TIPO_GEOMETRIA</a> == <a class="code" href="../../d7/dd9/_f_e_m_8hpp.html#0ad7df0b7b0ad13361f139b5cdf4f749" title="Indica que se utilizara geometria basada en elementos cuadrilateros.">GEOMETRIA_CUADRILATEROS</a>)
<a name="l00075"></a>00075    {
<a name="l00076"></a>00076    printf(<span class="stringliteral">"Geometria no disponible..."</span>);
<a name="l00077"></a>00077    MPI_Finalize();
<a name="l00078"></a>00078    exit(1);        
<a name="l00079"></a>00079    }
<a name="l00080"></a>00080    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d56/class_f_e_m.html#965e8ec1d9b1fe17ceaafdf03360560e" title="Tipo de geometria a utilizar.">TIPO_GEOMETRIA</a> == <a class="code" href="../../d7/dd9/_f_e_m_8hpp.html#d68eecabab19549db7126cfe8cb4ae50" title="Indica que se utilizara geometria basada en elementos tetrahedros.">GEOMETRIA_TETRAHEDROS</a>)
<a name="l00081"></a>00081    {
<a name="l00082"></a>00082    printf(<span class="stringliteral">"Geometria no disponible..."</span>);
<a name="l00083"></a>00083    MPI_Finalize();
<a name="l00084"></a>00084    exit(1);
<a name="l00085"></a>00085    }
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 }
<a name="l00088"></a>00088 
<a name="l00090"></a><a class="code" href="../../d2/d56/class_f_e_m.html#e7826a622b8620f183955cfb32f2a001">00090</a> <span class="keywordtype">void</span> <a class="code" href="../../d2/d56/class_f_e_m.html#e7826a622b8620f183955cfb32f2a001" title="Muestra el tipo de geometria que se esta utilizando.">FEM::VerTipoGeometria</a>(<span class="keywordtype">void</span>)
<a name="l00091"></a>00091 { 
<a name="l00092"></a>00092    printf(<span class="stringliteral">"La geometria es...\n"</span>);        
<a name="l00093"></a>00093         
<a name="l00094"></a>00094    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d56/class_f_e_m.html#965e8ec1d9b1fe17ceaafdf03360560e" title="Tipo de geometria a utilizar.">TIPO_GEOMETRIA</a> == <a class="code" href="../../d7/dd9/_f_e_m_8hpp.html#d64fdbe91944c7e5ac56e660844a1c06" title="Indica que se utilizara geometria basada en elementos triangulares.">GEOMETRIA_TRIANGULOS</a>)
<a name="l00095"></a>00095    {
<a name="l00096"></a>00096    printf(<span class="stringliteral">"Viendo geometria FEM con elementos triangulares\n"</span>);   
<a name="l00097"></a>00097            
<a name="l00098"></a>00098                    
<a name="l00099"></a>00099    }
<a name="l00100"></a>00100    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d56/class_f_e_m.html#965e8ec1d9b1fe17ceaafdf03360560e" title="Tipo de geometria a utilizar.">TIPO_GEOMETRIA</a> == <a class="code" href="../../d7/dd9/_f_e_m_8hpp.html#0ad7df0b7b0ad13361f139b5cdf4f749" title="Indica que se utilizara geometria basada en elementos cuadrilateros.">GEOMETRIA_CUADRILATEROS</a>)
<a name="l00101"></a>00101    {
<a name="l00102"></a>00102    printf(<span class="stringliteral">"Viendo Cuadrilateros no disponible...\n"</span>);
<a name="l00103"></a>00103            
<a name="l00104"></a>00104    }
<a name="l00105"></a>00105    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d56/class_f_e_m.html#965e8ec1d9b1fe17ceaafdf03360560e" title="Tipo de geometria a utilizar.">TIPO_GEOMETRIA</a> == <a class="code" href="../../d7/dd9/_f_e_m_8hpp.html#d68eecabab19549db7126cfe8cb4ae50" title="Indica que se utilizara geometria basada en elementos tetrahedros.">GEOMETRIA_TETRAHEDROS</a>)
<a name="l00106"></a>00106    {
<a name="l00107"></a>00107    printf(<span class="stringliteral">"Viendo Tetrahedros no disponible...\n"</span>);
<a name="l00108"></a>00108    }
<a name="l00109"></a>00109         
<a name="l00110"></a>00110 }
<a name="l00111"></a>00111 
<a name="l00113"></a><a class="code" href="../../d2/d56/class_f_e_m.html#6792c500fd0b5bf2e08dbb77dff47de2">00113</a> <span class="keywordtype">void</span> <a class="code" href="../../d2/d56/class_f_e_m.html#6792c500fd0b5bf2e08dbb77dff47de2" title="Inicializa problema ETRAD (rECORDAR CAMBIAR IMPLEMNETACION Y DEJARLA EN UNA CLASE...">FEM::Inicializa_Problema_ETRAD</a>(<a class="code" href="../../d9/d04/class_e_t_r_a_d.html" title="Clase que define las caracteristicas del problema de difusion de la luz en medios...">ETRAD</a> *FisicaProblema,<span class="keywordtype">int</span> tipoFase)
<a name="l00114"></a>00114 {  <a class="code" href="../../d2/d56/class_f_e_m.html#003bd70b0e5d985e6021cc3d42901d3c" title="Tiempo total utilizado en comunicacion.">tTotalComunicacion</a>=0.0;      
<a name="l00115"></a>00115         FisicaProblema-&gt;<a class="code" href="../../d9/d04/class_e_t_r_a_d.html#34ad7ad06ebb87b2dd48ed5d61b298d6" title="Carga del archivo que contiene los datos de absorcion en los distintos subdominios...">Carga_Absorcion</a>(FisicaProblema-&gt;<a class="code" href="../../d9/d04/class_e_t_r_a_d.html#e4375b0a8188701d83dd47d4fae3bf5d" title="Retorna el nombre del archivo asociado a la absorcion.">GetNombreArchivoAbsorcion</a>());
<a name="l00116"></a>00116         FisicaProblema-&gt;<a class="code" href="../../d9/d04/class_e_t_r_a_d.html#42afeac61d3d69f05a1eab1bc1bbbf96" title="Carga el archivo que contiene los datos de scattering en los distintos subdominios...">Carga_Scattering</a>(FisicaProblema-&gt;<a class="code" href="../../d9/d04/class_e_t_r_a_d.html#a15984298809ac6f4a0eee8fa476ecb3" title="Retorna el nombre del archivo asociado al scattering.">GetNombreArchivoScattering</a>());
<a name="l00117"></a>00117         FisicaProblema-&gt;<a class="code" href="../../d9/d04/class_e_t_r_a_d.html#47586aa1df01f51824d809cde91a6fd1" title="Carga el archivo que contiene los datos de las fuentes.">Carga_Fuentes</a>(FisicaProblema-&gt;<a class="code" href="../../d9/d04/class_e_t_r_a_d.html#1c7ccd056c41fbbed4e15693272c7b59" title="Retorna el nombre del archivo asociado a las fuentes.">GetNombreArchivoFuentes</a>());
<a name="l00118"></a>00118         <a class="code" href="../../d2/d56/class_f_e_m.html#738789113ad0052c6f8cc76ae71e06d6" title="Asigna el suma de magnitudes original en vector de cargas.">Set_sCarga</a>((<span class="keywordtype">double</span>)FisicaProblema-&gt;<a class="code" href="../../d9/d04/class_e_t_r_a_d.html#2bedf6f0d618465f2f1f1ceb6a63bfc5" title="Retorna la suma del numero de fotones provenientes de las fuentes en todo el dominio...">Get_Suma_Fuentes</a>());
<a name="l00119"></a>00119         <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#24c502399a98c374d5aea103051e2498" title="Carga variables fisicas del problema - Dependiendo de los tipos de problemas se deben...">Carga_Variables_Fisicas_Elementos_ETRAD</a>(FisicaProblema);
<a name="l00120"></a>00120 }
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 
<a name="l00124"></a><a class="code" href="../../d2/d56/class_f_e_m.html#f703ba89da06a72d85fdda288c02ca12">00124</a> <span class="keywordtype">void</span> <a class="code" href="../../d2/d56/class_f_e_m.html#f703ba89da06a72d85fdda288c02ca12" title="Calcula las matrices de rigidez, de masa y vector de carga de los elementos,.">FEM::Contruir_Matrices_Problema</a>()
<a name="l00125"></a>00125 {
<a name="l00126"></a>00126         <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#6382c1920105197bbe1936df4034438a" title="Genera las matrices de rigides de todos los elementos de la geometria.">Generar_Matrices_de_Rigidez_Elementos</a>();
<a name="l00127"></a>00127         <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#8e3504f64cbfec69c5dcbc968db1545d" title="Genera las matrices de masa de todos los elementos de la geometria.">Generar_Matrices_de_Masa_Elementos</a>();
<a name="l00128"></a>00128     <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#43dd2fd9626fe1baaf4b7e718d3c36c8" title="Calcula los vectores de carga de todos los elementos del dominio.">Generar_Vectores_de_Cargas</a>();
<a name="l00129"></a>00129 }
<a name="l00130"></a>00130 
<a name="l00132"></a><a class="code" href="../../d2/d56/class_f_e_m.html#e6b4e158338412c54851a97ba274bce5">00132</a> <span class="keywordtype">void</span> <a class="code" href="../../d2/d56/class_f_e_m.html#e6b4e158338412c54851a97ba274bce5" title="Calcula la dendidad global de la solucion FEM, es una suma de densidades nodales...">FEM::Densidad_FEM</a>(<span class="keywordtype">void</span>)
<a name="l00133"></a>00133 {
<a name="l00134"></a>00134 <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#8dbc0268621cc932c699c1e2b084ea55" title="Funcion que carga las densidades nodales obtenidas por el metodo de elementos finitos...">Carga_Densidad_Nodal_Vector</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>);       
<a name="l00135"></a>00135 }
<a name="l00136"></a>00136 
<a name="l00138"></a><a class="code" href="../../d2/d56/class_f_e_m.html#7b894b8fda86f5a0b917a24c64b7efb8">00138</a> <span class="keywordtype">void</span> <a class="code" href="../../d2/d56/class_f_e_m.html#7b894b8fda86f5a0b917a24c64b7efb8" title="Adquisicion de datos de la grilla a calcular.">FEM::Ingreso_Datos_Grilla_FEM</a>(<a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *dominio,<a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a> *Resolucion,<span class="keywordtype">int</span> nProcesos)
<a name="l00139"></a>00139 {
<a name="l00140"></a>00140  <span class="keywordtype">int</span> rank,size;
<a name="l00141"></a>00141  <span class="keywordtype">int</span> gFila,gColumna;
<a name="l00142"></a>00142  MPI_Comm_rank(MPI_COMM_WORLD,&amp;rank);   
<a name="l00143"></a>00143  MPI_Comm_size(MPI_COMM_WORLD, &amp;size);
<a name="l00144"></a>00144 
<a name="l00145"></a>00145         <span class="keywordflow">if</span>(rank==0)
<a name="l00146"></a>00146         {  
<a name="l00147"></a>00147                 <span class="keywordflow">if</span>(size&gt;1)
<a name="l00148"></a>00148                 {       
<a name="l00149"></a>00149                 <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#59a20a3a5d6071a7d0e97b59f2724941" title="Almacena en punteros los nodos de la geometria FEM para distribucion de informacion...">Almacenar_Nodos_Geometria</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#587e36858c57a14e742f05a193b31e83" title="Retorna el arreglo de objetos Nodo_2D[] de la Geometria.">Retornar_Nodos_Geometria</a>(),<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../df/d5d/class_geometria.html#8883f64fa3d61833004018ac8e28d774" title="Retorna el numero de nodos.">Retorna_Numero_Nodos</a>());
<a name="l00150"></a>00150                 <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d8/d4a/class_geometria2_d.html#d92f8d9c32a60d43e8e7c7cb071d628e" title="Calcula particiones Grilla.">Calcula_Particiones_Grilla</a>(nProcesos);        
<a name="l00151"></a>00151                 printf(<span class="stringliteral">"FILA = %d \n"</span>,<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d8/d4a/class_geometria2_d.html#ff05436ca4cbf4b72a8fe0ca336200c1" title="Retorna el numero de filas de la grilla.">Get_FilaGrilla</a>());      
<a name="l00152"></a>00152                 printf(<span class="stringliteral">"COLUMNA = %d \n"</span>,<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d8/d4a/class_geometria2_d.html#b4b16d352b9fe3e6e1cdf8b132d2b17a" title="Retorna el numero de columnas de la grilla.">Get_ColumnaGrilla</a>());
<a name="l00153"></a>00153                 gFila=<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d8/d4a/class_geometria2_d.html#ff05436ca4cbf4b72a8fe0ca336200c1" title="Retorna el numero de filas de la grilla.">Get_FilaGrilla</a>();
<a name="l00154"></a>00154                 gColumna=<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d8/d4a/class_geometria2_d.html#b4b16d352b9fe3e6e1cdf8b132d2b17a" title="Retorna el numero de columnas de la grilla.">Get_ColumnaGrilla</a>();
<a name="l00155"></a>00155                 }       
<a name="l00156"></a>00156                 <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d8/d4a/class_geometria2_d.html#c95ff8c34fa6a7c9e633df6f58694f57" title="Asigna la resolucion X de la grilla.">Set_ResolucionX</a>((<span class="keywordtype">int</span>)Resolucion-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(0)); 
<a name="l00157"></a>00157                 <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d8/d4a/class_geometria2_d.html#0b1aa680f85b12a4296ab096addd82a5" title="Asigna la resolucion Y de la grilla.">Set_ResolucionY</a>((<span class="keywordtype">int</span>)Resolucion-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(1));         
<a name="l00158"></a>00158                 <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d8/d4a/class_geometria2_d.html#a353ce1ba526b421633ca59633d8d2a7" title="Almacena el numero total de puntos de la grilla.">Set_NumeroPuntosGrilla</a>(Resolucion-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(0)*Resolucion-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(1));
<a name="l00159"></a>00159         }
<a name="l00160"></a>00160         
<a name="l00161"></a>00161         <span class="keywordflow">if</span>(size&gt;1)
<a name="l00162"></a>00162         {       
<a name="l00163"></a>00163                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>=MPI_Wtime();
<a name="l00164"></a>00164                                                 MPI_Bcast(&amp;gFila,1,MPI_INT,0,MPI_COMM_WORLD);
<a name="l00165"></a>00165                                                 MPI_Bcast(&amp;gColumna,1,MPI_INT,0,MPI_COMM_WORLD);
<a name="l00166"></a>00166                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#9c8c01f9763ddc1a3fff6e76dbd69f30">Tiempo_Parcial_Comunicacion_Grilla</a>+=MPI_Wtime() - <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>;
<a name="l00167"></a>00167                                                 
<a name="l00168"></a>00168                                                 <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a> *Particion_Geometria_Fila = <span class="keyword">new</span> <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a>(gFila,<span class="stringliteral">"Particion_Geometria_Fila"</span>);
<a name="l00169"></a>00169                                                 <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a> *Particion_Geometria_Columna = <span class="keyword">new</span> <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a>(gColumna,<span class="stringliteral">"Particion_Geometria_Columna"</span>);
<a name="l00170"></a>00170                                                 <a class="code" href="../../df/d98/class_matriz___entera.html" title="Clase para el trabajar con matrices Enteras sin signo.">Matriz_Entera</a> *Dim_Fila_Columna =  <span class="keyword">new</span> <a class="code" href="../../df/d98/class_matriz___entera.html" title="Clase para el trabajar con matrices Enteras sin signo.">Matriz_Entera</a>(2,size);
<a name="l00171"></a>00171                                                 <a class="code" href="../../df/d98/class_matriz___entera.html" title="Clase para el trabajar con matrices Enteras sin signo.">Matriz_Entera</a> *Bandera_Fila_Columna =  <span class="keyword">new</span> <a class="code" href="../../df/d98/class_matriz___entera.html" title="Clase para el trabajar con matrices Enteras sin signo.">Matriz_Entera</a>(2,size);
<a name="l00172"></a>00172                                                 
<a name="l00173"></a>00173                                         
<a name="l00174"></a>00174                                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#a7a2afdf1dbd7cdf9dac4d2df692002e" title="Particiona un vector segun numero de procesadores, almacenando el largo de cada sub...">Obtener_Vector_Particion</a>(gFila,Resolucion-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(1),Particion_Geometria_Fila);      
<a name="l00175"></a>00175                                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#a7a2afdf1dbd7cdf9dac4d2df692002e" title="Particiona un vector segun numero de procesadores, almacenando el largo de cada sub...">Obtener_Vector_Particion</a>(gColumna,Resolucion-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(0),Particion_Geometria_Columna);        
<a name="l00176"></a>00176                                         
<a name="l00177"></a>00177                                         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> sumaC;
<a name="l00178"></a>00178                                         <span class="keywordtype">int</span> contador=0;
<a name="l00179"></a>00179                                         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i=0;i&lt; Particion_Geometria_Fila-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#d1d5779a63bf05b51bec19fa6a03cd29" title="Retorna el numero de columnas.">Columnas</a>();i++)
<a name="l00180"></a>00180                                         {
<a name="l00181"></a>00181                                                 sumaC=0;
<a name="l00182"></a>00182                                                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0;j&lt; Particion_Geometria_Columna-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#d1d5779a63bf05b51bec19fa6a03cd29" title="Retorna el numero de columnas.">Columnas</a>();j++)
<a name="l00183"></a>00183                                                 {
<a name="l00184"></a>00184                                                 
<a name="l00185"></a>00185                                                         Dim_Fila_Columna-&gt;<a class="code" href="../../df/d98/class_matriz___entera.html#b982645d04ece06fbc48831a2b766c23" title="Asigna valor en fila, columna.">Asigna</a>(0,contador,Particion_Geometria_Fila-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(i));
<a name="l00186"></a>00186                                                         Dim_Fila_Columna-&gt;<a class="code" href="../../df/d98/class_matriz___entera.html#b982645d04ece06fbc48831a2b766c23" title="Asigna valor en fila, columna.">Asigna</a>(1,contador,Particion_Geometria_Columna-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(j));
<a name="l00187"></a>00187                                                         Bandera_Fila_Columna-&gt;<a class="code" href="../../df/d98/class_matriz___entera.html#b982645d04ece06fbc48831a2b766c23" title="Asigna valor en fila, columna.">Asigna</a>(0,contador,i);
<a name="l00188"></a>00188                                                         Bandera_Fila_Columna-&gt;<a class="code" href="../../df/d98/class_matriz___entera.html#b982645d04ece06fbc48831a2b766c23" title="Asigna valor en fila, columna.">Asigna</a>(1,contador,j);
<a name="l00189"></a>00189                                                         contador++;
<a name="l00190"></a>00190                                                 }               
<a name="l00191"></a>00191                                                 
<a name="l00192"></a>00192                                                 
<a name="l00193"></a>00193                                         }       
<a name="l00194"></a>00194                                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#dd0bee4e28ea9bdb259efc2e7b499d97" title="Almacena la matriz de particiones a partir de una matriz de entrada.">Almacena_Matriz_FC</a>(Dim_Fila_Columna);
<a name="l00195"></a>00195                                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#0d4e3ce9e3de9227906a502d2fede195" title="Almacena la matriz de indices de procesadores a partir de un matriz de entrada.">Almacena_Matriz_MP</a>(Bandera_Fila_Columna);
<a name="l00196"></a>00196                                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#bf5218b6796a93377f2f6fb8e2de13d8" title="Reserva memoria para los puntos de la grilla.">Reserva_Memoria_Puntos</a>(Dim_Fila_Columna-&gt;<a class="code" href="../../df/d98/class_matriz___entera.html#355f39b8f446d466ea7329c150097c70" title="Retorna valor en fila, columna.">Retorna</a>(0,rank)*Dim_Fila_Columna-&gt;<a class="code" href="../../df/d98/class_matriz___entera.html#355f39b8f446d466ea7329c150097c70" title="Retorna valor en fila, columna.">Retorna</a>(1,rank));
<a name="l00197"></a>00197                                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#47f7d4150dd1b68a184c5bc79a22383b" title="Reserva memoria para los centroides de la grilla particionada.">Reserva_Memoria_Centroides</a>(2);
<a name="l00198"></a>00198                                         <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#6cf1974b5d2e8ad6eb52ea230a26511f" title="Lamada a generar una grilla y almacenar las coordenadas en vectores.">Generar_Puntos_Grilla_FEM</a>(dominio,Resolucion,Dim_Fila_Columna,Bandera_Fila_Columna,<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#0552fe6c5c79bb8f9df63e9e94c56c92" title="Retorna en un vector los valores X de los puntos de la grilla.">Retorna_PuntosX</a>(),<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#f77887144dbd091ffd16a0b741baf214" title="Retorna en un vector los valores Y de los puntos de la grilla.">Retorna_PuntosY</a>(),<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#8ad325adee4afb2006b9d52b3e492c17" title="Retorna en un vector los centroides de las particiones de la grilla en paralelo.">Retorna_Centroides</a>(),rank);
<a name="l00199"></a>00199                 
<a name="l00200"></a>00200                 }
<a name="l00201"></a>00201                 <span class="keywordflow">else</span>
<a name="l00202"></a>00202                 {
<a name="l00203"></a>00203                         
<a name="l00204"></a>00204                         <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d8/d4a/class_geometria2_d.html#3d7d64283f7a6cc5f2ebfa87bb300c0c" title="Genera una grilla para un procesador.">Generar_Grilla_Memoria</a>(dominio,Resolucion);
<a name="l00205"></a>00205                 
<a name="l00206"></a>00206                 }
<a name="l00207"></a>00207 }
<a name="l00208"></a>00208 
<a name="l00210"></a><a class="code" href="../../d2/d56/class_f_e_m.html#715649b42475eb847e1fd32b56283b93">00210</a> <span class="keywordtype">void</span> <a class="code" href="../../d2/d56/class_f_e_m.html#715649b42475eb847e1fd32b56283b93" title="Aproximacion nodal a partir de una grilla de puntos.">FEM::Calculo_Grilla_FEM</a>()
<a name="l00211"></a>00211 {
<a name="l00212"></a>00212          <span class="keywordtype">int</span> size,rank;
<a name="l00213"></a>00213      MPI_Comm_rank(MPI_COMM_WORLD,&amp;rank);       
<a name="l00214"></a>00214          MPI_Comm_size(MPI_COMM_WORLD, &amp;size);
<a name="l00215"></a>00215          MPI_Status status;
<a name="l00216"></a>00216          <span class="keywordtype">double</span> minimo,Diferencial_Area;
<a name="l00217"></a>00217          <span class="keywordtype">double</span> distancia_centroide,x1,x2,y1,y2;
<a name="l00218"></a>00218      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>  total,fLocal,cLocal,fGlobal,cGlobal;
<a name="l00219"></a>00219          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>  dimtmp; 
<a name="l00220"></a>00220          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>  nElementos,nNodosTMP,contador,bFila,bColumna,pMinimo;
<a name="l00221"></a>00221      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>  desplazamiento=0; 
<a name="l00222"></a>00222          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>  *Puntos_Dominio=<span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> [1];
<a name="l00223"></a>00223          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> *dimensiones = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>[1];
<a name="l00224"></a>00224          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> *dimensiones_llegada= <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>[1];
<a name="l00225"></a>00225      <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *DistanciaTmp = <span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(2);
<a name="l00226"></a>00226          <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a> *Numero_Nodos_Dominio=<span class="keyword">new</span> <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a>(size);
<a name="l00227"></a>00227      <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *DistanciasGenerales = <span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(size*2);    
<a name="l00228"></a>00228          <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *Densidad_FEM_TMP;
<a name="l00229"></a>00229          <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *DENSIDADES_GRILLA;
<a name="l00230"></a>00230          <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *dGrilla;
<a name="l00231"></a>00231      <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a> *PerteneciaCentroides;
<a name="l00232"></a>00232 
<a name="l00233"></a>00233         <span class="keywordflow">if</span>(rank==0)
<a name="l00234"></a>00234         {
<a name="l00235"></a>00235                 Diferencial_Area =   <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d8/d4a/class_geometria2_d.html#5db5b525a1406c54ccbf50a42b9a801f" title="Calcula el area diferencial por cada nodo a partir de una grilla de entrada.">Calculo_Area_Diferencial</a>();
<a name="l00236"></a>00236                 total= <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d8/d4a/class_geometria2_d.html#3110085cc513f2de781885d52a35ea53" title="Retorna el numeo de puntos de la grilla.">Get_NumeroPuntosGrilla</a>();
<a name="l00237"></a>00237         }
<a name="l00238"></a>00238         
<a name="l00239"></a>00239         <span class="keywordflow">if</span>(size&gt;1)
<a name="l00240"></a>00240         {       
<a name="l00241"></a>00241         <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>=MPI_Wtime();
<a name="l00242"></a>00242         MPI_Bcast(&amp;total,1,MPI_UNSIGNED_LONG_LONG,0,MPI_COMM_WORLD);    
<a name="l00243"></a>00243     MPI_Bcast(&amp;Diferencial_Area,1,MPI_DOUBLE,0,MPI_COMM_WORLD);
<a name="l00244"></a>00244         <a class="code" href="../../d2/d56/class_f_e_m.html#9c8c01f9763ddc1a3fff6e76dbd69f30">Tiempo_Parcial_Comunicacion_Grilla</a>+=MPI_Wtime() - <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>;
<a name="l00245"></a>00245     }
<a name="l00246"></a>00246         
<a name="l00247"></a>00247         dimtmp = total/ (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> long) size;
<a name="l00248"></a>00248         DENSIDADES_GRILLA= <span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(total,<span class="stringliteral">"Densidades"</span>);
<a name="l00249"></a>00249         
<a name="l00250"></a>00250         <span class="keywordflow">if</span>(size&gt;1)
<a name="l00251"></a>00251         dGrilla=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#4e6580824d601592217111d82df4b363" title="Retorna la matriz que almacena las filas y columnas de las particiones.">Retorna_FC</a>()-&gt;<a class="code" href="../../df/d98/class_matriz___entera.html#355f39b8f446d466ea7329c150097c70" title="Retorna valor en fila, columna.">Retorna</a>(0,rank)*<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#4e6580824d601592217111d82df4b363" title="Retorna la matriz que almacena las filas y columnas de las particiones.">Retorna_FC</a>()-&gt;<a class="code" href="../../df/d98/class_matriz___entera.html#355f39b8f446d466ea7329c150097c70" title="Retorna valor en fila, columna.">Retorna</a>(1,rank),<span class="stringliteral">"GRILLA"</span>);   
<a name="l00252"></a>00252     <span class="keywordflow">else</span>
<a name="l00253"></a>00253     dGrilla=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(total,<span class="stringliteral">"GRILLA"</span>); 
<a name="l00254"></a>00254                 
<a name="l00255"></a>00255 
<a name="l00256"></a>00256         
<a name="l00257"></a>00257     <span class="keywordflow">if</span>(rank==0)
<a name="l00258"></a>00258         {
<a name="l00259"></a>00259      nElementos =  <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../df/d5d/class_geometria.html#cca22abfeb1e3fdb0499efd69c9aaec9" title="Retorna el numero de elementos.">Retorna_Numero_Elementos</a>();
<a name="l00260"></a>00260          nNodosTMP =  <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../df/d5d/class_geometria.html#8883f64fa3d61833004018ac8e28d774" title="Retorna el numero de nodos.">Retorna_Numero_Nodos</a>();
<a name="l00261"></a>00261         }
<a name="l00262"></a>00262         
<a name="l00263"></a>00263         <span class="keywordflow">if</span>(size&gt;1)
<a name="l00264"></a>00264         {       
<a name="l00265"></a>00265                                         <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>=MPI_Wtime();
<a name="l00266"></a>00266                                         MPI_Bcast(&amp;nElementos,1,MPI_UNSIGNED_LONG_LONG,0,MPI_COMM_WORLD);       
<a name="l00267"></a>00267                                         MPI_Bcast(&amp;nNodosTMP,1,MPI_UNSIGNED_LONG_LONG,0,MPI_COMM_WORLD);
<a name="l00268"></a>00268                                         <a class="code" href="../../d2/d56/class_f_e_m.html#9c8c01f9763ddc1a3fff6e76dbd69f30">Tiempo_Parcial_Comunicacion_Grilla</a>+=MPI_Wtime() - <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>;
<a name="l00269"></a>00269                                 
<a name="l00270"></a>00270                                 <span class="keywordflow">if</span>(rank!=0)
<a name="l00271"></a>00271                                 {
<a name="l00272"></a>00272                                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#80d8d85d80cd5535bcee9ee696688b74" title="Reserva memoria para la informacion de los en de x e y en los nodos de la FEM.">Reserva_Memoria_Nodos</a>(nNodosTMP);
<a name="l00273"></a>00273                                 }
<a name="l00274"></a>00274                         
<a name="l00275"></a>00275                                 
<a name="l00276"></a>00276                                 <span class="keywordflow">if</span>(rank==0)
<a name="l00277"></a>00277                                 {
<a name="l00278"></a>00278                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>=MPI_Wtime();
<a name="l00279"></a>00279                                                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;size;i++)         
<a name="l00280"></a>00280                                                 {
<a name="l00281"></a>00281                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#be4c57217dc8887079cf99fa1a61df47" title="Envia un mensaje que contiene un vector flotante.">Envio_Vector_Double</a>(i,14,0,nNodosTMP,<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#fdad1b5c4db193c1500b9b13ec1d3ddd" title="Retorna en un vector los valores de X de los nodos de la geometria original evaluada...">Retorna_NodosX</a>()-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>());
<a name="l00282"></a>00282                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#be4c57217dc8887079cf99fa1a61df47" title="Envia un mensaje que contiene un vector flotante.">Envio_Vector_Double</a>(i,13,0,nNodosTMP,<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#f589b70921673bd0708a9d9c003549e8" title="Retorna en un vector los valores de Y de los nodos de la geometria original evaluada...">Retorna_NodosY</a>()-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>());
<a name="l00283"></a>00283                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#be4c57217dc8887079cf99fa1a61df47" title="Envia un mensaje que contiene un vector flotante.">Envio_Vector_Double</a>(i,12,0,nElementos*17,<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#3f9f0e604e253dbed4005549d4a6f0ef" title="Retorna el vector de los datos que continenen toda la informacion del calculo FEM...">Retorna_Datos_Elementos_Vector</a>()-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>());
<a name="l00284"></a>00284                                                 }
<a name="l00285"></a>00285                                 
<a name="l00286"></a>00286                                 }
<a name="l00287"></a>00287                                 
<a name="l00288"></a>00288                                 <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#c2091f3c2aeb31739e024e351ccdb935" title="Recibe un vector de tipo double.">Recibe_Vector_Double</a>(0,14,nNodosTMP,<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#fdad1b5c4db193c1500b9b13ec1d3ddd" title="Retorna en un vector los valores de X de los nodos de la geometria original evaluada...">Retorna_NodosX</a>()-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),status);
<a name="l00289"></a>00289                                 <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#c2091f3c2aeb31739e024e351ccdb935" title="Recibe un vector de tipo double.">Recibe_Vector_Double</a>(0,13,nNodosTMP,<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#f589b70921673bd0708a9d9c003549e8" title="Retorna en un vector los valores de Y de los nodos de la geometria original evaluada...">Retorna_NodosY</a>()-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),status);
<a name="l00290"></a>00290                                 <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#c2091f3c2aeb31739e024e351ccdb935" title="Recibe un vector de tipo double.">Recibe_Vector_Double</a>(0,12,nElementos*17,<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#3f9f0e604e253dbed4005549d4a6f0ef" title="Retorna el vector de los datos que continenen toda la informacion del calculo FEM...">Retorna_Datos_Elementos_Vector</a>()-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),status);
<a name="l00291"></a>00291                                 <a class="code" href="../../d2/d56/class_f_e_m.html#9c8c01f9763ddc1a3fff6e76dbd69f30">Tiempo_Parcial_Comunicacion_Grilla</a>+=MPI_Wtime() - <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>;
<a name="l00292"></a>00292                                 
<a name="l00293"></a>00293                                 PerteneciaCentroides = <span class="keyword">new</span> <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a>(nNodosTMP);
<a name="l00294"></a>00294                                 
<a name="l00295"></a>00295                                 <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>=MPI_Wtime();
<a name="l00296"></a>00296                                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;size;i++)
<a name="l00297"></a>00297                                 {       
<a name="l00298"></a>00298                                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#be4c57217dc8887079cf99fa1a61df47" title="Envia un mensaje que contiene un vector flotante.">Envio_Vector_Double</a>(i,25,0,2,<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#8ad325adee4afb2006b9d52b3e492c17" title="Retorna en un vector los centroides de las particiones de la grilla en paralelo.">Retorna_Centroides</a>()-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>());
<a name="l00299"></a>00299                                 }
<a name="l00300"></a>00300                                 
<a name="l00301"></a>00301                                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;size;i++)
<a name="l00302"></a>00302                                 {       
<a name="l00303"></a>00303                                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#c2091f3c2aeb31739e024e351ccdb935" title="Recibe un vector de tipo double.">Recibe_Vector_Double</a>(i,25,2,DistanciaTmp-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),status);
<a name="l00304"></a>00304                                         DistanciasGenerales-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i*2,DistanciaTmp-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(0)); 
<a name="l00305"></a>00305                                         DistanciasGenerales-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i*2+1,DistanciaTmp-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(1)); 
<a name="l00306"></a>00306                                 }
<a name="l00307"></a>00307                                 
<a name="l00308"></a>00308                                 <a class="code" href="../../d2/d56/class_f_e_m.html#9c8c01f9763ddc1a3fff6e76dbd69f30">Tiempo_Parcial_Comunicacion_Grilla</a>+=MPI_Wtime() - <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>;
<a name="l00309"></a>00309                                 
<a name="l00310"></a>00310                                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i=0;i&lt;nNodosTMP;i++)
<a name="l00311"></a>00311                                 {               
<a name="l00312"></a>00312                                                         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0;j&lt;  (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> long) size;j++)
<a name="l00313"></a>00313                                                         {       
<a name="l00314"></a>00314                                                         x1=<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#fdad1b5c4db193c1500b9b13ec1d3ddd" title="Retorna en un vector los valores de X de los nodos de la geometria original evaluada...">Retorna_NodosX</a>()-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i);
<a name="l00315"></a>00315                                                         y1=<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#f589b70921673bd0708a9d9c003549e8" title="Retorna en un vector los valores de Y de los nodos de la geometria original evaluada...">Retorna_NodosY</a>()-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i);
<a name="l00316"></a>00316                                                         x2=DistanciasGenerales-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j*2);
<a name="l00317"></a>00317                                                         y2=DistanciasGenerales-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(j*2+1);         
<a name="l00318"></a>00318                                                         
<a name="l00319"></a>00319                                                         distancia_centroide = <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#3449dae027f66b0796d0dc3600a03c27" title="Retorna la distancia de dos puntos.">Distancia_Dos_Puntos</a>(x1,x2,y1,y2);
<a name="l00320"></a>00320                                                         
<a name="l00321"></a>00321                                                                 <span class="keywordflow">if</span>(j==0)
<a name="l00322"></a>00322                                                                 minimo = distancia_centroide;   
<a name="l00323"></a>00323                                                                         
<a name="l00324"></a>00324                                                                         <span class="keywordflow">if</span>(distancia_centroide &lt;= minimo)
<a name="l00325"></a>00325                                                                         {
<a name="l00326"></a>00326                                                                         minimo = distancia_centroide;
<a name="l00327"></a>00327                                                                         pMinimo = j;                                    
<a name="l00328"></a>00328                                                                         }       
<a name="l00329"></a>00329                                                    }
<a name="l00330"></a>00330                         
<a name="l00331"></a>00331                                 PerteneciaCentroides-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#3864383d67e707d428456afa29aa6711" title="Asigna un valor en posicion col.">Asigna</a>(i,pMinimo);                   
<a name="l00332"></a>00332                                                    
<a name="l00333"></a>00333                            }    
<a name="l00334"></a>00334 
<a name="l00335"></a>00335    <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#766c30e93320c1fd81de397f9e4f626f" title="Calcula densidades a partir de una grilla de puntos - Esta funcion es la utilizada...">Calcula_Densidades_Puntos_Grilla</a>(rank,PerteneciaCentroides,nElementos,dGrilla,<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#3f9f0e604e253dbed4005549d4a6f0ef" title="Retorna el vector de los datos que continenen toda la informacion del calculo FEM...">Retorna_Datos_Elementos_Vector</a>()-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#0552fe6c5c79bb8f9df63e9e94c56c92" title="Retorna en un vector los valores X de los puntos de la grilla.">Retorna_PuntosX</a>()-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#f77887144dbd091ffd16a0b741baf214" title="Retorna en un vector los valores Y de los puntos de la grilla.">Retorna_PuntosY</a>()-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#fdad1b5c4db193c1500b9b13ec1d3ddd" title="Retorna en un vector los valores de X de los nodos de la geometria original evaluada...">Retorna_NodosX</a>()-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),<a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#f589b70921673bd0708a9d9c003549e8" title="Retorna en un vector los valores de Y de los nodos de la geometria original evaluada...">Retorna_NodosY</a>()-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),Puntos_Dominio); 
<a name="l00336"></a>00336    MPI_Gather(Puntos_Dominio,1,MPI_UNSIGNED_LONG_LONG,Numero_Nodos_Dominio-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#4ffa02a33c82d9bdbd90313af305ea93" title="Retorna el puntero donde se almacena el vector.">Retorna_Puntero_Datos</a>(),1,MPI_UNSIGNED_LONG_LONG,0,MPI_COMM_WORLD);
<a name="l00337"></a>00337   
<a name="l00338"></a>00338         dimensiones[0]=dGrilla-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>();
<a name="l00339"></a>00339     <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>=MPI_Wtime();
<a name="l00340"></a>00340         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#0e4f48806ae96b733b4571c86ed760eb" title="Envia un mensaje que contiene un dato entero.">Envio_Dato_Entero</a>(0,19,dimensiones[0]);
<a name="l00341"></a>00341     <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#be4c57217dc8887079cf99fa1a61df47" title="Envia un mensaje que contiene un vector flotante.">Envio_Vector_Double</a>(0,20,0,dimensiones[0],dGrilla-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>());
<a name="l00342"></a>00342         <a class="code" href="../../d2/d56/class_f_e_m.html#9c8c01f9763ddc1a3fff6e76dbd69f30">Tiempo_Parcial_Comunicacion_Grilla</a>+=MPI_Wtime() - <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>;
<a name="l00343"></a>00343     
<a name="l00344"></a>00344    
<a name="l00345"></a>00345          <span class="keywordflow">if</span>(rank==0)
<a name="l00346"></a>00346          {      
<a name="l00347"></a>00347                  fGlobal = <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d8/d4a/class_geometria2_d.html#07fbf4dd4cde2819e99d13d827c85cf4" title="Retorna la resolucion en X.">Get_ResolucionX</a>();
<a name="l00348"></a>00348                  cGlobal = <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d8/d4a/class_geometria2_d.html#9ad4a0cb67f8dcda028fb1a04617d9cc" title="Retorna la solucion en Y.">Get_ResolucionY</a>();
<a name="l00349"></a>00349 
<a name="l00350"></a>00350                  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;size;i++)
<a name="l00351"></a>00351                  {
<a name="l00352"></a>00352              <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>=MPI_Wtime();
<a name="l00353"></a>00353                  <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#75f07d2a047ad643fcf2f3c1acf5604d" title="Recibe un mensaje que contiene un dato entero.">Recibe_Dato_Entero</a>(i,19,dimensiones_llegada);
<a name="l00354"></a>00354                          Densidad_FEM_TMP = <span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(dimensiones_llegada[0]);
<a name="l00355"></a>00355                          <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#c2091f3c2aeb31739e024e351ccdb935" title="Recibe un vector de tipo double.">Recibe_Vector_Double</a>(i,20,dimensiones_llegada[0],Densidad_FEM_TMP-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),status);
<a name="l00356"></a>00356                  <a class="code" href="../../d2/d56/class_f_e_m.html#9c8c01f9763ddc1a3fff6e76dbd69f30">Tiempo_Parcial_Comunicacion_Grilla</a>+=MPI_Wtime() - <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>;
<a name="l00357"></a>00357                                          
<a name="l00358"></a>00358                          fLocal = <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#4e6580824d601592217111d82df4b363" title="Retorna la matriz que almacena las filas y columnas de las particiones.">Retorna_FC</a>()-&gt;<a class="code" href="../../df/d98/class_matriz___entera.html#355f39b8f446d466ea7329c150097c70" title="Retorna valor en fila, columna.">Retorna</a>(0,i);
<a name="l00359"></a>00359                          cLocal = <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#4e6580824d601592217111d82df4b363" title="Retorna la matriz que almacena las filas y columnas de las particiones.">Retorna_FC</a>()-&gt;<a class="code" href="../../df/d98/class_matriz___entera.html#355f39b8f446d466ea7329c150097c70" title="Retorna valor en fila, columna.">Retorna</a>(1,i);  
<a name="l00360"></a>00360                          bFila = <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#b344e56914941dca80c0434a1360e13a" title="Retorna la matriz con los indices de rank de la matriz de particion fila columna...">Retorna_MP</a>()-&gt;<a class="code" href="../../df/d98/class_matriz___entera.html#355f39b8f446d466ea7329c150097c70" title="Retorna valor en fila, columna.">Retorna</a>(0,i);
<a name="l00361"></a>00361                          bColumna = <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#b344e56914941dca80c0434a1360e13a" title="Retorna la matriz con los indices de rank de la matriz de particion fila columna...">Retorna_MP</a>()-&gt;<a class="code" href="../../df/d98/class_matriz___entera.html#355f39b8f446d466ea7329c150097c70" title="Retorna valor en fila, columna.">Retorna</a>(1,i);                        
<a name="l00362"></a>00362                  
<a name="l00363"></a>00363                          contador =0;                    
<a name="l00364"></a>00364                          desplazamiento=0;                       
<a name="l00365"></a>00365         
<a name="l00366"></a>00366                                          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i=0;i&lt;fLocal ;i++)
<a name="l00367"></a>00367                                          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> j=0;j&lt;cLocal ;j++)       
<a name="l00368"></a>00368                                          {
<a name="l00369"></a>00369                                                  desplazamiento =  (i   +    <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#4e6580824d601592217111d82df4b363" title="Retorna la matriz que almacena las filas y columnas de las particiones.">Retorna_FC</a>()-&gt;<a class="code" href="../../df/d98/class_matriz___entera.html#355f39b8f446d466ea7329c150097c70" title="Retorna valor en fila, columna.">Retorna</a>(0,0)*bFila   )*(fGlobal  )  +  j  +  <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#4e6580824d601592217111d82df4b363" title="Retorna la matriz que almacena las filas y columnas de las particiones.">Retorna_FC</a>()-&gt;<a class="code" href="../../df/d98/class_matriz___entera.html#355f39b8f446d466ea7329c150097c70" title="Retorna valor en fila, columna.">Retorna</a>(1,0)*bColumna;
<a name="l00370"></a>00370                                                  DENSIDADES_GRILLA-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(desplazamiento, Densidad_FEM_TMP-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(contador) );
<a name="l00371"></a>00371                                                  contador++;     
<a name="l00372"></a>00372                                          }
<a name="l00373"></a>00373         
<a name="l00374"></a>00374                    }
<a name="l00375"></a>00375                                         
<a name="l00376"></a>00376      }
<a name="l00377"></a>00377         
<a name="l00378"></a>00378         <span class="keywordflow">if</span>(rank==0)
<a name="l00379"></a>00379     <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>=MPI_Wtime();
<a name="l00380"></a>00380         
<a name="l00381"></a>00381     Puntos_Dominio[0]=Numero_Nodos_Dominio-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#8a95c5b9a1588e219dc5cf816fed33b6" title="Sumatoria de datos del vector.">Sumatoria_Vector</a>();
<a name="l00382"></a>00382     }
<a name="l00383"></a>00383      <span class="keywordflow">else</span>
<a name="l00384"></a>00384          {
<a name="l00385"></a>00385                  <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#45462cd55c487b9c07778d3e5fa0e019" title="Calcula las densidades de una serie de puntos definidos en una grilla - Este proceso...">Calcula_Densidades_Puntos</a>(DENSIDADES_GRILLA,Puntos_Dominio);
<a name="l00386"></a>00386                  
<a name="l00387"></a>00387          }       
<a name="l00388"></a>00388 
<a name="l00389"></a>00389         
<a name="l00390"></a>00390         <span class="keywordflow">if</span>(size&gt;1) 
<a name="l00391"></a>00391         MPI_Barrier(MPI_COMM_WORLD);
<a name="l00392"></a>00392    
<a name="l00393"></a>00393     <span class="keywordflow">if</span>(rank==0)
<a name="l00394"></a>00394         {
<a name="l00395"></a>00395                 
<a name="l00396"></a>00396         <span class="keywordflow">if</span>(size&gt;1)
<a name="l00397"></a>00397         {       
<a name="l00398"></a>00398     <a class="code" href="../../d2/d56/class_f_e_m.html#9c8c01f9763ddc1a3fff6e76dbd69f30">Tiempo_Parcial_Comunicacion_Grilla</a>+=MPI_Wtime() - <a class="code" href="../../d2/d56/class_f_e_m.html#736bdc367506b5282fe4dec586421bd9" title="Tiempos parciales comunicacion grilla.">Tiempo_Inicial_Comunicacion_Grilla</a>;
<a name="l00399"></a>00399     printf(<span class="stringliteral">"\n Tiempo en comunicacion en grilla es: %f \n"</span>,<a class="code" href="../../d2/d56/class_f_e_m.html#9c8c01f9763ddc1a3fff6e76dbd69f30">Tiempo_Parcial_Comunicacion_Grilla</a>);
<a name="l00400"></a>00400         <a class="code" href="../../d2/d56/class_f_e_m.html#003bd70b0e5d985e6021cc3d42901d3c" title="Tiempo total utilizado en comunicacion.">tTotalComunicacion</a>+=<a class="code" href="../../d2/d56/class_f_e_m.html#9c8c01f9763ddc1a3fff6e76dbd69f30">Tiempo_Parcial_Comunicacion_Grilla</a>; 
<a name="l00401"></a>00401         <a class="code" href="../../d2/d56/class_f_e_m.html#00250a3c31dcac6d8b7f4098a34b64e4">tTotalComunicacionGrilla</a>=<a class="code" href="../../d2/d56/class_f_e_m.html#9c8c01f9763ddc1a3fff6e76dbd69f30">Tiempo_Parcial_Comunicacion_Grilla</a>;    
<a name="l00402"></a>00402         }
<a name="l00403"></a>00403         
<a name="l00404"></a>00404                 <span class="keywordtype">double</span> Densidad_Total_Tmp =0.0;
<a name="l00405"></a>00405                 <span class="keywordtype">double</span> dNodal,escala;
<a name="l00406"></a>00406                 escala = (double) (nNodosTMP) /  Puntos_Dominio[0];
<a name="l00407"></a>00407             <span class="keywordtype">double</span> Unidad_Area = <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#9fca41c0e41e33905b893c8d444ebe05" title="Retorna el area del dominio global.">Area_Global</a>()  /  Puntos_Dominio[0];
<a name="l00408"></a>00408                 printf(<span class="stringliteral">"\nDiferencial de Area: %f  Nodos Origen = %Ld... Suma nodos internos =%Ld\n"</span>,Diferencial_Area, nNodosTMP,Puntos_Dominio[0]);
<a name="l00409"></a>00409             printf(<span class="stringliteral">"\n Area dominio: %f. Unidad de Area por nodo es de (%f) mm^2 ..suma = %Ld\n"</span>, <a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#9fca41c0e41e33905b893c8d444ebe05" title="Retorna el area del dominio global.">Area_Global</a>()  , Unidad_Area, Puntos_Dominio[0]);
<a name="l00410"></a>00410         
<a name="l00411"></a>00411                 <a class="code" href="../../d2/dee/class_archivo.html" title="Clase para manipular archivos.">Archivo</a> *Grilla=<span class="keyword">new</span> <a class="code" href="../../d2/dee/class_archivo.html" title="Clase para manipular archivos.">Archivo</a>();
<a name="l00412"></a>00412                 Grilla-&gt;SetNombre(<a class="code" href="../../d2/d56/class_f_e_m.html#2c03efd0f44fa03bc0b00171bd63bdc8" title="Retorna el nombre del archivo solucion.">GetNombreArchivoGrilla</a>());
<a name="l00413"></a>00413                 Grilla-&gt;SetModo(<a class="code" href="../../de/dc7/_archivo_8hpp.html#406416501f9b8dd55765eb0686ced406">GRABA_ARCHIVO</a>); 
<a name="l00414"></a>00414                 Grilla-&gt;Abrir();
<a name="l00415"></a>00415         
<a name="l00416"></a>00416                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>  i=0;i&lt;DENSIDADES_GRILLA-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>();i++)
<a name="l00417"></a>00417                 {
<a name="l00418"></a>00418                         dNodal=DENSIDADES_GRILLA-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i);<span class="comment">//*escala;</span>
<a name="l00419"></a>00419                         Densidad_Total_Tmp+=dNodal;
<a name="l00420"></a>00420                         fprintf(Grilla-&gt;GetArchivo(), <span class="stringliteral">"%f\n"</span> ,dNodal);
<a name="l00421"></a>00421 
<a name="l00422"></a>00422                 }
<a name="l00423"></a>00423                         Grilla-&gt;Cerrar();
<a name="l00424"></a>00424         
<a name="l00425"></a>00425                 
<a name="l00426"></a>00426                 printf(<span class="stringliteral">"\nEl numero estimado de fotones en el dominio es de: %f...\n"</span>,Densidad_Total_Tmp);      
<a name="l00427"></a>00427         }
<a name="l00428"></a>00428 
<a name="l00429"></a>00429         
<a name="l00430"></a>00430 }
<a name="l00431"></a>00431 
<a name="l00432"></a>00432 
<a name="l00434"></a><a class="code" href="../../d2/d56/class_f_e_m.html#826fb0f16335d5896d17a3a7abab46aa">00434</a>  <span class="keywordtype">void</span> <a class="code" href="../../d2/d56/class_f_e_m.html#826fb0f16335d5896d17a3a7abab46aa" title="Establece el tipo de tratamiento numerico con el cula se trabaja en la resolucion...">FEM::Establecer_Condicion_Matricial_FEM</a>(<span class="keywordtype">int</span> condicion,<span class="keywordtype">int</span> metodo)
<a name="l00435"></a>00435 {
<a name="l00436"></a>00436         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>  indice,ubicacion,DimOriginal,DimFrontera,DimensionNueva,DimReducida;
<a name="l00437"></a>00437         DimOriginal=<a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>();
<a name="l00438"></a>00438         <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *Tmp = <span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(DimOriginal);
<a name="l00439"></a>00439         <a class="code" href="../../d2/d56/class_f_e_m.html#7a93d852ba25aeab4520c01039dd838c" title="Asigna el orden nodal global.">Set_orden_nodal</a>(DimOriginal);
<a name="l00440"></a>00440         <a class="code" href="../../d2/d56/class_f_e_m.html#a54e99007f176cf30247eed914c88d4d" title="Asigna el tipo de solucion matricial.">Set_tipo_solucion_matricial</a>(condicion);
<a name="l00441"></a>00441         
<a name="l00442"></a>00442         <span class="keywordflow">if</span>(condicion==0)
<a name="l00443"></a>00443         {
<a name="l00444"></a>00444                 printf(<span class="stringliteral">"Como no definio que condicion de borde quiere utilizar el programa no continuara su ejecucion...\n"</span>);
<a name="l00445"></a>00445                 exit(1);
<a name="l00446"></a>00446         }
<a name="l00447"></a>00447         
<a name="l00448"></a>00448         <span class="keywordflow">if</span>(condicion==1)
<a name="l00449"></a>00449         {
<a name="l00450"></a>00450                 
<a name="l00451"></a>00451                 <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#b5ce5f903912eeecc39af1328b7bef9c" title="Asigna el numeros de incognitas del sistema.">Set_nDesconocido</a>(DimOriginal);
<a name="l00452"></a>00452                 printf(<span class="stringliteral">"Se trabajara con la dimension original en el sistema de ecuaciones\n"</span>);
<a name="l00453"></a>00453         }
<a name="l00454"></a>00454         
<a name="l00455"></a>00455         <span class="keywordflow">if</span>(condicion==2) 
<a name="l00456"></a>00456         {
<a name="l00457"></a>00457                 printf(<span class="stringliteral">"Se trabajara con una dimension menor en el sistema de ecuaciones\n"</span>);
<a name="l00458"></a>00458                 DimFrontera=<a class="code" href="../../d2/d56/class_f_e_m.html#dc741809ba703314c6a34b101d15e1dd" title="Retorna la geometria de trabajo.">Get_Geometria2D_Triangulos</a>()-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#3754768563f41be81597f9a3dc5ae03e" title="Retorna el numero global de nodos en la frontera.">Get_Numero_Nodos_Frontera_Dominio_Global</a>();
<a name="l00459"></a>00459                 DimensionNueva=DimOriginal-DimFrontera;
<a name="l00460"></a>00460                 <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#b5ce5f903912eeecc39af1328b7bef9c" title="Asigna el numeros de incognitas del sistema.">Set_nDesconocido</a>(DimensionNueva);
<a name="l00461"></a>00461                 DimReducida = DimOriginal - DimFrontera;
<a name="l00462"></a>00462             
<a name="l00463"></a>00463                 <span class="keywordflow">if</span>(metodo == <a class="code" href="../../d7/dd9/_f_e_m_8hpp.html#e9a4b9f216f53ca47b8fc35199502aae" title="Metodo LSQR para matrices Dispersas.">LSQR_DISPERSO</a>)
<a name="l00464"></a>00464                 {       
<a name="l00465"></a>00465                                                 std::map&lt;unsigned long long  ,unsigned long   long&gt;::iterator posicion;
<a name="l00466"></a>00466                                                 std::map&lt;unsigned long long  ,double&gt;::iterator indice_nuevo;
<a name="l00467"></a>00467                                                 map&lt;unsigned long   long,unsigned long   long&gt; Nuevos_Indices; 
<a name="l00468"></a>00468                                                 map&lt;unsigned long   long,unsigned long   long&gt; Nuevos_Indices_Fila; 
<a name="l00469"></a>00469                                                 map&lt;unsigned long  long ,unsigned long   long&gt; Nuevos_Indices_Columna;  
<a name="l00470"></a>00470                                         
<a name="l00471"></a>00471                                                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>   cont = 0;cont&lt;DimOriginal;cont++)
<a name="l00472"></a>00472                                                 {
<a name="l00473"></a>00473                                                         <a class="code" href="../../d2/d56/class_f_e_m.html#db79d961bf050b4fba592e8764ac8121" title="Mapeo de los indice para aproximacion de borde tipo Dirichlet.">Mapeo_FEM_Dirichlet</a>[cont]=cont;
<a name="l00474"></a>00474                                                 }
<a name="l00475"></a>00475                                                                           
<a name="l00476"></a>00476                                                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>   cont = 0;cont&lt;DimFrontera;cont++)
<a name="l00477"></a>00477                                                 {
<a name="l00478"></a>00478                                                         <a class="code" href="../../d2/d56/class_f_e_m.html#db79d961bf050b4fba592e8764ac8121" title="Mapeo de los indice para aproximacion de borde tipo Dirichlet.">Mapeo_FEM_Dirichlet</a>.erase(<a class="code" href="../../d2/d56/class_f_e_m.html#dc741809ba703314c6a34b101d15e1dd" title="Retorna la geometria de trabajo.">Get_Geometria2D_Triangulos</a>()-&gt;Get_Nodos_Frontera_Geometria()-&gt;Retorna(cont));
<a name="l00479"></a>00479                                                 }
<a name="l00480"></a>00480                                                 
<a name="l00481"></a>00481                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#548bf4d3142df8532124c79cc6a9cb4d" title="Copia el vector a otro vector a.">Copia</a>(Tmp);
<a name="l00482"></a>00482                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#7d950d556a8b23c43502037b4e25a0e9" title="Libera memoria.">Libera_Memoria</a>();
<a name="l00483"></a>00483                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#91c0508e962ed5ed8d5014c46beea316" title="Solicita la memoria para el vector.">Solicita_Memoria</a>(DimReducida,0.0);
<a name="l00484"></a>00484                                                 indice=0;
<a name="l00485"></a>00485                                 
<a name="l00486"></a>00486                                                 <span class="keywordflow">for</span>(posicion = <a class="code" href="../../d2/d56/class_f_e_m.html#db79d961bf050b4fba592e8764ac8121" title="Mapeo de los indice para aproximacion de borde tipo Dirichlet.">Mapeo_FEM_Dirichlet</a>.begin(); posicion != <a class="code" href="../../d2/d56/class_f_e_m.html#db79d961bf050b4fba592e8764ac8121" title="Mapeo de los indice para aproximacion de borde tipo Dirichlet.">Mapeo_FEM_Dirichlet</a>.end();)
<a name="l00487"></a>00487                                                 {
<a name="l00488"></a>00488                                                         <a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(indice,Tmp-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(  posicion-&gt;second ) );
<a name="l00489"></a>00489                                                         Nuevos_Indices[posicion-&gt;second]=indice;
<a name="l00490"></a>00490                                                         ++posicion;
<a name="l00491"></a>00491                                                         indice++;
<a name="l00492"></a>00492                                                 }
<a name="l00493"></a>00493                                                 
<a name="l00494"></a>00494                                                 indice=0;
<a name="l00495"></a>00495                                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> tmp;
<a name="l00497"></a>00497                                                 <span class="keywordflow">for</span> (posicion = <a class="code" href="../../d2/d56/class_f_e_m.html#dbb7f40ddaf723d16d761af50fdcd404" title="Mapeo de la informacion de las filas con elementos no nulos.">Mapeo_FEM_Fila</a>.begin(); posicion != <a class="code" href="../../d2/d56/class_f_e_m.html#dbb7f40ddaf723d16d761af50fdcd404" title="Mapeo de la informacion de las filas con elementos no nulos.">Mapeo_FEM_Fila</a>.end();) <span class="comment">// recorre el mapeo de las filas</span>
<a name="l00498"></a>00498                                                 {
<a name="l00499"></a>00499                                                         ubicacion =  posicion-&gt;second;  
<a name="l00500"></a>00500                                                                 <span class="keywordflow">if</span>(<a class="code" href="../../d2/d56/class_f_e_m.html#db79d961bf050b4fba592e8764ac8121" title="Mapeo de los indice para aproximacion de borde tipo Dirichlet.">Mapeo_FEM_Dirichlet</a>[ubicacion])
<a name="l00501"></a>00501                                                                 {
<a name="l00502"></a>00502                                                                  tmp =  Nuevos_Indices[ubicacion];
<a name="l00503"></a>00503                                                                  <a class="code" href="../../d2/d56/class_f_e_m.html#dbb7f40ddaf723d16d761af50fdcd404" title="Mapeo de la informacion de las filas con elementos no nulos.">Mapeo_FEM_Fila</a>[posicion-&gt;first]=tmp;                                                       
<a name="l00504"></a>00504                                                                 ++posicion;
<a name="l00505"></a>00505                                                                 }
<a name="l00506"></a>00506                                                                 <span class="keywordflow">else</span>
<a name="l00507"></a>00507                                                                 {       
<a name="l00508"></a>00508                                                                         ubicacion = posicion-&gt;first;
<a name="l00509"></a>00509                                                                         <a class="code" href="../../d2/d56/class_f_e_m.html#5f1a17e5278ad53cf865557f540a2cc3" title="Mapeo de la informacion de las columnas con elementos no nulos.">Mapeo_FEM_Columna</a>.erase(ubicacion);                                                        
<a name="l00510"></a>00510                                                                         <a class="code" href="../../d2/d56/class_f_e_m.html#619e87c85e7a72761943a4b9ea4fcd37">Matriz_A_FEM</a>.erase(ubicacion);                                                              
<a name="l00511"></a>00511                                                                         <a class="code" href="../../d2/d56/class_f_e_m.html#dbb7f40ddaf723d16d761af50fdcd404" title="Mapeo de la informacion de las filas con elementos no nulos.">Mapeo_FEM_Fila</a>.erase(posicion++); 
<a name="l00512"></a>00512                                                                 }
<a name="l00513"></a>00513                                                                 indice++;
<a name="l00514"></a>00514                                                 }               
<a name="l00515"></a>00515                                 
<a name="l00516"></a>00516                                                 indice =0;
<a name="l00517"></a>00517                                                 <span class="keywordflow">for</span> (posicion = <a class="code" href="../../d2/d56/class_f_e_m.html#5f1a17e5278ad53cf865557f540a2cc3" title="Mapeo de la informacion de las columnas con elementos no nulos.">Mapeo_FEM_Columna</a>.begin(); posicion != <a class="code" href="../../d2/d56/class_f_e_m.html#5f1a17e5278ad53cf865557f540a2cc3" title="Mapeo de la informacion de las columnas con elementos no nulos.">Mapeo_FEM_Columna</a>.end();) <span class="comment">// recorre el mapeo de las columnas</span>
<a name="l00518"></a>00518                                                 {
<a name="l00519"></a>00519                                                         ubicacion =  posicion-&gt;second;  
<a name="l00520"></a>00520                                 
<a name="l00521"></a>00521                                                         <span class="keywordflow">if</span>(<a class="code" href="../../d2/d56/class_f_e_m.html#db79d961bf050b4fba592e8764ac8121" title="Mapeo de los indice para aproximacion de borde tipo Dirichlet.">Mapeo_FEM_Dirichlet</a>[ubicacion])
<a name="l00522"></a>00522                                                         {
<a name="l00523"></a>00523                                                                 
<a name="l00524"></a>00524                                                                  tmp =  Nuevos_Indices[ubicacion];
<a name="l00525"></a>00525                                                                  <a class="code" href="../../d2/d56/class_f_e_m.html#5f1a17e5278ad53cf865557f540a2cc3" title="Mapeo de la informacion de las columnas con elementos no nulos.">Mapeo_FEM_Columna</a>[posicion-&gt;first]=tmp;                                              
<a name="l00526"></a>00526                                                                 ++posicion;
<a name="l00527"></a>00527                                                         }
<a name="l00528"></a>00528                                                                 <span class="keywordflow">else</span>
<a name="l00529"></a>00529                                                                 {       
<a name="l00530"></a>00530                                                                 ubicacion = posicion-&gt;first;    
<a name="l00531"></a>00531                                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#dbb7f40ddaf723d16d761af50fdcd404" title="Mapeo de la informacion de las filas con elementos no nulos.">Mapeo_FEM_Fila</a>.erase(ubicacion);                                                        
<a name="l00532"></a>00532                                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#619e87c85e7a72761943a4b9ea4fcd37">Matriz_A_FEM</a>.erase(ubicacion);                                                            
<a name="l00533"></a>00533                                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#5f1a17e5278ad53cf865557f540a2cc3" title="Mapeo de la informacion de las columnas con elementos no nulos.">Mapeo_FEM_Columna</a>.erase(posicion++);   
<a name="l00534"></a>00534                                                                 }
<a name="l00535"></a>00535                                                                 indice++;
<a name="l00536"></a>00536                                                 }               
<a name="l00537"></a>00537                                                 
<a name="l00538"></a>00538            }
<a name="l00539"></a>00539                    <span class="keywordflow">else</span>
<a name="l00540"></a>00540                    {
<a name="l00541"></a>00541                                    <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#f87671a678c8abf8ce4c22fe7f5c0ae4" title="Redimensiona un sistema de ecuaciones representados matricialmente, indicando que...">Redimensionar_Sistema</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#d8972f193f24ec53b73316080fa95e63" title="Matriz de riguidez completa del sistema ( Matriz stiffness (Fisico-geometria) + Matriz...">A</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#dc741809ba703314c6a34b101d15e1dd" title="Retorna la geometria de trabajo.">Get_Geometria2D_Triangulos</a>()-&gt;Get_Nodos_Frontera_Geometria(),DimFrontera);        
<a name="l00542"></a>00542            }
<a name="l00543"></a>00543                 
<a name="l00544"></a>00544 
<a name="l00545"></a>00545                 
<a name="l00546"></a>00546                 }
<a name="l00547"></a>00547 }
<a name="l00548"></a>00548 
<a name="l00550"></a><a class="code" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d">00550</a> <span class="keywordtype">void</span> <a class="code" href="../../d2/d56/class_f_e_m.html#7af0f0176badaa510abdc09c28588c8d" title="Resolucion del sistema de ecuaciones.">FEM::Resolver_Sistema_FEM</a>(<span class="keywordtype">int</span> metodo,<span class="keywordtype">int</span> traza, <span class="keywordtype">unsigned</span>  <span class="keywordtype">long</span> <span class="keywordtype">long</span> iteraciones,<span class="keywordtype">int</span> Tipo_Parada)
<a name="l00551"></a>00551   {
<a name="l00552"></a>00552          <span class="keywordtype">double</span> finFactorizacion,iniT,finT,iniTiempo;  
<a name="l00553"></a>00553          <span class="keywordtype">int</span> size,rank,i;
<a name="l00554"></a>00554      <span class="keywordtype">int</span> verificacion_dDominante;
<a name="l00555"></a>00555          MPI_Status status;     
<a name="l00556"></a>00556      MPI_Comm_rank(MPI_COMM_WORLD,&amp;rank);       
<a name="l00557"></a>00557          MPI_Comm_size(MPI_COMM_WORLD, &amp;size);
<a name="l00558"></a>00558      <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>=<span class="keyword">new</span> <a class="code" href="../../d9/daf/class_rutinas___paralelas.html" title="Clase para trabajar con rutinas paralelas en almacenamiento y calculos.">Rutinas_Paralelas</a>(); 
<a name="l00559"></a>00559          <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#ac8deab6e27e5277162801d72e3d7812" title="Asigna numero de iteraciones.">Set_Traza</a>(traza); 
<a name="l00560"></a>00560          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  <span class="keywordtype">long</span> Incognitas=<a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#f53f35c21a9f23b8c5318b49cfda1c2b" title="Retorna el numero de incognitas desconocidas.">Get_nDesconocido</a>();
<a name="l00561"></a>00561          <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#4e568aca0fcd8fa87af7b5099005ce5b" title="Asigna numero de procesos - procesadores.">Set_Iteraciones</a>(iteraciones);
<a name="l00562"></a>00562         
<a name="l00563"></a>00563          <a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(Incognitas,<span class="stringliteral">"Vector densidades X"</span>);
<a name="l00564"></a>00564          <span class="keywordflow">if</span>(rank==0) 
<a name="l00565"></a>00565          {       
<a name="l00566"></a>00566             
<a name="l00567"></a>00567                   iniTiempo=MPI_Wtime();
<a name="l00568"></a>00568       }
<a name="l00569"></a>00569 
<a name="l00570"></a>00570    <span class="keywordflow">if</span>(metodo == <a class="code" href="../../d7/dd9/_f_e_m_8hpp.html#757914ed6297a006d7fd30933340d009" title="Metodo Jacobi.">JACOBI</a>)   
<a name="l00571"></a>00571    {
<a name="l00572"></a>00572            
<a name="l00573"></a>00573            <span class="keywordflow">if</span>(size==1)
<a name="l00574"></a>00574            {   
<a name="l00575"></a>00575            verificacion_dDominante=<a class="code" href="../../d2/d56/class_f_e_m.html#d8972f193f24ec53b73316080fa95e63" title="Matriz de riguidez completa del sistema ( Matriz stiffness (Fisico-geometria) + Matriz...">A</a>-&gt;<a class="code" href="../../d4/d09/class_matriz.html#ffafab976746c41efbc9b42ab0a2ce21" title="Verifica si es estrictamente dominante la matriz.">Dominante</a>(); 
<a name="l00576"></a>00576        <span class="keywordflow">if</span>(verificacion_dDominante == 1)           
<a name="l00577"></a>00577            {
<a name="l00578"></a>00578                   printf(<span class="stringliteral">"Matriz Diagonalmente dominate...\n"</span>);
<a name="l00579"></a>00579 
<a name="l00580"></a>00580                    <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#f9c6e4765b533131244361805898a91a" title="Resuelve Ax=b usando el metodo Jacobi.">Resuelve_Jacobi</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#d8972f193f24ec53b73316080fa95e63" title="Matriz de riguidez completa del sistema ( Matriz stiffness (Fisico-geometria) + Matriz...">A</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>,0.00001,Tipo_Parada,<a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#7e2686b397eef1be4a918ac8c23d24ad" title="Asigna numero de iteraciones.">Get_Traza</a>());  <span class="comment">// 1 iter 0 tol</span>
<a name="l00581"></a>00581            }
<a name="l00582"></a>00582            <span class="keywordflow">else</span>
<a name="l00583"></a>00583            {
<a name="l00584"></a>00584                    printf(<span class="stringliteral">"Debe utilizar otro metodo para este tipo de Matriz\n"</span>);
<a name="l00585"></a>00585               
<a name="l00586"></a>00586                 }          
<a name="l00587"></a>00587                    finT=MPI_Wtime();
<a name="l00588"></a>00588            printf(<span class="stringliteral">"El tiempo usado para resolver mediante Jacobi fue de %f segundos\n"</span>,finT-iniTiempo);
<a name="l00589"></a>00589            printf(<span class="stringliteral">"-- Fin resolver sistema--- \n"</span>);
<a name="l00590"></a>00590            }
<a name="l00591"></a>00591            <span class="keywordflow">else</span> 
<a name="l00592"></a>00592            {
<a name="l00593"></a>00593                    printf(<span class="stringliteral">"ESTE METODO NO ESTA PARA CALCULO PARALELO\n"</span>);
<a name="l00594"></a>00594                    MPI_Finalize();      
<a name="l00595"></a>00595                    exit(1);
<a name="l00596"></a>00596            }
<a name="l00597"></a>00597            
<a name="l00598"></a>00598   }
<a name="l00599"></a>00599      <span class="keywordflow">if</span>(metodo == <a class="code" href="../../d7/dd9/_f_e_m_8hpp.html#0e7d8b9aebb81d2f67cf0d180d9b7cb4" title="Metodo Gauss - Seidel.">GAUSS_SEIDEL</a>)   
<a name="l00600"></a>00600    {
<a name="l00601"></a>00601            
<a name="l00602"></a>00602            <span class="keywordflow">if</span>(size==1)
<a name="l00603"></a>00603            {   
<a name="l00604"></a>00604            verificacion_dDominante=<a class="code" href="../../d2/d56/class_f_e_m.html#d8972f193f24ec53b73316080fa95e63" title="Matriz de riguidez completa del sistema ( Matriz stiffness (Fisico-geometria) + Matriz...">A</a>-&gt;<a class="code" href="../../d4/d09/class_matriz.html#ffafab976746c41efbc9b42ab0a2ce21" title="Verifica si es estrictamente dominante la matriz.">Dominante</a>(); 
<a name="l00605"></a>00605        <span class="keywordflow">if</span>(verificacion_dDominante == 1)           
<a name="l00606"></a>00606            {
<a name="l00607"></a>00607                   printf(<span class="stringliteral">"Matriz Diagonalmente dominate...\n"</span>);
<a name="l00608"></a>00608                    <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#62051f00d59e3aa833a0d5fc4d2953ab" title="Resuelve Ax=b usando el metodo Gauss Seidel.">Resuelve_Gauss_Seidel</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#d8972f193f24ec53b73316080fa95e63" title="Matriz de riguidez completa del sistema ( Matriz stiffness (Fisico-geometria) + Matriz...">A</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>, 0.00001,Tipo_Parada,<a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#7e2686b397eef1be4a918ac8c23d24ad" title="Asigna numero de iteraciones.">Get_Traza</a>()); 
<a name="l00609"></a>00609        }
<a name="l00610"></a>00610            <span class="keywordflow">else</span>
<a name="l00611"></a>00611            {
<a name="l00612"></a>00612                    printf(<span class="stringliteral">"Debe utilizar otro metodo para este tipo de Matriz\n"</span>);
<a name="l00613"></a>00613               
<a name="l00614"></a>00614                 }            
<a name="l00615"></a>00615                    finT=MPI_Wtime();
<a name="l00616"></a>00616            printf(<span class="stringliteral">"El tiempo usado para resolver mediante Gauss - Seidel fue de %f segundos\n"</span>,finT-iniTiempo);
<a name="l00617"></a>00617            printf(<span class="stringliteral">"-- Fin resolver sistema--- \n"</span>);
<a name="l00618"></a>00618            }
<a name="l00619"></a>00619            <span class="keywordflow">else</span> 
<a name="l00620"></a>00620            {
<a name="l00621"></a>00621                    printf(<span class="stringliteral">"ESTE METODO NO ESTA PARA CALCULO PARALELO\n"</span>);
<a name="l00622"></a>00622                    exit(1);
<a name="l00623"></a>00623            }
<a name="l00624"></a>00624            
<a name="l00625"></a>00625   }
<a name="l00626"></a>00626    <span class="keywordflow">if</span>(metodo == <a class="code" href="../../d7/dd9/_f_e_m_8hpp.html#0782ae8e6eca56b1f8cd2b62a64bb4d8" title="Metodo Factorizacion LU.">LU</a>)
<a name="l00627"></a>00627    {
<a name="l00628"></a>00628            
<a name="l00629"></a>00629             <span class="keywordflow">if</span>(size==1)
<a name="l00630"></a>00630            {   
<a name="l00631"></a>00631            <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#26bfadb6eb48dad7204072cc0cb06d00" title="Factoriza la matriz A en L y U dejandolas en la misma matriz.">Factoriza_LU</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#d8972f193f24ec53b73316080fa95e63" title="Matriz de riguidez completa del sistema ( Matriz stiffness (Fisico-geometria) + Matriz...">A</a>);
<a name="l00632"></a>00632            finFactorizacion=MPI_Wtime();
<a name="l00633"></a>00633            iniT=MPI_Wtime();
<a name="l00634"></a>00634            <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#5b4cee95d591129db28aa76341a0d646" title="Resuelve el sistema Ax=LUx = b.">Solve_LU</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#d8972f193f24ec53b73316080fa95e63" title="Matriz de riguidez completa del sistema ( Matriz stiffness (Fisico-geometria) + Matriz...">A</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>);   
<a name="l00635"></a>00635            finT=MPI_Wtime();
<a name="l00636"></a>00636            printf(<span class="stringliteral">"El tiempo LU fue %f segundos\n"</span>,finFactorizacion-iniTiempo);
<a name="l00637"></a>00637            printf(<span class="stringliteral">"El tiempo Resover  LU fue %f segundos\n"</span>,finT-iniT);
<a name="l00638"></a>00638            printf(<span class="stringliteral">"El porcentaje de tiempo LU fue de %f \n"</span>,100.0*(finFactorizacion-iniTiempo)/(finT-iniTiempo));       
<a name="l00639"></a>00639            printf(<span class="stringliteral">"El porcentaje de tiempo Solve LU fue de %f \n"</span>,100.0*(finT-iniT)/(finT-iniTiempo));  
<a name="l00640"></a>00640            printf(<span class="stringliteral">"-- Fin resolver sistema--- "</span>);
<a name="l00641"></a>00641                    }
<a name="l00642"></a>00642            <span class="keywordflow">else</span> 
<a name="l00643"></a>00643            {
<a name="l00644"></a>00644                    printf(<span class="stringliteral">"ESTE METODO NO ESTA PARA CALCULO PARALELO\n"</span>);
<a name="l00645"></a>00645                    MPI_Finalize();
<a name="l00646"></a>00646                    exit(1);
<a name="l00647"></a>00647            }
<a name="l00648"></a>00648         }
<a name="l00649"></a>00649    <span class="keywordflow">if</span>(metodo == <a class="code" href="../../d7/dd9/_f_e_m_8hpp.html#257d42a86bdd05abc1d68f49b3e089f9" title="Metodo Factorizacion Cholesky LLT.">LLT</a>)
<a name="l00650"></a>00650    {
<a name="l00651"></a>00651            
<a name="l00652"></a>00652            
<a name="l00653"></a>00653             <span class="keywordflow">if</span>(size==1)
<a name="l00654"></a>00654            {   
<a name="l00655"></a>00655                                 <span class="keywordflow">if</span>(<a class="code" href="../../d2/d56/class_f_e_m.html#e0856c85796e508bc79ebb4f50680ff7" title="Retorna el tipo de de solucion matricial 1 - Matriz Completa, 2 - Matriz reducida...">Get_tipo_solucion_matricial</a>()!=2)   
<a name="l00656"></a>00656                                 {   
<a name="l00657"></a>00657                                 <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#a92429bad7eab3a7098e049bc62d29a9" title="Factoriza la matriz A en L y LT dejandolas en la misma matriz.">Factoriza_LLT</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#d8972f193f24ec53b73316080fa95e63" title="Matriz de riguidez completa del sistema ( Matriz stiffness (Fisico-geometria) + Matriz...">A</a>);
<a name="l00658"></a>00658                                 finFactorizacion=MPI_Wtime();
<a name="l00659"></a>00659                                 iniT=MPI_Wtime();
<a name="l00660"></a>00660                                 <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#5b8fc00508e86a9070dac2aa213d3e51" title="Resuelve un sistema factorizado utilizando Cholesky LLT.">Solve_LLT</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#d8972f193f24ec53b73316080fa95e63" title="Matriz de riguidez completa del sistema ( Matriz stiffness (Fisico-geometria) + Matriz...">A</a>, <a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>, <a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>);
<a name="l00661"></a>00661                                 finT=MPI_Wtime();
<a name="l00662"></a>00662                                 printf(<span class="stringliteral">"El tiempo LLT fue %f segundos\n"</span>,finFactorizacion-iniTiempo);
<a name="l00663"></a>00663                                 printf(<span class="stringliteral">"El tiempo Resover  LLT fue %f segundos\n"</span>,finT-iniT);
<a name="l00664"></a>00664                                 printf(<span class="stringliteral">"El porcentaje de tiempo LLT fue de %f \n"</span>,100.0*(finFactorizacion-iniTiempo)/(finT-iniTiempo)); 
<a name="l00665"></a>00665                                 printf(<span class="stringliteral">"El porcentaje de tiempo Solve LLT fue de %f \n"</span>,100.0*(finT-iniT)/(finT-iniTiempo));    
<a name="l00666"></a>00666                                 printf(<span class="stringliteral">"-- Fin resolver sistema-- "</span>);
<a name="l00667"></a>00667                                 }
<a name="l00668"></a>00668                 <span class="keywordflow">else</span>
<a name="l00669"></a>00669                 {
<a name="l00670"></a>00670                                         printf(<span class="stringliteral">" \n ***** ATENCION ***** \n"</span>);
<a name="l00671"></a>00671                                     printf(<span class="stringliteral">"En el metodo de resolucion LLT para condicion deborde de tipo Dirichlet = 0, la matriz reducida no es una matriz definida positiva \n"</span>);
<a name="l00672"></a>00672                                     printf(<span class="stringliteral">"y se requiere un proceso de factorizacion extra que realize modificaciones a la matriz reducida, el cual no esta implemento en este programa\n"</span>);
<a name="l00673"></a>00673                                         printf(<span class="stringliteral">"por lo cual el metodo de resolucion LLT para condicion de borde de tipo Dirichlet = 0 no esta disponible \n"</span>);
<a name="l00674"></a>00674                     MPI_Finalize();     
<a name="l00675"></a>00675                                         exit(1);
<a name="l00676"></a>00676                                 }                                       
<a name="l00677"></a>00677        }
<a name="l00678"></a>00678            <span class="keywordflow">else</span> 
<a name="l00679"></a>00679            {
<a name="l00680"></a>00680                    printf(<span class="stringliteral">"ESTE METODO NO ESTA PARA CALCULO PARALELO\n"</span>);
<a name="l00681"></a>00681                    MPI_Finalize();      
<a name="l00682"></a>00682                    exit(1);
<a name="l00683"></a>00683            }
<a name="l00684"></a>00684         }
<a name="l00685"></a>00685 
<a name="l00686"></a>00686            <span class="keywordflow">if</span>(metodo == <a class="code" href="../../d7/dd9/_f_e_m_8hpp.html#8c80ab02c7b1d6bcc688eeaa72503cff" title="Metodo LSQR.">LSQR</a>)
<a name="l00687"></a>00687    {
<a name="l00688"></a>00688             <span class="comment">// Tipo_Parada por defecto 0 en base a la tolerancia , 1 = Numero de iteraciones fijo (utilizado en graficos de convergencia para comparacion de metodos iterativos)  </span>
<a name="l00689"></a>00689             <span class="keywordflow">if</span>(size==1)
<a name="l00690"></a>00690            {   
<a name="l00691"></a>00691             iniT=MPI_Wtime();
<a name="l00692"></a>00692                 <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#6e7fa4c926d3ccf67a5ea93831b13b7f" title="Algoritmo LSQR.">LSQR_Resolver_Normal</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#d8972f193f24ec53b73316080fa95e63" title="Matriz de riguidez completa del sistema ( Matriz stiffness (Fisico-geometria) + Matriz...">A</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>,Tipo_Parada,<a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#7e2686b397eef1be4a918ac8c23d24ad" title="Asigna numero de iteraciones.">Get_Traza</a>());
<a name="l00693"></a>00693         finT=MPI_Wtime();
<a name="l00694"></a>00694         printf(<span class="stringliteral">"El tiempo Resover  LSQR fue %f segundos\n"</span>,finT-iniT);
<a name="l00695"></a>00695             printf(<span class="stringliteral">"-- Fin resolver sistema-- "</span>);
<a name="l00696"></a>00696                 }
<a name="l00697"></a>00697            <span class="keywordflow">else</span> 
<a name="l00698"></a>00698            {
<a name="l00699"></a>00699                    printf(<span class="stringliteral">"ESTE METODO NO ESTA PARA CALCULO PARALELO\n"</span>);
<a name="l00700"></a>00700                    MPI_Finalize();      
<a name="l00701"></a>00701                    exit(1);
<a name="l00702"></a>00702            }
<a name="l00703"></a>00703         }
<a name="l00704"></a>00704 
<a name="l00705"></a>00705        <span class="keywordflow">if</span>(metodo == <a class="code" href="../../d7/dd9/_f_e_m_8hpp.html#e9a4b9f216f53ca47b8fc35199502aae" title="Metodo LSQR para matrices Dispersas.">LSQR_DISPERSO</a> )
<a name="l00706"></a>00706    {
<a name="l00707"></a>00707          <span class="comment">// Tipo_Parada por defecto 0 en base a la tolerancia , 1 = Numero de iteraciones fijo (utilizado en graficos de convergencia para comparacion de metodos iterativos)  </span>
<a name="l00708"></a>00708          <span class="keywordtype">int</span> TAG_B=0;
<a name="l00709"></a>00709          <span class="keywordtype">int</span> TAG_DImX=1;
<a name="l00710"></a>00710          <span class="keywordtype">int</span> TAG_Indices=2;
<a name="l00711"></a>00711          <span class="keywordtype">int</span> TAG_Columnas=3;
<a name="l00712"></a>00712          <span class="keywordtype">int</span> TAG_Datos=4; 
<a name="l00713"></a>00713          <span class="keywordtype">int</span> TAG_Particion=5;
<a name="l00714"></a>00714          <span class="keywordtype">int</span> TAG_nDatos=6;  
<a name="l00715"></a>00715          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  <span class="keywordtype">long</span> *dimX=<span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  <span class="keywordtype">long</span>[1];
<a name="l00716"></a>00716          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  <span class="keywordtype">long</span> *iParticion=<span class="keyword">new</span> <span class="keywordtype">unsigned</span>  <span class="keywordtype">long</span> <span class="keywordtype">long</span>[1]; 
<a name="l00717"></a>00717          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  <span class="keywordtype">long</span> *nColumnas=<span class="keyword">new</span> <span class="keywordtype">unsigned</span>  <span class="keywordtype">long</span> <span class="keywordtype">long</span>[1];  
<a name="l00718"></a>00718      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>  largo_vector;
<a name="l00719"></a>00719          <a class="code" href="../../dd/d6d/class_matriz___dispersa.html" title="Clase para el trabajar con matrices dispersas de tipo double.">Matriz_Dispersa</a> *MDA;  
<a name="l00720"></a>00720          <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a> *vParticion=<span class="keyword">new</span> <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>)size);
<a name="l00721"></a>00721      <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a> *INDICES;
<a name="l00722"></a>00722      <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a> *COLUMNAS;
<a name="l00723"></a>00723          <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *DATOS;
<a name="l00724"></a>00724                    
<a name="l00725"></a>00725         
<a name="l00726"></a>00726            <span class="keywordflow">if</span>(rank==0)
<a name="l00727"></a>00727            {       
<a name="l00728"></a>00728                 printf(<span class="stringliteral">"Generando Matriz dispersa....."</span>);
<a name="l00729"></a>00729                 MDA = <span class="keyword">new</span> <a class="code" href="../../dd/d6d/class_matriz___dispersa.html" title="Clase para el trabajar con matrices dispersas de tipo double.">Matriz_Dispersa</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#619e87c85e7a72761943a4b9ea4fcd37">Matriz_A_FEM</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>(),<a class="code" href="../../d2/d56/class_f_e_m.html#dbb7f40ddaf723d16d761af50fdcd404" title="Mapeo de la informacion de las filas con elementos no nulos.">Mapeo_FEM_Fila</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#5f1a17e5278ad53cf865557f540a2cc3" title="Mapeo de la informacion de las columnas con elementos no nulos.">Mapeo_FEM_Columna</a>);
<a name="l00730"></a>00730             finFactorizacion=MPI_Wtime();
<a name="l00731"></a>00731         iniT=MPI_Wtime();
<a name="l00732"></a>00732             <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#a699432204b6cd794d28e150c2ac6e3f" title="Asigna numero de procesos - procesadores.">SetNP</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#dda0fffeb7be2985364a18b05b90b3cb" title="Retorna el numero de procesos.">GetProcesadores</a>()); <span class="comment">// Se indica al sistema lineal cuantos procesadores va a utilizar BORRAR PERO REVISAR</span>
<a name="l00733"></a>00733                 
<a name="l00734"></a>00734                         <span class="comment">// Si es calculo paralelo se realiza el proceso de paso de mensajes</span>
<a name="l00735"></a>00735                                 <span class="keywordflow">if</span>(size&gt;1)
<a name="l00736"></a>00736                                 {
<a name="l00737"></a>00737                                         
<a name="l00738"></a>00738                                                         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  <span class="keywordtype">long</span> contador=0; 
<a name="l00739"></a>00739                                                     <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#a7a2afdf1dbd7cdf9dac4d2df692002e" title="Particiona un vector segun numero de procesadores, almacenando el largo de cada sub...">Obtener_Vector_Particion</a>(size,MDA-&gt;<a class="code" href="../../dd/d6d/class_matriz___dispersa.html#df9c60c820545ef13526a780d03a7f66" title="Vector Entero que contiene los indices de cada nueva fila.">vIndiceFila</a>-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#d1d5779a63bf05b51bec19fa6a03cd29" title="Retorna el numero de columnas.">Columnas</a>(),vParticion);
<a name="l00740"></a>00740                                             <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#b5e2f6fd151ec8f14255f2b96aa739f3">Asigna_Indice_FIla</a>(vParticion);
<a name="l00741"></a>00741                                         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  <span class="keywordtype">long</span> desplazamiento=0;
<a name="l00742"></a>00742                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#0d2f1490d4c41c34b6a2e3f36e33ee2b" title="Tiempos parciales comunicacion FEM.">Tiempo_Inicial_Comunicacion_FEM</a>=MPI_Wtime();
<a name="l00743"></a>00743                                                                 <span class="keywordflow">for</span>( i=0;i&lt;size;i++) <span class="comment">// Solo envio a los otros procesos, el root ya tiene la informacion, una alternativa es crear PACK, pero no consume mayores recursos esta solucion</span>
<a name="l00744"></a>00744                                                                 {       
<a name="l00745"></a>00745                                                                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#0e4f48806ae96b733b4571c86ed760eb" title="Envia un mensaje que contiene un dato entero.">Envio_Dato_Entero</a>(i,TAG_DImX,<a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>()); 
<a name="l00746"></a>00746                                                                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#be4c57217dc8887079cf99fa1a61df47" title="Envia un mensaje que contiene un vector flotante.">Envio_Vector_Double</a>(i,TAG_B,0,<a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>(),<a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>()); 
<a name="l00747"></a>00747                                                     
<a name="l00748"></a>00748                                     <span class="keywordflow">if</span>(i!=size-1)
<a name="l00749"></a>00749                                     {                                                                           
<a name="l00750"></a>00750                                                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#0e4f48806ae96b733b4571c86ed760eb" title="Envia un mensaje que contiene un dato entero.">Envio_Dato_Entero</a>(i,TAG_Particion,vParticion-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(i)+1);  
<a name="l00751"></a>00751                                                                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#17722cd138194ddc69b1df3c486c7b41" title="Envia un mensaje que contiene un vector entero.">Envio_Vector_Entero</a>(i,TAG_Indices,contador,vParticion-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(i)+1,MDA-&gt;<a class="code" href="../../dd/d6d/class_matriz___dispersa.html#df9c60c820545ef13526a780d03a7f66" title="Vector Entero que contiene los indices de cada nueva fila.">vIndiceFila</a>-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#4ffa02a33c82d9bdbd90313af305ea93" title="Retorna el puntero donde se almacena el vector.">Retorna_Puntero_Datos</a>()); 
<a name="l00752"></a>00752                                                                 }
<a name="l00753"></a>00753                                                                                 <span class="keywordflow">else</span>
<a name="l00754"></a>00754                                                                                 {
<a name="l00755"></a>00755                                                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#0e4f48806ae96b733b4571c86ed760eb" title="Envia un mensaje que contiene un dato entero.">Envio_Dato_Entero</a>(i,TAG_Particion,vParticion-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(i));  
<a name="l00756"></a>00756                                                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#17722cd138194ddc69b1df3c486c7b41" title="Envia un mensaje que contiene un vector entero.">Envio_Vector_Entero</a>(i,TAG_Indices,contador,vParticion-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(i),MDA-&gt;<a class="code" href="../../dd/d6d/class_matriz___dispersa.html#df9c60c820545ef13526a780d03a7f66" title="Vector Entero que contiene los indices de cada nueva fila.">vIndiceFila</a>-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#4ffa02a33c82d9bdbd90313af305ea93" title="Retorna el puntero donde se almacena el vector.">Retorna_Puntero_Datos</a>()); 
<a name="l00757"></a>00757                                                                                 }       
<a name="l00758"></a>00758                                                                         
<a name="l00759"></a>00759                                                                         desplazamiento=MDA-&gt;<a class="code" href="../../dd/d6d/class_matriz___dispersa.html#df9c60c820545ef13526a780d03a7f66" title="Vector Entero que contiene los indices de cada nueva fila.">vIndiceFila</a>-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(contador);
<a name="l00760"></a>00760                                                                 
<a name="l00761"></a>00761                                                                         contador=contador+vParticion-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(i);
<a name="l00762"></a>00762                                                                         
<a name="l00763"></a>00763                                                         
<a name="l00764"></a>00764                                                                         <span class="keywordflow">if</span>(i==(size-1))
<a name="l00765"></a>00765                                                                         {       
<a name="l00766"></a>00766                                                                                 largo_vector=MDA-&gt;<a class="code" href="../../dd/d6d/class_matriz___dispersa.html#df9c60c820545ef13526a780d03a7f66" title="Vector Entero que contiene los indices de cada nueva fila.">vIndiceFila</a>-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(contador-1)  - desplazamiento;   
<a name="l00767"></a>00767                                                                                 
<a name="l00768"></a>00768                                                                         }
<a name="l00769"></a>00769                                                                                 <span class="keywordflow">else</span>
<a name="l00770"></a>00770                                                                                 {
<a name="l00771"></a>00771                                                                                         largo_vector=MDA-&gt;<a class="code" href="../../dd/d6d/class_matriz___dispersa.html#df9c60c820545ef13526a780d03a7f66" title="Vector Entero que contiene los indices de cada nueva fila.">vIndiceFila</a>-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#10ed0238f4d5d6dd098d23eeb8ffc077" title="Retorna valor de col.">Retorna</a>(contador)  - desplazamiento;     
<a name="l00772"></a>00772                                                                         }
<a name="l00773"></a>00773                                                                                 
<a name="l00774"></a>00774                                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#0e4f48806ae96b733b4571c86ed760eb" title="Envia un mensaje que contiene un dato entero.">Envio_Dato_Entero</a>(i,TAG_nDatos,largo_vector);  
<a name="l00775"></a>00775                                                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#17722cd138194ddc69b1df3c486c7b41" title="Envia un mensaje que contiene un vector entero.">Envio_Vector_Entero</a>(i,TAG_Columnas,desplazamiento,largo_vector,MDA-&gt;<a class="code" href="../../dd/d6d/class_matriz___dispersa.html#42a91e762522ea80c46440f2196d8944" title="Vector entero que contiene datos de columnas.">vColumna</a>-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#4ffa02a33c82d9bdbd90313af305ea93" title="Retorna el puntero donde se almacena el vector.">Retorna_Puntero_Datos</a>()); <span class="comment">//Paquete 2</span>
<a name="l00776"></a>00776                                                                     <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#be4c57217dc8887079cf99fa1a61df47" title="Envia un mensaje que contiene un vector flotante.">Envio_Vector_Double</a>(i,TAG_Datos,desplazamiento,largo_vector,MDA-&gt;<a class="code" href="../../dd/d6d/class_matriz___dispersa.html#31caef44c3a65e530082abcc0a8e8c48" title="Vector flotante que contiene los datos de la matriz dispersa.">vDato</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>()); <span class="comment">//Paquete 2</span>
<a name="l00777"></a>00777         
<a name="l00778"></a>00778                                                                 }
<a name="l00779"></a>00779                                          
<a name="l00780"></a>00780                                 }
<a name="l00781"></a>00781                    
<a name="l00782"></a>00782            }
<a name="l00783"></a>00783             <a class="code" href="../../d2/d56/class_f_e_m.html#06299050eb1d80c0374386966e617b7b">Tiempo_Parcial_Comunicacion_FEM</a>=MPI_Wtime() - <a class="code" href="../../d2/d56/class_f_e_m.html#0d2f1490d4c41c34b6a2e3f36e33ee2b" title="Tiempos parciales comunicacion FEM.">Tiempo_Inicial_Comunicacion_FEM</a>;
<a name="l00784"></a>00784            <span class="comment">//Si es calculo paralelo se realiza el proceso de recepcion de mensajes</span>
<a name="l00785"></a>00785            <span class="keywordflow">if</span>(size&gt;1)
<a name="l00786"></a>00786            {   <a class="code" href="../../d2/d56/class_f_e_m.html#0d2f1490d4c41c34b6a2e3f36e33ee2b" title="Tiempos parciales comunicacion FEM.">Tiempo_Inicial_Comunicacion_FEM</a>=MPI_Wtime();
<a name="l00787"></a>00787                 <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#75f07d2a047ad643fcf2f3c1acf5604d" title="Recibe un mensaje que contiene un dato entero.">Recibe_Dato_Entero</a>(0,TAG_DImX,dimX); 
<a name="l00788"></a>00788                     <a class="code" href="../../d2/d56/class_f_e_m.html#06299050eb1d80c0374386966e617b7b">Tiempo_Parcial_Comunicacion_FEM</a>+=MPI_Wtime() - <a class="code" href="../../d2/d56/class_f_e_m.html#0d2f1490d4c41c34b6a2e3f36e33ee2b" title="Tiempos parciales comunicacion FEM.">Tiempo_Inicial_Comunicacion_FEM</a>;
<a name="l00789"></a>00789                     <a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(dimX[0]);
<a name="l00790"></a>00790                     <a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(dimX[0]);
<a name="l00791"></a>00791                     <a class="code" href="../../d2/d56/class_f_e_m.html#0d2f1490d4c41c34b6a2e3f36e33ee2b" title="Tiempos parciales comunicacion FEM.">Tiempo_Inicial_Comunicacion_FEM</a>=MPI_Wtime();
<a name="l00792"></a>00792                         <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#c2091f3c2aeb31739e024e351ccdb935" title="Recibe un vector de tipo double.">Recibe_Vector_Double</a>(0,TAG_B,dimX[0],<a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),status); 
<a name="l00793"></a>00793             <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#75f07d2a047ad643fcf2f3c1acf5604d" title="Recibe un mensaje que contiene un dato entero.">Recibe_Dato_Entero</a>(0,TAG_Particion,iParticion); 
<a name="l00794"></a>00794                     <a class="code" href="../../d2/d56/class_f_e_m.html#06299050eb1d80c0374386966e617b7b">Tiempo_Parcial_Comunicacion_FEM</a>+=MPI_Wtime() - <a class="code" href="../../d2/d56/class_f_e_m.html#0d2f1490d4c41c34b6a2e3f36e33ee2b" title="Tiempos parciales comunicacion FEM.">Tiempo_Inicial_Comunicacion_FEM</a>;
<a name="l00795"></a>00795                     INDICES=<span class="keyword">new</span> <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a>(iParticion[0],<span class="stringliteral">"INDICES"</span>);
<a name="l00796"></a>00796                     <a class="code" href="../../d2/d56/class_f_e_m.html#0d2f1490d4c41c34b6a2e3f36e33ee2b" title="Tiempos parciales comunicacion FEM.">Tiempo_Inicial_Comunicacion_FEM</a>=MPI_Wtime();
<a name="l00797"></a>00797                     <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#0dea97290a4e9bfd6bfee90c18d0e491" title="Recibe un vector de tipo entero long long sin signo.">Recibe_Vector_Entero</a>(0,TAG_Indices,iParticion[0],INDICES-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#4ffa02a33c82d9bdbd90313af305ea93" title="Retorna el puntero donde se almacena el vector.">Retorna_Puntero_Datos</a>(),status);
<a name="l00798"></a>00798             <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#75f07d2a047ad643fcf2f3c1acf5604d" title="Recibe un mensaje que contiene un dato entero.">Recibe_Dato_Entero</a>(0,TAG_nDatos,nColumnas); 
<a name="l00799"></a>00799                     <a class="code" href="../../d2/d56/class_f_e_m.html#06299050eb1d80c0374386966e617b7b">Tiempo_Parcial_Comunicacion_FEM</a>+=MPI_Wtime() - <a class="code" href="../../d2/d56/class_f_e_m.html#0d2f1490d4c41c34b6a2e3f36e33ee2b" title="Tiempos parciales comunicacion FEM.">Tiempo_Inicial_Comunicacion_FEM</a>;
<a name="l00800"></a>00800                     DATOS=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(nColumnas[0],<span class="stringliteral">"DATOS"</span>);
<a name="l00801"></a>00801                     <a class="code" href="../../d2/d56/class_f_e_m.html#0d2f1490d4c41c34b6a2e3f36e33ee2b" title="Tiempos parciales comunicacion FEM.">Tiempo_Inicial_Comunicacion_FEM</a>=MPI_Wtime();
<a name="l00802"></a>00802                     COLUMNAS=<span class="keyword">new</span> <a class="code" href="../../dd/d59/class_vector___entero.html" title="Clase para el trabajar con vectores enteros long long sin signo.">Vector_Entero</a>(nColumnas[0],<span class="stringliteral">"COLUMNAS"</span>);
<a name="l00803"></a>00803                     <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#0dea97290a4e9bfd6bfee90c18d0e491" title="Recibe un vector de tipo entero long long sin signo.">Recibe_Vector_Entero</a>(0,TAG_Columnas,nColumnas[0],COLUMNAS-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#4ffa02a33c82d9bdbd90313af305ea93" title="Retorna el puntero donde se almacena el vector.">Retorna_Puntero_Datos</a>(),status); 
<a name="l00804"></a>00804                     <a class="code" href="../../d2/d56/class_f_e_m.html#4870d72a6ab5c4cdbb2951dba6d3f1e5" title="Puntero de las rutinas paralelas.">Proceso_Paralelo</a>-&gt;<a class="code" href="../../d9/daf/class_rutinas___paralelas.html#c2091f3c2aeb31739e024e351ccdb935" title="Recibe un vector de tipo double.">Recibe_Vector_Double</a>(0,TAG_Datos,nColumnas[0],DATOS-&gt;<a class="code" href="../../d5/db2/class_vector.html#7ad8f53216c5f443d6e1ef7587a938fe" title="Retorna puntero del vector.">Retorna_Puntero_Datos</a>(),status); 
<a name="l00805"></a>00805             <a class="code" href="../../d2/d56/class_f_e_m.html#06299050eb1d80c0374386966e617b7b">Tiempo_Parcial_Comunicacion_FEM</a>+=MPI_Wtime() - <a class="code" href="../../d2/d56/class_f_e_m.html#0d2f1490d4c41c34b6a2e3f36e33ee2b" title="Tiempos parciales comunicacion FEM.">Tiempo_Inicial_Comunicacion_FEM</a>;
<a name="l00806"></a>00806                 }                       
<a name="l00807"></a>00807                 
<a name="l00808"></a>00808                 
<a name="l00809"></a>00809                 
<a name="l00810"></a>00810                 
<a name="l00811"></a>00811                 
<a name="l00812"></a>00812         <span class="comment">// Si el calculo paraleleo se utilizan los vectores particionados y procesos de comunicacion, recoleccion y calculo paralelo</span>
<a name="l00813"></a>00813             <span class="keywordflow">if</span>(size&gt;1)
<a name="l00814"></a>00814                 {
<a name="l00815"></a>00815                         iniT=MPI_Wtime();
<a name="l00816"></a>00816                         <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#2b9e62158dcb700a20e8f429c8c50454" title="Algoritmo LSQR paralelo para matrices dispersas.">LSQR_Resolver_Paralelo</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>,iParticion,COLUMNAS,INDICES,DATOS,Tipo_Parada,traza);       
<a name="l00817"></a>00817         }
<a name="l00818"></a>00818                 <span class="comment">// Calculo secuencial</span>
<a name="l00819"></a>00819                 <span class="keywordflow">else</span>
<a name="l00820"></a>00820                 {  iniT=MPI_Wtime();
<a name="l00821"></a>00821                         <a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#f2efe219c73509e50385d87a326a7c0e" title="Algoritmo LSQR para matrices dispersas.">LSQR_Resolver</a>(MDA,<a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>,Tipo_Parada,<a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#7e2686b397eef1be4a918ac8c23d24ad" title="Asigna numero de iteraciones.">Get_Traza</a>());
<a name="l00822"></a>00822                 }
<a name="l00823"></a>00823 
<a name="l00824"></a>00824                 
<a name="l00825"></a>00825         <span class="keywordflow">if</span>(rank==0)
<a name="l00826"></a>00826                 {       
<a name="l00827"></a>00827                 
<a name="l00828"></a>00828                 finT=MPI_Wtime();
<a name="l00829"></a>00829         
<a name="l00830"></a>00830                 <span class="keywordflow">if</span>(size==1)
<a name="l00831"></a>00831                 {
<a name="l00832"></a>00832                         <a class="code" href="../../d2/d56/class_f_e_m.html#06299050eb1d80c0374386966e617b7b">Tiempo_Parcial_Comunicacion_FEM</a>=0.0;
<a name="l00833"></a>00833                 }       
<a name="l00834"></a>00834                 
<a name="l00835"></a>00835                 
<a name="l00836"></a>00836                 printf(<span class="stringliteral">"El tiempo en el pre- procesamiento de la comunicacionfue de %f segundos\n"</span>,<a class="code" href="../../d2/d56/class_f_e_m.html#06299050eb1d80c0374386966e617b7b">Tiempo_Parcial_Comunicacion_FEM</a>);    
<a name="l00837"></a>00837                 printf(<span class="stringliteral">"El tiempo utilizado en comunicacion en LSQR fue de:  %f segundos\n"</span>,<a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#b5a2b3cc2401946436d9d348afda71c9" title="Tiempo utilizado en resolver sistema.">tSistema</a>); 
<a name="l00838"></a>00838                 printf(<span class="stringliteral">"El tiempo total de comunicacion de la aproximacion Fem fue de %f segundos\n"</span>,<a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#b5a2b3cc2401946436d9d348afda71c9" title="Tiempo utilizado en resolver sistema.">tSistema</a>+<a class="code" href="../../d2/d56/class_f_e_m.html#06299050eb1d80c0374386966e617b7b">Tiempo_Parcial_Comunicacion_FEM</a>);        
<a name="l00839"></a>00839                 printf(<span class="stringliteral">"El tiempo Resover  LSQR fue %f segundos\n"</span>,finT-iniT);
<a name="l00840"></a>00840             printf(<span class="stringliteral">"-- Fin resolver sistema-- \n"</span>);
<a name="l00841"></a>00841                 <a class="code" href="../../d2/d56/class_f_e_m.html#003bd70b0e5d985e6021cc3d42901d3c" title="Tiempo total utilizado en comunicacion.">tTotalComunicacion</a>+=<a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#b5a2b3cc2401946436d9d348afda71c9" title="Tiempo utilizado en resolver sistema.">tSistema</a>+<a class="code" href="../../d2/d56/class_f_e_m.html#06299050eb1d80c0374386966e617b7b">Tiempo_Parcial_Comunicacion_FEM</a>;          
<a name="l00842"></a>00842         <a class="code" href="../../d2/d56/class_f_e_m.html#459dd6a7adcc39fa722e6b5ca2a426f4">tTotalComunicacionFEM</a>=<a class="code" href="../../d2/d56/class_f_e_m.html#0705915d2341cd6d9f91fca24b404a28" title="Declaracion del sistema lineal a resolver.">Sistema</a>-&gt;<a class="code" href="../../d9/d85/class_sistema___lineal.html#b5a2b3cc2401946436d9d348afda71c9" title="Tiempo utilizado en resolver sistema.">tSistema</a>+<a class="code" href="../../d2/d56/class_f_e_m.html#06299050eb1d80c0374386966e617b7b">Tiempo_Parcial_Comunicacion_FEM</a>;                
<a name="l00843"></a>00843             }
<a name="l00844"></a>00844                         
<a name="l00845"></a>00845                         
<a name="l00846"></a>00846 }
<a name="l00847"></a>00847 
<a name="l00848"></a>00848 
<a name="l00849"></a>00849 
<a name="l00850"></a>00850         <span class="keywordflow">if</span>(rank==0)     
<a name="l00851"></a>00851         {
<a name="l00852"></a>00852                 
<a name="l00853"></a>00853                 <span class="keywordtype">double</span> suma_fotones_fuentes=0.0;
<a name="l00854"></a>00854                 <span class="keywordtype">double</span> factor;
<a name="l00855"></a>00855                 
<a name="l00856"></a>00856                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i=0;i &lt; <a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>();i++)
<a name="l00857"></a>00857                 suma_fotones_fuentes+=<a class="code" href="../../d2/d56/class_f_e_m.html#bb2aefb799927f59fecfe657249dc931" title="Vector que contendra los valores conocidos del vector de carga global (Vector Fuente)...">B</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i);    
<a name="l00858"></a>00858                 
<a name="l00859"></a>00859                 <span class="comment">// SE DEBE PROFUNDIZAR EN EL AREA EFECTIVA DE CADA NODO Y UTILIZAR VALORES DE FLUENCIA CON DATOS REALES Y NO EXPERIMENTALES</span>
<a name="l00860"></a>00860                 <span class="comment">//factor = 1.0/(Get_sCarga()*GeometriaTrabajo-&gt;Retorna_Numero_Nodos()); // En caso de distribuir la carga de fotonos NO con valores experimentales y normalizados segun numero de fotones en la fuente</span>
<a name="l00861"></a>00861                 factor = 1.0/(<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../df/d5d/class_geometria.html#8883f64fa3d61833004018ac8e28d774" title="Retorna el numero de nodos.">Retorna_Numero_Nodos</a>());  <span class="comment">// Valores cuantificables de fotones por unidad de area, mientras mayor resolucion menos fotones por unidad de area, ya que el area de flujo es menor</span>
<a name="l00862"></a>00862 
<a name="l00863"></a>00863                 <span class="comment">// El error implicito en este factor es eliminado al momento de calcular la grilla de densidades donde la unidad de area es contanste en todo el dominio al ser una grilla de NxN</span>
<a name="l00864"></a>00864                 <a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#b5ca44873103b24740b0b466c79030d5" title="Multiplica el vector por el escalar esc.">Multiplica</a>( factor );
<a name="l00865"></a>00865                 printf(<span class="stringliteral">"Factor escala = %f \n Fluencia de Fotones totales en fuentes =%f (1/Cm^2) \n Magnitud del total de fotones a estimar en fuentes =%f Fotones\n"</span>,factor,suma_fotones_fuentes,<a class="code" href="../../d2/d56/class_f_e_m.html#310589e329c61029418a3100d8b38688" title="Retorna la sumas de magnitudes original del vector de cargas.">Get_sCarga</a>());
<a name="l00866"></a>00866                 
<a name="l00868"></a>00868                 <a class="code" href="../../d2/dee/class_archivo.html" title="Clase para manipular archivos.">Archivo</a> *Sol=<span class="keyword">new</span> <a class="code" href="../../d2/dee/class_archivo.html" title="Clase para manipular archivos.">Archivo</a>();
<a name="l00869"></a>00869                 Sol-&gt;<a class="code" href="../../d2/dee/class_archivo.html#3960a9c7863da75e6e704a668c488293" title="Asigna un nombre al archivo.">SetNombre</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#8f1866b5c84f4678896933954c79cbc6" title="Retorna el nombre del archivo solucion.">GetNombreArchivoX</a>());
<a name="l00870"></a>00870                 Sol-&gt;<a class="code" href="../../d2/dee/class_archivo.html#4c756c8da75fab13f1c0b5cc636b2724" title="Define el tipo de acceso al archivo.">SetModo</a>(<a class="code" href="../../de/dc7/_archivo_8hpp.html#406416501f9b8dd55765eb0686ced406">GRABA_ARCHIVO</a>);    
<a name="l00871"></a>00871                 Sol-&gt;<a class="code" href="../../d2/dee/class_archivo.html#812b1ef63ac695139f6b4bfb3aa7ff81" title="Abre el archivo.">Abrir</a>();
<a name="l00872"></a>00872                 
<a name="l00873"></a>00873                         
<a name="l00874"></a>00874 
<a name="l00875"></a>00875                         <span class="keywordflow">if</span>(<a class="code" href="../../d2/d56/class_f_e_m.html#e0856c85796e508bc79ebb4f50680ff7" title="Retorna el tipo de de solucion matricial 1 - Matriz Completa, 2 - Matriz reducida...">Get_tipo_solucion_matricial</a>()==1)
<a name="l00876"></a>00876                         {       
<a name="l00877"></a>00877                                 
<a name="l00878"></a>00878                          printf(<span class="stringliteral">"Generando archivo solucion\nArea dominio = %f Cm^2 \n Nodos = %ld \nElementos=%ld "</span>,<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#9fca41c0e41e33905b893c8d444ebe05" title="Retorna el area del dominio global.">Area_Global</a>(),<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../df/d5d/class_geometria.html#8883f64fa3d61833004018ac8e28d774" title="Retorna el numero de nodos.">Retorna_Numero_Nodos</a>(),<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../df/d5d/class_geometria.html#cca22abfeb1e3fdb0499efd69c9aaec9" title="Retorna el numero de elementos.">Retorna_Numero_Elementos</a>());
<a name="l00879"></a>00879                          Sol-&gt;<a class="code" href="../../d2/dee/class_archivo.html#d1120aa3740cdc037ce2a3fb49351133" title="Escribe un Vector a un archivo (Recordar cambiar a Escribe_Vector).">Escribe_Vector</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>,<a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>());   
<a name="l00880"></a>00880                 
<a name="l00881"></a>00881                         }
<a name="l00882"></a>00882                 
<a name="l00883"></a>00883                         <span class="comment">// Ensamble solucion reducida  </span>
<a name="l00884"></a>00884                         <span class="keywordflow">if</span>(<a class="code" href="../../d2/d56/class_f_e_m.html#e0856c85796e508bc79ebb4f50680ff7" title="Retorna el tipo de de solucion matricial 1 - Matriz Completa, 2 - Matriz reducida...">Get_tipo_solucion_matricial</a>()==2)
<a name="l00885"></a>00885                         {
<a name="l00886"></a>00886                                 printf(<span class="stringliteral">"Ensamble de solucion reducida y generando archivo solucion...\n"</span>);
<a name="l00887"></a>00887                                 <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a> *SolucionTMP=<span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#a6abd4ee7c20a2183a903b183304f050" title="Retorna el orden nodal global.">Get_orden_nodal</a>());
<a name="l00888"></a>00888                                         
<a name="l00889"></a>00889                                         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  <span class="keywordtype">long</span> cont=0;
<a name="l00890"></a>00890                                         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  <span class="keywordtype">long</span> i=0;i&lt;<a class="code" href="../../d2/d56/class_f_e_m.html#a6abd4ee7c20a2183a903b183304f050" title="Retorna el orden nodal global.">Get_orden_nodal</a>();i++)
<a name="l00891"></a>00891                                         {
<a name="l00892"></a>00892                                                 <span class="keywordflow">if</span>(<a class="code" href="../../d2/d56/class_f_e_m.html#dc741809ba703314c6a34b101d15e1dd" title="Retorna la geometria de trabajo.">Get_Geometria2D_Triangulos</a>()-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#3a2c4722a167e116af539b42ed21dec1" title="Retorna el vector que contiene los identificadores de los nodos que estan en la frontera...">Get_Nodos_Frontera_Geometria</a>()-&gt;<a class="code" href="../../dd/d59/class_vector___entero.html#a634ce7235289c7362ba8b2b2a54cc19" title="Busca un valor en el vector y retorna 1 en caso verdadero (solo indica si existe...">Buscar_Valor</a>(i)==1)
<a name="l00893"></a>00893                                                 SolucionTMP-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,0.0);
<a name="l00894"></a>00894                                                 <span class="keywordflow">else</span>
<a name="l00895"></a>00895                                                 {       
<a name="l00896"></a>00896                                                 SolucionTMP-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,<a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(cont));
<a name="l00897"></a>00897                                                 cont++;
<a name="l00898"></a>00898                                                 }
<a name="l00899"></a>00899                                         }
<a name="l00900"></a>00900                                         
<a name="l00901"></a>00901                                         <a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a> =  <span class="keyword">new</span> <a class="code" href="../../d5/db2/class_vector.html" title="Clase para el trabajar con vectores de tipo double.">Vector</a>(<a class="code" href="../../d2/d56/class_f_e_m.html#a6abd4ee7c20a2183a903b183304f050" title="Retorna el orden nodal global.">Get_orden_nodal</a>());
<a name="l00902"></a>00902                                         
<a name="l00903"></a>00903                                         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  <span class="keywordtype">long</span> i=0;i&lt;SolucionTMP-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>();i++)
<a name="l00904"></a>00904                                         {
<a name="l00905"></a>00905                                                 
<a name="l00906"></a>00906                                                 <a class="code" href="../../d2/d56/class_f_e_m.html#439102366801f24f62bce5ce2dfe275b" title="Vector incognita del problema, son los valores desconocidos del problema.">X</a>-&gt;<a class="code" href="../../d5/db2/class_vector.html#4d890dc75bc2047d453e4c4f5704e76b" title="Asigna valor de una elemento del vector en columna col.">Asigna</a>(i,SolucionTMP-&gt;<a class="code" href="../../d5/db2/class_vector.html#26f38adeb1c2a385b7d5480dd7e474dd" title="Retorna valor de la columna col del vector.">Retorna</a>(i));
<a name="l00907"></a>00907                                         }
<a name="l00908"></a>00908                                         Sol-&gt;<a class="code" href="../../d2/dee/class_archivo.html#d1120aa3740cdc037ce2a3fb49351133" title="Escribe un Vector a un archivo (Recordar cambiar a Escribe_Vector).">Escribe_Vector</a>(SolucionTMP,SolucionTMP-&gt;<a class="code" href="../../d5/db2/class_vector.html#2d54c33656543d5cbd083ef3571348ba" title="Retorna el numero de columnas.">Columnas</a>());   
<a name="l00909"></a>00909                 
<a name="l00910"></a>00910                                         printf(<span class="stringliteral">"Area del dominio= %f Cm^2\n Nodos = %ld Elementos=%ld\n"</span>,<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../d5/d35/class_geometria2_d___triangulos.html#9fca41c0e41e33905b893c8d444ebe05" title="Retorna el area del dominio global.">Area_Global</a>(),<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../df/d5d/class_geometria.html#8883f64fa3d61833004018ac8e28d774" title="Retorna el numero de nodos.">Retorna_Numero_Nodos</a>(),<a class="code" href="../../d2/d56/class_f_e_m.html#e9ba83a8d74fbb94829344b371e3bccd" title="Puntero a Geometria de trabajo a utilizar.">GeometriaTrabajo</a>-&gt;<a class="code" href="../../df/d5d/class_geometria.html#cca22abfeb1e3fdb0499efd69c9aaec9" title="Retorna el numero de elementos.">Retorna_Numero_Elementos</a>());
<a name="l00911"></a>00911                                                 
<a name="l00912"></a>00912                         }
<a name="l00913"></a>00913                 
<a name="l00914"></a>00914          Sol-&gt;<a class="code" href="../../d2/dee/class_archivo.html#9dd5f77b08f09bfef21f03e5a0080bcb" title="Cierra el archivo.">Cerrar</a>(); 
<a name="l00915"></a>00915 
<a name="l00916"></a>00916         }
<a name="l00917"></a>00917         
<a name="l00918"></a>00918         
<a name="l00919"></a>00919 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generado el Mon Oct 5 22:06:35 2009 para ETRAD por&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
